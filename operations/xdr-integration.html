<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XDR Integration Strategy | Security Transformation</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
          <a href="../controls-mapping.html" class="nav-item">Controls Mapping</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/parsing-deep-dive.html" class="nav-item">Parsing Deep Dive</a>
          <a href="../siem/threat-intelligence.html" class="nav-item">Threat Intelligence</a>
          <a href="../siem/detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="../siem/detection-anatomy.html" class="nav-item">Detection Anatomy</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soar-automation.html" class="nav-item">SOAR &amp; Automation</a>
          <a href="../siem/workbooks.html" class="nav-item">Workbooks &amp; Dashboards</a>
          <a href="../siem/cost-optimization.html" class="nav-item">Cost Optimization</a>
          <a href="../siem/casb-saas-security.html" class="nav-item">CASB &amp; SaaS Security</a>
          <a href="../siem/soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/xdr-detection-model.html" class="nav-item">XDR Detection Model</a>
          <a href="../edr/advanced-hunting.html" class="nav-item">Advanced Hunting</a>
          <a href="../edr/live-response.html" class="nav-item">Live Response</a>
          <a href="../edr/tvm.html" class="nav-item">Vulnerability Management</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/device-control.html" class="nav-item">Device Control</a>
          <a href="../edr/compensating-controls.html" class="nav-item">Compensating Controls</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/dlp-catalog.html" class="nav-item">DLP Catalog</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/infrastructure-reference.html" class="nav-item">Infrastructure Reference</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
          <a href="../resources/alternative-architectures.html" class="nav-item">Alternative Architectures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep (Full)</a>
          <a href="../interview-prep-v2.html" class="nav-item">Interview Prep v2</a>
          <a href="../interview-technical-reference.html" class="nav-item">Technical Reference</a>
          <a href="../interview-frameworks.html" class="nav-item">Mental Frameworks</a>
          <a href="../director-interview-prep.html" class="nav-item">Director Interview Prep</a>
          <a href="../soc-maturity.html" class="nav-item">SOC Maturity Roadmap</a>
          <a href="../security-mental-model.html" class="nav-item">Security Mental Model</a>
          <a href="../ai-security-risk.html" class="nav-item">AI Security & Risk</a>
        </div>
      </nav>
    </aside>
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>
    <div class="sidebar-overlay"></div>
    <main class="main-content">
      <div class="content-wrapper">
        
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="parallel-ops.html">Operations</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">XDR Integration</span>
        </nav>

        <div class="page-header">
          <h1>XDR-First Detection Strategy</h1>
          <div class="page-header-meta">
            <span class="page-badge siem">Detection Architecture</span>
            <span class="page-reading-time">Comprehensive Guide</span>
          </div>
          <p class="intro-text">
            This migration follows an <strong>XDR-first approach</strong>: enable Microsoft 365 Defender XDR from Day 1, let XDR handle what it's good at, and build Sentinel detections only for what Sentinel needs to own. This architectural decision avoids wasted effort and compresses the migration timeline from 18 months to 12 months.
          </p>
        </div>

        <!-- ==================== KEY INSIGHT ==================== -->
        <div class="callout critical">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Detection-Driven Migration Philosophy
          </div>
          <div class="callout-content">
            <p><strong>Our SIEM migration was detection-driven rather than log-first or 1-to-1 rule translation.</strong></p>
            <p style="margin-top: 0.5rem;">Instead of mechanically porting every RSA NetWitness rule, we evaluated detection intent and leveraged Microsoft's XDR platform for domains where built-in detections already provide strong coverage ‚Äî endpoint, identity, email, and cloud app activity.</p>
            <p style="margin-top: 0.5rem;">This allowed us to retire redundant detections, reduce ingestion cost, and avoid duplicating logic that XDR already handles natively. Sentinel was then used where it adds the most value: cross-domain correlation, non-Microsoft telemetry, and detections that require broader context beyond XDR.</p>
          </div>
        </div>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Key Insight: Sentinel Migrations Are Architectural, Not Mechanical
          </div>
          <div class="callout-content">
            <p>In Splunk, correlation is centralized in the SIEM ‚Äî all security telemetry is ingested and detections are built there. In the Microsoft ecosystem, <strong>correlation is layered</strong>:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>XDR handles upstream correlation</strong> ‚Äî endpoint, identity, email, cloud apps</li>
              <li><strong>Sentinel handles enterprise correlation</strong> ‚Äî network, Azure, custom apps, cross-platform</li>
            </ul>
            <p style="margin-top: 0.5rem;">This is why the detection strategy <strong>changes</strong> rather than being a straight 1:1 rule migration. You're redesigning detection ownership, not translating queries.</p>
          </div>
        </div>

        <!-- ==================== TABLE OF CONTENTS ==================== -->
        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Page Contents
          </div>
          <div class="callout-content">
            <ol style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><a href="#why-xdr-first">Why XDR-First Is the Right Approach</a></li>
              <li><a href="#detection-ownership">Detection Ownership Model</a></li>
              <li><a href="#portal-access">Portal Access & Navigation</a></li>
              <li><a href="#enable-integrations">How to Enable XDR (Month 1)</a></li>
              <li><a href="#what-xdr-handles">What XDR Handles Automatically</a></li>
              <li><a href="#what-sentinel-owns">What Sentinel Owns (401 Rules)</a></li>
              <li><a href="#xdr-correlation-scope">XDR Correlation Scope (TI, Vuln, Assets)</a></li>
              <li><a href="#higher-order-correlation">Higher-Order Correlation Rules</a></li>
              <li><a href="#config-timelines">Microsoft Security Stack Configuration Timelines</a></li>
              <li><a href="#unified-soc">Unified SOC Experience</a></li>
            </ol>
          </div>
        </div>

        <!-- ==================== SECTION 1: WHY XDR FIRST ==================== -->
        <h2 id="why-xdr-first">1. Why XDR-First Is the Right Approach</h2>

        <h3>1.1 The Anti-Pattern: Build Everything, Then Retire</h3>

        <div class="callout" style="background: #450a0a; border-color: #dc2626;">
          <div class="callout-title" style="color: #fecaca;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Anti-Pattern: The "Build Then Retire" Approach
          </div>
          <div class="callout-content" style="color: #fecaca;">
            <p>Some organizations make the mistake of:</p>
            <ol style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Building 500+ Sentinel rules to match legacy SIEM coverage</li>
              <li>Deploying MDE and stabilizing telemetry</li>
              <li>Then enabling XDR months later</li>
              <li>Then discovering XDR handles 50%+ of what they built</li>
              <li>Then retiring 250+ rules</li>
            </ol>
            <p style="margin-top: 0.5rem;"><strong>Result:</strong> Wasted engineering effort, extended timeline, SOC retraining, sunk cost.</p>
          </div>
        </div>

        <h3>1.2 The Right Approach: XDR-First</h3>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            Recommended: Enable XDR First, Build Only What Sentinel Needs
          </div>
          <div class="callout-content">
            <ol style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Discovery:</strong> Map legacy detections ‚Üí XDR handles | Sentinel needed | Custom</li>
              <li><strong>Enable XDR immediately</strong> (Month 1-2) with M365 Defender connector</li>
              <li><strong>Build only 485 Sentinel rules</strong> for what Sentinel needs to own (255 migrated + 230 new coverage)</li>
              <li><strong>Validate coverage</strong> against legacy system during parallel operation</li>
              <li><strong>Build higher-order correlation</strong> (XDR incidents + network/cloud context)</li>
            </ol>
            <p style="margin-top: 0.5rem;"><strong>Result:</strong> Right-sized effort, 12-month timeline, SOC learns unified experience from start.</p>
            <p>üëâ <strong><a href="../resources/timeline.html#month-by-month">Complete Month-by-Month Implementation ‚Üí</a></strong></p>
          </div>
        </div>

        <div class="callout info">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>XDR Portal Quick Reference (December 2025)</div>
          <div class="callout-content">
            <p><strong>Unified Security Portal:</strong> <code>security.microsoft.com</code></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Incidents & Alerts:</strong> Unified queue (XDR + Sentinel incidents together)</li>
              <li><strong>Hunting ‚Üí Advanced hunting:</strong> KQL across all XDR + Sentinel tables</li>
              <li><strong>Assets ‚Üí Devices:</strong> MDE device inventory, MDVM</li>
              <li><strong>Assets ‚Üí Identities:</strong> MDI user timeline, risk scores</li>
              <li><strong>Email & collaboration:</strong> MDO threat explorer, campaigns</li>
              <li><strong>Cloud apps:</strong> MDCA (moved from portal.cloudappsecurity.com)</li>
              <li><strong>Microsoft Sentinel:</strong> Workbooks, analytics rules, automation (embedded)</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Key Evolution (June 2024 ‚Üí December 2025):</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Unified SOC Platform:</strong> Sentinel now inside Defender portal</li>
              <li><strong>Automatic Attack Disruption:</strong> Auto-contains compromised users/devices (GA)</li>
              <li><strong>Exposure Management:</strong> Attack path analysis (Preview)</li>
              <li><strong>M365 Defender ‚Üí Microsoft Defender XDR:</strong> Rebranding</li>
            </ul>
            <p>üëâ <strong><a href="../resources/timeline.html#portal-journey">Full Portal Evolution Journey ‚Üí</a></strong></p>
          </div>
        </div>

        <h3>1.3 Comparison: Build-Then-Retire vs XDR-First</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Factor</th><th style="background: #450a0a; color: #fecaca;">Build-Then-Retire ‚ùå</th><th style="background: #14532d; color: #bbf7d0;">XDR-First ‚úì</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Sentinel Rules to Build</strong></td>
                <td>~580 (then retire 780 to XDR)</td>
                <td>401 from the start (255 migrated + 230 new)</td>
              </tr>
              <tr>
                <td><strong>Engineering Effort</strong></td>
                <td>High (64% wasted on XDR overlap)</td>
                <td>Right-sized</td>
              </tr>
              <tr>
                <td><strong>Migration Timeline</strong></td>
                <td>18 months</td>
                <td>12 months</td>
              </tr>
              <tr>
                <td><strong>Sentinel Compute Cost</strong></td>
                <td>High (580 rules running)</td>
                <td>Optimized (485 rules)</td>
              </tr>
              <tr>
                <td><strong>SOC Training</strong></td>
                <td>Learn Sentinel ‚Üí Relearn unified</td>
                <td>Learn unified from start</td>
              </tr>
              <tr>
                <td><strong>XDR Benefit Realization</strong></td>
                <td>Month 12+</td>
                <td>Month 2</td>
              </tr>
              <tr>
                <td><strong>Correlation Quality</strong></td>
                <td>Manual KQL for months</td>
                <td>Automatic XDR from start</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>1.4 The Fundamental Architectural Difference</h3>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            This Is the Architectural Truth
          </div>
          <div class="callout-content">
            <p><strong>Splunk is SIEM-first:</strong> You ingest everything you need and build detections and correlations yourself.</p>
            <p><strong>Microsoft is XDR-first:</strong> Detections and correlation happen upstream, and Sentinel focuses on enterprise context.</p>
            <p style="margin-top: 0.5rem;">This is not a feature comparison ‚Äî it's a fundamentally different approach to security operations.</p>
          </div>
        </div>

        <h4>How Splunk Works (Traditional SIEM Model)</h4>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Step</th><th>What Happens</th><th>Ownership</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>1. Ingest Everything</strong></td>
                <td>Endpoint logs, identity logs, email logs, network logs, cloud logs, custom applications ‚Üí Splunk becomes the single source of truth</td>
                <td>You</td>
              </tr>
              <tr>
                <td><strong>2. Build Detections</strong></td>
                <td>Correlation searches, risk-based alerting, threshold logic, MITRE mapping, suppression and tuning ‚Äî even "out-of-the-box" content requires tuning</td>
                <td>You</td>
              </tr>
              <tr>
                <td><strong>3. Handle Correlation</strong></td>
                <td>Splunk has no native upstream XDR engine. If correlation exists, you wrote it and you maintain it.</td>
                <td>You</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p><strong>Mental model:</strong> Splunk is the brain. Everything feeds it. Detection quality depends entirely on your rules.</p>

        <h4>How Microsoft Works (XDR-First Model)</h4>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Step</th><th>What Happens</th><th>Ownership</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>1. XDR Detects First</strong></td>
                <td>Endpoint, identity, email, cloud apps ‚Äî ML + behavior-based, Microsoft-managed, produces high-fidelity incidents</td>
                <td>Microsoft</td>
              </tr>
              <tr>
                <td><strong>2. Sentinel Ingests Outcomes</strong></td>
                <td>XDR incidents, select identity audit logs, network/cloud/SaaS logs, business context ‚Äî Sentinel becomes the enterprise correlation layer</td>
                <td>Shared</td>
              </tr>
              <tr>
                <td><strong>3. Sentinel Rules Change Purpose</strong></td>
                <td>XDR + network correlation, XDR + cloud/IAM, XDR + threat intel, XDR + asset criticality ‚Äî NOT low-level endpoint behaviors</td>
                <td>You (for enterprise context)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p><strong>Mental model:</strong> XDR is the first brain for Defender signals. Sentinel is the second brain for enterprise context.</p>

        <div class="callout info">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Cost Implication: XDR Works Without Sentinel Ingestion</div>
          <div class="callout-content">
            <p><strong>MDE telemetry goes directly to the Defender backend</strong> ‚Äî XDR detections work immediately without Sentinel log ingestion. This means you can:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Roll out MDE agents and enable XDR from Day 1</li>
              <li>Delay full Sentinel log ingestion until detection catalog is designed</li>
              <li>Control costs by ingesting only what Sentinel detections require</li>
            </ul>
            <p style="margin-top: 0.5rem;">See <a href="../program-structure.html">Program Structure</a> for the phased ingestion timeline and <a href="../siem/cost-optimization.html">Cost Optimization</a> for detailed savings analysis.</p>
          </div>
        </div>

        <h4>Side-by-Side Comparison (Interview Gold)</h4>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Aspect</th><th>Splunk ES</th><th>Sentinel + XDR</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Primary Detection</strong></td>
                <td>SIEM</td>
                <td>XDR</td>
              </tr>
              <tr>
                <td><strong>Correlation</strong></td>
                <td>Customer-built</td>
                <td>XDR (Defender) + Sentinel</td>
              </tr>
              <tr>
                <td><strong>Endpoint Intelligence</strong></td>
                <td>External</td>
                <td>Native</td>
              </tr>
              <tr>
                <td><strong>Detection Ownership</strong></td>
                <td>You</td>
                <td>Shared with Microsoft</td>
              </tr>
              <tr>
                <td><strong>Ingestion Strategy</strong></td>
                <td>"Bring everything"</td>
                <td>"Bring what adds value"</td>
              </tr>
              <tr>
                <td><strong>Rule Maintenance</strong></td>
                <td>High</td>
                <td>Reduced</td>
              </tr>
              <tr>
                <td><strong>Architecture Style</strong></td>
                <td>Centralized</td>
                <td>Layered</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            Why This Matters for Migration
          </div>
          <div class="callout-content">
            <p>A Splunk ‚Üí Sentinel migration is <strong>NOT</strong>:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Lift-and-shift rules</li>
              <li>One-to-one detection rewrite</li>
            </ul>
            <p style="margin-top: 0.5rem;">It <strong>IS</strong>:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Detection re-architecture</li>
              <li>Retiring duplicate logic</li>
              <li>Letting XDR do what it's designed for</li>
              <li>Using Sentinel where correlation truly adds value</li>
            </ul>
            <p style="margin-top: 0.5rem;"><em>This is exactly what interviewers want to hear.</em></p>
          </div>
        </div>

        <!-- ==================== SECTION 2: DETECTION OWNERSHIP ==================== -->
        <h2 id="detection-ownership">2. Detection Ownership Model</h2>

        <h3>2.1 The Layered Correlation Model</h3>

        <div class="architecture-diagram">
          <div class="arch-container">
            <div class="arch-layer">
              <div class="arch-layer-title">Layer 1: Microsoft 365 Defender XDR</div>
              <div class="arch-layer-content">
                <div class="arch-box green">MDE<br><small>Endpoint</small></div>
                <div class="arch-box blue">MDO<br><small>Email</small></div>
                <div class="arch-box purple">MDI<br><small>Identity</small></div>
                <div class="arch-box gray">MDCA<br><small>Cloud Apps</small></div>
              </div>
              <p style="text-align: center; margin: 0.5rem 0; color: #22c55e;"><strong>XDR owns: Endpoint + Identity + Email + Cloud App correlation</strong></p>
            </div>
            <div class="arch-arrow">‚Üì Unified Incidents</div>
            <div class="arch-layer">
              <div class="arch-layer-title">Layer 2: Microsoft Sentinel</div>
              <div class="arch-layer-content">
                <div class="arch-box purple">XDR Incidents</div>
                <div class="arch-box blue">Network/Firewall</div>
                <div class="arch-box green">Azure Activity</div>
                <div class="arch-box gray">Custom Apps</div>
              </div>
              <p style="text-align: center; margin: 0.5rem 0; color: #3b82f6;"><strong>Sentinel owns: Network + Azure + Custom + Higher-order</strong></p>
            </div>
            <div class="arch-arrow">‚Üì</div>
            <div class="arch-layer">
              <div class="arch-layer-title">Unified SOC Experience</div>
              <div class="arch-layer-content">
                <div class="arch-box highlight" style="width: 100%;">
                  security.microsoft.com ‚Äî Single incident queue
                </div>
              </div>
            </div>
          </div>
        </div>

        <h3>2.2 Detection Ownership by Domain</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Domain</th><th>Detection Owner</th><th>Sentinel Role</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Endpoint (Windows/Mac/Linux)</strong></td>
                <td><span class="status-badge" style="background: #22c55e; color: white;">XDR (MDE)</span></td>
                <td>Receive incidents, enrich with asset context</td>
              </tr>
              <tr>
                <td><strong>Email (M365)</strong></td>
                <td><span class="status-badge" style="background: #22c55e; color: white;">XDR (MDO)</span></td>
                <td>Correlate with DLP violations</td>
              </tr>
              <tr>
                <td><strong>Identity (Entra ID + On-Prem AD)</strong></td>
                <td><span class="status-badge" style="background: #22c55e; color: white;">XDR (Entra + MDI)</span></td>
                <td>Enrich with conditional access context</td>
              </tr>
              <tr>
                <td><strong>Cloud Apps (SaaS)</strong></td>
                <td><span class="status-badge" style="background: #22c55e; color: white;">XDR (MDCA)</span></td>
                <td>Correlate with DLP</td>
              </tr>
              <tr>
                <td><strong>Network (Firewall/IDS)</strong></td>
                <td><span class="status-badge" style="background: #3b82f6; color: white;">Sentinel</span></td>
                <td>Full detection + correlate with XDR</td>
              </tr>
              <tr>
                <td><strong>Azure Infrastructure</strong></td>
                <td><span class="status-badge" style="background: #3b82f6; color: white;">Sentinel</span></td>
                <td>Full detection</td>
              </tr>
              <tr>
                <td><strong>Custom Applications</strong></td>
                <td><span class="status-badge" style="background: #3b82f6; color: white;">Sentinel</span></td>
                <td>Full detection</td>
              </tr>
              <tr>
                <td><strong>DLP (Purview)</strong></td>
                <td><span class="status-badge" style="background: #3b82f6; color: white;">Sentinel</span></td>
                <td>Full detection + XDR correlation</td>
              </tr>
              <tr>
                <td><strong>Higher-Order Correlation</strong></td>
                <td><span class="status-badge" style="background: #3b82f6; color: white;">Sentinel</span></td>
                <td>XDR + non-Microsoft context</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 3: PORTAL ACCESS ==================== -->
        <h2 id="portal-access">3. Portal Access & Navigation</h2>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Primary SOC Portal
          </div>
          <div class="callout-content">
            <p><strong>URL:</strong> <code>https://security.microsoft.com</code></p>
            <p>This is the unified SOC interface from Day 1. Analysts work here for both XDR and Sentinel incidents.</p>
          </div>
        </div>

        <h3>3.1 Portal Navigation</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Section</th><th>Navigation Path</th><th>Purpose</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Unified Incidents</strong></td>
                <td>Incidents & alerts ‚Üí Incidents</td>
                <td>All incidents (XDR + Sentinel)</td>
              </tr>
              <tr>
                <td><strong>Advanced Hunting</strong></td>
                <td>Hunting ‚Üí Advanced hunting</td>
                <td>KQL across all tables</td>
              </tr>
              <tr>
                <td><strong>Device Inventory</strong></td>
                <td>Assets ‚Üí Devices</td>
                <td>All MDE-managed endpoints</td>
              </tr>
              <tr>
                <td><strong>Threat Analytics</strong></td>
                <td>Threat intelligence ‚Üí Threat analytics</td>
                <td>Microsoft threat intel reports</td>
              </tr>
              <tr>
                <td><strong>XDR Settings</strong></td>
                <td>Settings ‚Üí Microsoft Defender XDR</td>
                <td>Configure connectors, automation</td>
              </tr>
              <tr>
                <td><strong>Sentinel Settings</strong></td>
                <td>Settings ‚Üí Microsoft Sentinel</td>
                <td>Manage workspace connection</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>3.2 Required Roles</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Role</th><th>Scope</th><th>Permissions</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Security Administrator</strong></td>
                <td>M365 + Azure</td>
                <td>Configure XDR settings, connectors, ASR policies</td>
              </tr>
              <tr>
                <td><strong>Security Operator</strong></td>
                <td>M365 + Azure</td>
                <td>Manage incidents, run hunting, take response actions</td>
              </tr>
              <tr>
                <td><strong>Security Reader</strong></td>
                <td>M365 + Azure</td>
                <td>View-only access</td>
              </tr>
              <tr>
                <td><strong>Microsoft Sentinel Contributor</strong></td>
                <td>Azure RBAC</td>
                <td>Manage analytics rules, workbooks, playbooks</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 4: ENABLE INTEGRATIONS ==================== -->
        <h2 id="enable-integrations">4. How to Enable XDR (Month 1)</h2>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Enable XDR in Month 1 ‚Äî Not Later
          </div>
          <div class="callout-content">
            <p>XDR integration should be one of the <strong>first things you do</strong> when setting up Sentinel. Don't wait for "telemetry to stabilize" ‚Äî XDR provides value immediately.</p>
          </div>
        </div>

        <h3>4.1 Step 1: Enable M365 Defender Connector</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Azure Portal Steps</span></div>
          <pre><code>1. Go to: Azure Portal ‚Üí Microsoft Sentinel ‚Üí [Your Workspace]

2. Navigate to: Content hub
   - Search: "Microsoft 365 Defender"
   - Click: Install

3. Navigate to: Data connectors ‚Üí Microsoft 365 Defender
   - Click: Open connector page

4. Under "Configuration", connect:
   ‚òëÔ∏è Microsoft Defender for Endpoint
   ‚òëÔ∏è Microsoft Defender for Office 365
   ‚òëÔ∏è Microsoft Defender for Identity
   ‚òëÔ∏è Microsoft Defender for Cloud Apps
   ‚òëÔ∏è Microsoft Entra ID Protection

5. Enable incident sync:
   ‚òëÔ∏è Turn on "Connect incidents & alerts" (REQUIRED)
   
6. Under "Connect events" (Advanced Hunting):
   ‚ö†Ô∏è SELECTIVE INGESTION ‚Äî Do NOT enable all tables
   
   ‚òëÔ∏è AlertInfo, AlertEvidence (for incident context)
   ‚òê DeviceProcessEvents ‚Äî XDR handles, don't ingest
   ‚òê DeviceFileEvents ‚Äî XDR handles, don't ingest
   ‚òê DeviceRegistryEvents ‚Äî XDR handles, don't ingest
   ‚òê DeviceLogonEvents ‚Äî XDR + MDI handles, don't ingest
   ‚òëÔ∏è DeviceNetworkEvents ‚Äî ONLY if doing XDR + firewall correlation
   ‚òê EmailEvents ‚Äî XDR (MDO) handles, don't ingest

7. Click: Apply Changes

WHY SELECTIVE: XDR already correlates raw events into incidents.
Ingesting all raw tables duplicates detection, increases cost, 
and creates confusion about source of truth.</code></pre>
        </div>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Interview-Ready Explanation: Selective Ingestion
          </div>
          <div class="callout-content">
            <p><em>"When XDR is enabled, we don't automatically ingest all raw MDE tables into Sentinel. XDR already handles endpoint correlation and produces high-fidelity incidents, which Sentinel consumes. We only ingest specific MDE tables if there's a clear need for additional correlation or advanced hunting, and even then we scope and filter them deliberately to avoid duplication and unnecessary cost."</em></p>
          </div>
        </div>

        <h3>4.2 Step 2: Enable Bidirectional Sync</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">M365 Defender Portal Steps</span></div>
          <pre><code>1. Go to: security.microsoft.com

2. Navigate to: Settings ‚Üí Microsoft Defender XDR ‚Üí General

3. Under "Microsoft Sentinel integration":
   ‚òëÔ∏è Enable integration
   - Select your Log Analytics workspace
   ‚òëÔ∏è Sync incident status bidirectionally

4. Navigate to: Settings ‚Üí Microsoft Sentinel ‚Üí Workspaces
   - Verify workspace is connected

Result: XDR incidents appear in Sentinel, status changes sync both ways</code></pre>
        </div>

        <h3>4.3 Step 3: Disable Duplicate Incident Creation (Critical)</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Azure Portal ‚Äî Prevent Duplicates</span></div>
          <pre><code>CRITICAL: This prevents duplicate incidents

1. Go to: Azure Portal ‚Üí Microsoft Sentinel ‚Üí Settings

2. Under "Microsoft Defender XDR incident integration":
   ‚òëÔ∏è Turn off all Microsoft incident creation rules for these products

This disables Sentinel creating incidents for:
- Microsoft Defender for Endpoint
- Microsoft Defender for Office 365
- Microsoft Defender for Identity  
- Microsoft Defender for Cloud Apps
- Microsoft Entra ID Protection

WHY: XDR creates the correlated incident. Without this, you get:
- 1 XDR incident (correlated)
- + 5 Sentinel incidents (duplicates)
= Noise and confusion</code></pre>
        </div>

        <h3>4.4 Step 4: Enable Unified Portal Experience</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Enable Sentinel in Defender Portal</span></div>
          <pre><code>1. Go to: security.microsoft.com

2. Navigate to: Settings ‚Üí Microsoft Sentinel ‚Üí Workspaces

3. Click: Connect workspace
   - Select your Log Analytics workspace

4. Once connected:
   - Sentinel incidents appear in unified queue
   - Sentinel hunting queries available
   - Single SOC interface

SOC analysts now work in security.microsoft.com
Azure Portal Sentinel is for administration only</code></pre>
        </div>

        <!-- ==================== SECTION 4.5: WHAT TO INGEST BY DOMAIN ==================== -->
        <h2 id="what-to-ingest">4.5 What to Ingest by Domain (XDR-First)</h2>

        <p>This is the critical architectural decision: what data flows into Sentinel vs. what stays in XDR. The principle is simple ‚Äî <strong>ingest XDR incidents, not raw telemetry</strong>.</p>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            The Core Rule
          </div>
          <div class="callout-content">
            <p><strong>With XDR enabled, Sentinel should consume XDR incidents by default; raw MDE tables are optional and ingested only when there's a clear use case.</strong></p>
          </div>
        </div>

        <h3>4.5.1 Endpoint (Microsoft Defender for Endpoint)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Type</th><th>Table</th><th>Ingest?</th><th>Reasoning</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>XDR Incidents</strong></td>
                <td><code>SecurityIncident</code></td>
                <td><span class="status-badge complete">Yes (Always)</span></td>
                <td>Correlated incidents ‚Äî primary detection source</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>XDR Alerts</strong></td>
                <td><code>SecurityAlert</code></td>
                <td><span class="status-badge complete">Yes (Always)</span></td>
                <td>Individual alerts, needed for correlation rules</td>
              </tr>
              <tr>
                <td><strong>Process Events</strong></td>
                <td><code>DeviceProcessEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR handles process-based detection with kernel visibility</td>
              </tr>
              <tr>
                <td><strong>File Events</strong></td>
                <td><code>DeviceFileEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR handles file-based detection</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Network Events</strong></td>
                <td><code>DeviceNetworkEvents</code></td>
                <td><span class="status-badge in-progress">Selective</span></td>
                <td>Only if doing XDR + firewall correlation (higher-order rules)</td>
              </tr>
              <tr>
                <td><strong>Registry Events</strong></td>
                <td><code>DeviceRegistryEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR handles persistence detection</td>
              </tr>
              <tr>
                <td><strong>Logon Events</strong></td>
                <td><code>DeviceLogonEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR + MDI handles logon correlation</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>4.5.2 Identity (Microsoft Entra ID + MDI)</h3>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Critical: MDI + XDR ‚â† Entra ID Logs (Complementary, Not Duplicates)
          </div>
          <div class="callout-content">
            <p><strong>Defender for Identity (MDI) + XDR covers:</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Identity-based <strong>attacks</strong> (credential theft, lateral movement, privilege escalation)</li>
              <li>Suspicious authentication behavior</li>
              <li>Reconnaissance against identity infrastructure</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Entra ID diagnostic logs cover:</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Identity <strong>operations</strong> (who signed in, how, where)</li>
              <li>Governance and audit (role changes, app consents, MFA policy changes)</li>
              <li>Compliance evidence and access reviews</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Key insight:</strong> XDR does NOT replace Entra ID diagnostic logs. They serve different purposes.</p>
          </div>
        </div>

        <h4>Why You Still Need Entra ID Logs (Even with XDR)</h4>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Use Case</th><th>Entra ID Log</th><th>Why XDR Can't Replace This</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Governance & Compliance</strong></td>
                <td><code>AuditLogs</code></td>
                <td>Who granted admin rights? Who modified Conditional Access? Who consented to an app? XDR doesn't answer these cleanly.</td>
              </tr>
              <tr>
                <td><strong>Identity Change Tracking</strong></td>
                <td><code>AuditLogs</code></td>
                <td>Role assignments, MFA policy changes, app registrations. These are not attacks, but they are security-relevant.</td>
              </tr>
              <tr>
                <td><strong>Cross-Domain Correlation</strong></td>
                <td><code>SigninLogs</code> + <code>AuditLogs</code></td>
                <td>XDR identity incident + recent admin role assignment requires Entra ID logs in Sentinel.</td>
              </tr>
              <tr>
                <td><strong>Investigation Context</strong></td>
                <td><code>SigninLogs</code></td>
                <td>Validate XDR incident with sign-in location, device, CA policy applied.</td>
              </tr>
              <tr>
                <td><strong>Regulatory Evidence</strong></td>
                <td>All Entra ID logs</td>
                <td>Audit trails for access reviews, compliance reporting.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h4>Entra ID Logs to Ingest</h4>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Type</th><th>Table</th><th>Ingest?</th><th>Reasoning</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>XDR Identity Incidents</strong></td>
                <td><code>SecurityIncident</code></td>
                <td><span class="status-badge complete">Yes (Always)</span></td>
                <td>XDR correlates identity attacks with endpoint + email</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Sign-in Logs</strong></td>
                <td><code>SigninLogs</code></td>
                <td><span class="status-badge complete">Yes (Keep)</span></td>
                <td>Investigation context, cross-domain correlation, compliance</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Audit Logs</strong></td>
                <td><code>AuditLogs</code></td>
                <td><span class="status-badge complete">Yes (Keep)</span></td>
                <td>Governance, privilege changes, compliance reporting</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Non-Interactive Sign-ins</strong></td>
                <td><code>AADNonInteractiveUserSignInLogs</code></td>
                <td><span class="status-badge in-progress">Optional</span></td>
                <td>Service principals, automation ‚Äî ingest if needed for correlation</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Managed Identity Sign-ins</strong></td>
                <td><code>ManagedIdentitySignInLogs</code></td>
                <td><span class="status-badge in-progress">Optional</span></td>
                <td>Workload identities ‚Äî ingest if correlating with Azure resources</td>
              </tr>
              <tr>
                <td><strong>Identity Protection Alerts</strong></td>
                <td><code>AADUserRiskEvents</code></td>
                <td><span class="status-badge">Via XDR</span></td>
                <td>Flows through XDR incident ‚Äî don't duplicate in Sentinel rules</td>
              </tr>
              <tr>
                <td><strong>MDI Alerts</strong></td>
                <td><code>SecurityAlert</code></td>
                <td><span class="status-badge">Via XDR</span></td>
                <td>Identity attack detection ‚Äî flows through XDR correlation</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            What You Should NOT Do
          </div>
          <div class="callout-content">
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>‚ùå Do NOT disable Entra ID diagnostics assuming XDR replaces them</li>
              <li>‚ùå Do NOT try to rebuild MDI detections in Sentinel</li>
              <li>‚ùå Do NOT stream all identity logs blindly without purpose</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Bottom line:</strong> MDI handles identity attacks. Entra ID logs handle identity operations, governance, and audit. They are complementary.</p>
          </div>
        </div>

        <h3>4.5.3 Email (Microsoft Defender for Office 365)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Type</th><th>Table</th><th>Ingest?</th><th>Reasoning</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>XDR Email Incidents</strong></td>
                <td><code>SecurityIncident</code></td>
                <td><span class="status-badge complete">Yes (Always)</span></td>
                <td>Phishing/BEC detection via XDR</td>
              </tr>
              <tr>
                <td><strong>Email Events</strong></td>
                <td><code>EmailEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR (MDO) handles email detection natively</td>
              </tr>
              <tr>
                <td><strong>Email Attachments</strong></td>
                <td><code>EmailAttachmentInfo</code></td>
                <td><span class="status-badge">No</span></td>
                <td>Safe Attachments in XDR handles this</td>
              </tr>
              <tr>
                <td><strong>Email URLs</strong></td>
                <td><code>EmailUrlInfo</code></td>
                <td><span class="status-badge">No</span></td>
                <td>Safe Links in XDR handles this</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>4.5.4 Cloud Apps (Microsoft Defender for Cloud Apps)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Type</th><th>Table</th><th>Ingest?</th><th>Reasoning</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>XDR Cloud App Incidents</strong></td>
                <td><code>SecurityIncident</code></td>
                <td><span class="status-badge complete">Yes (Always)</span></td>
                <td>OAuth abuse, mass download via XDR</td>
              </tr>
              <tr>
                <td><strong>Cloud App Events</strong></td>
                <td><code>CloudAppEvents</code></td>
                <td><span class="status-badge">No</span></td>
                <td>XDR (MDCA) handles cloud app detection</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>4.5.5 What Sentinel Owns Fully (No XDR Coverage)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Data Type</th><th>Table</th><th>Ingest?</th><th>Reasoning</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Network/Firewall</strong></td>
                <td><code>CommonSecurityLog</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>XDR has no visibility ‚Äî Sentinel owns network detection</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Azure Control Plane</strong></td>
                <td><code>AzureActivity</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>XDR has no visibility ‚Äî Sentinel owns Azure detection</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Azure Diagnostics</strong></td>
                <td><code>AzureDiagnostics</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>Key Vault, SQL, networking ‚Äî Sentinel owns</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>DLP Logs</strong></td>
                <td><code>PurviewDLPLogs</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>XDR + DLP correlation in Sentinel</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>DNS Events</strong></td>
                <td><code>DnsEvents</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>DNS tunneling detection in Sentinel</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Custom Apps</strong></td>
                <td><code>Custom_CL</code></td>
                <td><span class="status-badge complete">Yes (Full)</span></td>
                <td>Business-specific detection in Sentinel</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            The Decision Framework
          </div>
          <div class="callout-content">
            <p><strong>Before ingesting any data, ask:</strong></p>
            <ol style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Does XDR already detect and explain this attack? (If yes ‚Üí don't ingest raw tables)</li>
              <li>Do we need raw fields for cross-vendor correlation? (If yes ‚Üí ingest selectively)</li>
              <li>Is this worth the ingestion cost and SOC complexity? (Cost/benefit)</li>
              <li>Is this temporary (migration) or permanent? (Review quarterly)</li>
            </ol>
          </div>
        </div>
        <h2 id="what-xdr-handles">5. What XDR Handles Automatically</h2>

        <p>These are detections you <strong>do not build in Sentinel</strong> because XDR handles them natively with better context.</p>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Critical: XDR Detection Model ‚â† SIEM Detection Model
          </div>
          <div class="callout-content">
            <p><strong>XDR does NOT rely on Sentinel detection rules to work well.</strong> XDR has its own built-in detections and automatic correlation. This is fundamentally different from SIEM.</p>
            <p style="margin-top: 0.5rem;"><strong>Key differences:</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>XDR detections</strong> are Microsoft-managed, behavior + ML-based, continuously updated</li>
              <li><strong>You cannot see</strong> the exact detection logic, cannot edit them, should not try to recreate them</li>
              <li><strong>Correlation in XDR is automatic</strong> ‚Äî you do NOT configure correlation rules</li>
              <li><strong>This is the core value of XDR</strong> ‚Äî detection and correlation happen without rule authoring</li>
            </ul>
          </div>
        </div>

        <h3>5.1 XDR Detection Types (Two Categories)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Type</th><th>Description</th><th>User Control</th><th>Use</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Built-in XDR Detections (Primary)</strong></td>
                <td>Microsoft-managed, ML + behavioral, covers malware, ransomware, credential theft, lateral movement, phishing chains</td>
                <td>‚ùå Cannot see exact logic<br>‚ùå Cannot edit<br>‚ùå Should not recreate</td>
                <td>This is the core value ‚Äî let XDR do its job</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Custom Detections in XDR (Secondary, Optional)</strong></td>
                <td>Created via Advanced Hunting queries, scoped to Defender data only</td>
                <td>‚úì You create the query<br>‚ùå Limited scope<br>‚ùå Not for complex cross-product correlation</td>
                <td>Tactical add-ons for niche scenarios Microsoft doesn't cover</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            XDR Custom Detections Are NOT SIEM Rules
          </div>
          <div class="callout-content">
            <p>XDR allows optional custom detections (via Advanced Hunting), but with clear limits:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Scoped to Defender data only</strong> ‚Äî can't query non-Microsoft sources</li>
              <li><strong>Tactical add-ons</strong> ‚Äî not a detection engine replacement</li>
              <li><strong>Cannot replace built-in XDR detections</strong> ‚Äî Microsoft's are better</li>
              <li><strong>Cannot do complex cross-product correlation like Sentinel</strong></li>
            </ul>
            <p style="margin-top: 0.5rem;">Think of XDR custom detections as "I need to alert on this very specific behavior Microsoft doesn't cover" ‚Äî not "I'm building my detection library here."</p>
          </div>
        </div>

        <h3>5.2 Automatic Correlation in XDR (No Rules to Configure)</h3>

        <p><strong>Correlation in XDR is automatic.</strong> You do not configure correlation rules. XDR uses endpoint, email, identity, and cloud app signals to build one incident with one timeline and one severity.</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Attack Chain</th><th>XDR Automatic Correlation</th><th>What It Produces</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Phishing ‚Üí Malware</strong></td>
                <td>Links email to endpoint execution automatically</td>
                <td>Single incident with email + endpoint timeline</td>
              </tr>
              <tr>
                <td><strong>Credential Theft ‚Üí Lateral Movement</strong></td>
                <td>Links credential access to network logons automatically</td>
                <td>Single incident with full attack path</td>
              </tr>
              <tr>
                <td><strong>BEC ‚Üí Data Access</strong></td>
                <td>Links email compromise to SharePoint access automatically</td>
                <td>Single incident with identity + data context</td>
              </tr>
              <tr>
                <td><strong>Identity ‚Üí Cloud App Abuse</strong></td>
                <td>Links risky sign-in to OAuth consent to exfil automatically</td>
                <td>Single incident with full chain</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            Interview-Ready Explanation
          </div>
          <div class="callout-content">
            <p><em>"XDR doesn't work like a SIEM ‚Äî it doesn't rely on user-authored detection rules. XDR has Microsoft-managed, ML + behavioral detections that are continuously updated. Correlation is automatic. You cannot see the exact detection logic, and you shouldn't try to recreate it. When we enable XDR, we're trusting Microsoft's detection engine for endpoint, identity, and email. Sentinel's role becomes higher-order ‚Äî correlating XDR incidents with network, cloud, and business context that XDR can't see."</em></p>
          </div>
        </div>

        <h3>5.3 Built-in Detections (Don't Rebuild)</h3>

        <p>These are examples of what XDR detects automatically. <strong>You cannot see the exact logic.</strong> You trust the platform and consume the incidents.</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Detection</th><th>XDR Product</th><th>Why XDR Is Better</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>LSASS Credential Dumping</strong></td>
                <td>MDE</td>
                <td>Kernel-level visibility, AMSI integration</td>
              </tr>
              <tr>
                <td><strong>Encoded PowerShell</strong></td>
                <td>MDE</td>
                <td>Decodes in-memory, catches obfuscation</td>
              </tr>
              <tr>
                <td><strong>Ransomware</strong></td>
                <td>MDE</td>
                <td>Behavioral blocking (prevents, not just detects)</td>
              </tr>
              <tr>
                <td><strong>Impossible Travel</strong></td>
                <td>Entra ID Protection</td>
                <td>ML model per user, learns patterns</td>
              </tr>
              <tr>
                <td><strong>Password Spray</strong></td>
                <td>Entra ID Protection</td>
                <td>ML across tenant</td>
              </tr>
              <tr>
                <td><strong>Kerberoasting</strong></td>
                <td>MDI</td>
                <td>Domain controller visibility</td>
              </tr>
              <tr>
                <td><strong>DCSync</strong></td>
                <td>MDI</td>
                <td>Direct DC monitoring</td>
              </tr>
              <tr>
                <td><strong>Phishing</strong></td>
                <td>MDO</td>
                <td>Content analysis, sandbox detonation</td>
              </tr>
              <tr>
                <td><strong>BEC</strong></td>
                <td>MDO</td>
                <td>ML on org communication patterns</td>
              </tr>
              <tr>
                <td><strong>OAuth Abuse</strong></td>
                <td>MDCA</td>
                <td>Consent grant visibility</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>5.3 Automatic Response Actions</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Action</th><th>XDR Capability</th><th>Trigger</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>Isolate Device</strong></td><td>Network isolation</td><td>High-severity endpoint incident</td></tr>
              <tr><td><strong>Disable User</strong></td><td>Entra ID disable</td><td>Credential compromise</td></tr>
              <tr><td><strong>Block File Hash</strong></td><td>Tenant-wide block</td><td>Confirmed malware</td></tr>
              <tr><td><strong>Quarantine Email</strong></td><td>Remove from all mailboxes</td><td>Phishing detection</td></tr>
              <tr><td><strong>Revoke Sessions</strong></td><td>Invalidate tokens</td><td>Token theft</td></tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 6: WHAT SENTINEL OWNS ==================== -->
        <h2 id="what-sentinel-owns">6. What Sentinel Owns (401 Rules)</h2>

        <p>These are the detection rules that belong in Sentinel because XDR doesn't cover them.</p>

        <h3>6.1 Sentinel Detection Summary</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Category</th><th>Rules</th><th>Tables</th><th>Why Sentinel</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Network Security</strong></td>
                <td>85</td>
                <td>CommonSecurityLog, Syslog</td>
                <td>Firewall/IDS not in XDR</td>
              </tr>
              <tr>
                <td><strong>Azure Infrastructure</strong></td>
                <td>65</td>
                <td>AzureActivity, AzureDiagnostics</td>
                <td>Azure control plane not in M365D</td>
              </tr>
              <tr>
                <td><strong>Higher-Order Correlation</strong></td>
                <td>35</td>
                <td>SecurityIncident + various</td>
                <td>XDR + non-Microsoft context</td>
              </tr>
              <tr>
                <td><strong>DLP Context</strong></td>
                <td>25</td>
                <td>PurviewDLPLogs</td>
                <td>Exfiltration correlation</td>
              </tr>
              <tr>
                <td><strong>Custom Applications</strong></td>
                <td>22</td>
                <td>Custom tables</td>
                <td>Business-specific logic</td>
              </tr>
              <tr>
                <td><strong>Linux Servers</strong></td>
                <td>18</td>
                <td>Syslog</td>
                <td>Edge cases</td>
              </tr>
              <tr>
                <td><strong>Third-Party SaaS</strong></td>
                <td>15</td>
                <td>Various</td>
                <td>Non-Microsoft apps</td>
              </tr>
              <tr>
                <td><strong>Threat Intelligence</strong></td>
                <td>8</td>
                <td>ThreatIntelligenceIndicator</td>
                <td>Non-Microsoft TI feeds</td>
              </tr>
              <tr>
                <td><strong>TOTAL</strong></td>
                <td><strong>347</strong></td>
                <td></td>
                <td>255 migrated + 230 new</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>6.2 Example Sentinel Detections</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Detection</th><th>MITRE</th><th>Table</th></tr>
            </thead>
            <tbody>
              <tr><td>C2 Beaconing Pattern</td><td>T1071</td><td>CommonSecurityLog</td></tr>
              <tr><td>DNS Tunneling</td><td>T1071.004</td><td>DnsEvents</td></tr>
              <tr><td>Firewall Allow After Denies</td><td>T1190</td><td>CommonSecurityLog</td></tr>
              <tr><td>Large Data Transfer External</td><td>T1048</td><td>CommonSecurityLog</td></tr>
              <tr><td>Azure Resource Deletion</td><td>T1485</td><td>AzureActivity</td></tr>
              <tr><td>NSG Rule Modified</td><td>T1562</td><td>AzureActivity</td></tr>
              <tr><td>Key Vault Secret Access</td><td>T1552</td><td>AzureDiagnostics</td></tr>
              <tr><td>Storage Public Access</td><td>T1530</td><td>AzureActivity</td></tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 6.5: XDR CORRELATION SCOPE ==================== -->
        <h2 id="xdr-correlation-scope">6.5 XDR Correlation Scope (Critical Understanding)</h2>

        <p>Understanding <strong>what XDR correlates automatically</strong> vs. <strong>when Sentinel rules are required</strong> is essential for correct detection architecture.</p>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            XDR Correlates Defender Signals Only
          </div>
          <div class="callout-content">
            <p><strong>XDR handles correlation only within Microsoft 365 Defender signals:</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>Endpoint (MDE)</li>
              <li>Email (Defender for Office 365)</li>
              <li>Identity (Defender for Identity)</li>
              <li>Cloud Apps (Defender for Cloud Apps)</li>
            </ul>
            <p style="margin-top: 0.5rem;">This correlation is built-in, ML/behavior-driven, and produces unified incidents. <strong>No custom correlation rules needed.</strong></p>
            <p><strong>Key Rule:</strong> If all signals are Defender-native ‚Üí XDR handles it. If any signal is non-Defender ‚Üí Sentinel rule required.</p>
          </div>
        </div>

        <h3>6.5.1 When Sentinel Correlation Rules ARE Required</h3>

        <p>You must write Sentinel correlation rules when correlating XDR output with <strong>non-Defender telemetry</strong>:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Correlation Type</th><th>Data Sources</th><th>Example Scenario</th><th>Sentinel Rule Required?</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + Network</strong></td>
                <td>Firewall, Proxy, DNS, NetFlow</td>
                <td>XDR malware incident + outbound traffic to known C2 IP</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + Cloud Infrastructure</strong></td>
                <td>AWS CloudTrail, Azure Activity, GCP logs</td>
                <td>XDR endpoint compromise + AWS IAM key creation</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + Custom Applications</strong></td>
                <td>Internal apps, APIs, databases</td>
                <td>XDR incident on developer workstation + suspicious access to internal repo</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + Business Context</strong></td>
                <td>VIP users, CMDB, crown jewels</td>
                <td>XDR incident involving privileged user or critical system</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + External TI</strong></td>
                <td>MISP, commercial TI, open-source feeds</td>
                <td>XDR incident + IP seen in premium TI feed</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.1);">
                <td><strong>XDR + External Vuln Data</strong></td>
                <td>Qualys, Nessus, Rapid7</td>
                <td>XDR malware incident + Qualys critical CVE + exposed firewall rule</td>
                <td><span class="status-badge critical">Yes</span></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Detection Engineering With XDR Enabled
          </div>
          <div class="callout-content">
            <p><strong>Layered model (correct architecture):</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>XDR:</strong> Detect & correlate Defender signals (automatic)</li>
              <li><strong>Sentinel:</strong> Correlate XDR with external telemetry (user-authored rules)</li>
              <li><strong>SOAR:</strong> Orchestrate response</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Key principle:</strong> You do NOT duplicate XDR logic in Sentinel. You <em>extend</em> XDR context with enterprise signals.</p>
          </div>
        </div>

        <h3>6.5.2 Threat Intelligence: XDR vs Sentinel</h3>

        <p>XDR detects attacks. Threat intel provides context. Sentinel is where external TI is correlated.</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Aspect</th><th>XDR (M365 Defender)</th><th>Sentinel</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>TI Source</strong></td>
                <td>Microsoft global threat intel (built-in)</td>
                <td>External TI feeds (MISP, commercial, open-source)</td>
              </tr>
              <tr>
                <td><strong>TI Management</strong></td>
                <td>‚ùå Cannot manage feeds</td>
                <td>‚úì Ingest, store, manage indicators</td>
              </tr>
              <tr>
                <td><strong>TI Correlation</strong></td>
                <td>Inline enrichment for alerts ("Is this known bad according to Microsoft?")</td>
                <td>Correlate TI with network, cloud, XDR incidents, custom apps</td>
              </tr>
              <tr>
                <td><strong>Role</strong></td>
                <td>Built-in TI enrichment</td>
                <td><strong>TI management and correlation engine</strong></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            TI Example Requiring Sentinel Rule
          </div>
          <div class="callout-content">
            <p><strong>Scenario:</strong> XDR incident + IP seen in premium TI feed (not Microsoft's built-in TI)</p>
            <p><strong>Why Sentinel required:</strong> XDR only uses Microsoft's TI. External TI feeds are ingested into Sentinel, so correlation happens there.</p>
          </div>
        </div>

        <h3>6.5.3 Vulnerability Management: XDR vs Sentinel</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Aspect</th><th>XDR (TVM - Defender Vulnerability Management)</th><th>Sentinel</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Visibility</strong></td>
                <td>Software inventory, missing patches, exposure scores, exploitability context</td>
                <td>Correlates vuln data with network, cloud, external scanners</td>
              </tr>
              <tr>
                <td><strong>Correlation</strong></td>
                <td>‚úì Automatic: malware execution + vulnerable software present</td>
                <td>External scanners (Qualys, Nessus) + other context</td>
              </tr>
              <tr>
                <td><strong>Scope</strong></td>
                <td>Defender-managed endpoints only</td>
                <td>Cross-platform, cross-vendor</td>
              </tr>
              <tr>
                <td><strong>Use Case</strong></td>
                <td>"Is this endpoint vulnerable, and how risky is it?"</td>
                <td>"Correlate XDR incident + Qualys CVE + exposed firewall rule"</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>6.5.4 Asset Discovery & Business Context</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Aspect</th><th>XDR (via MDE + TVM)</th><th>Sentinel</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Asset Visibility</strong></td>
                <td>Managed endpoints, installed software, device risk</td>
                <td>CMDB, cloud inventories, network devices, SaaS platforms</td>
              </tr>
              <tr>
                <td><strong>Business Context</strong></td>
                <td>‚ùå No business criticality awareness</td>
                <td>‚úì VIP users, crown jewels, asset criticality from CMDB</td>
              </tr>
              <tr>
                <td><strong>Question Answered</strong></td>
                <td>"What devices do we have and what's on them?"</td>
                <td>"How critical is this asset to the business?"</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Interview-Ready Summary
          </div>
          <div class="callout-content">
            <p><em>"XDR correlates automatically within Defender signals ‚Äî endpoint, email, identity, cloud apps. No rules needed. But when you need to correlate XDR output with non-Defender data ‚Äî network, cloud infrastructure, custom apps, business context, external TI, external vuln scanners ‚Äî that's where Sentinel rules are required. You don't duplicate XDR logic; you extend XDR context with enterprise signals."</em></p>
          </div>
        </div>

        <!-- ==================== SECTION 7: HIGHER-ORDER CORRELATION ==================== -->
        <h2 id="higher-order-correlation">7. Higher-Order Correlation Rules</h2>

        <p>Sentinel's <strong>unique value-add</strong>: correlating XDR incidents with non-Microsoft context.</p>

        <h3>7.1 Example: XDR + Firewall Context</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">KQL ‚Äî XDR Incident + Firewall Bytes</span></div>
          <pre><code>// Enrich XDR endpoint compromise with firewall exfiltration
SecurityIncident
| where TimeGenerated > ago(24h)
| where ProviderName == "Microsoft 365 Defender"
| mv-expand AlertIds
| join kind=inner (
    SecurityAlert | mv-expand Entities
    | where Entities.Type == "host"
    | extend DeviceName = tostring(Entities.HostName)
) on $left.AlertId == $right.SystemAlertId
| join kind=inner (
    CommonSecurityLog
    | where DeviceVendor == "Palo Alto Networks"
    | where DestinationIP !startswith "10."
    | summarize TotalBytes = sum(SentBytes) by SourceIP
) on $left.DeviceName == $right.SourceIP
| where TotalBytes > 100000000  // > 100MB
| project IncidentNumber, Title, DeviceName, BytesExfiltrated = TotalBytes</code></pre>
        </div>

        <h3>7.2 Example: XDR + DLP Context</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">KQL ‚Äî XDR Incident + DLP Violation</span></div>
          <pre><code>// Correlate XDR incident with DLP violations
SecurityIncident
| where TimeGenerated > ago(24h)
| where ProviderName == "Microsoft 365 Defender"
| mv-expand AlertIds
| join kind=inner (
    SecurityAlert | mv-expand Entities
    | where Entities.Type == "account"
    | extend User = tostring(Entities.Name)
) on $left.AlertId == $right.SystemAlertId
| join kind=inner (
    PurviewDLPLogs
    | where SensitiveInfoType has_any ("Credit Card", "SSN")
) on $left.User == $right.User
| project IncidentNumber, Title, User, DLPPolicy = PolicyName, SensitiveData = SensitiveInfoType</code></pre>
        </div>

        <h3>7.3 Higher-Order Rule Catalog</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Rule</th><th>Correlation</th><th>Value</th></tr>
            </thead>
            <tbody>
              <tr><td>XDR + Large Transfer</td><td>XDR + Firewall bytes</td><td>Detect exfiltration</td></tr>
              <tr><td>XDR + DLP Block</td><td>XDR + DLP violation</td><td>Confirm exfil attempt</td></tr>
              <tr><td>XDR + Critical Asset</td><td>XDR + Watchlist</td><td>Auto-escalate</td></tr>
              <tr><td>XDR + VIP User</td><td>XDR + Executive list</td><td>Auto-escalate</td></tr>
              <tr><td>XDR + Key Vault</td><td>Identity + Secret access</td><td>Detect secret theft</td></tr>
              <tr><td>XDR + Azure Change</td><td>Identity + Resource mod</td><td>Detect cloud abuse</td></tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 8: UNIFIED SOC ==================== -->
        <h2 id="unified-soc">8. Unified SOC Experience</h2>

        <h3>8.1 SOC Workflow</h3>

        <div class="flow-diagram">
          <div class="flow-step">
            <div class="flow-step-number">1</div>
            <div class="flow-step-content">
              <strong>Incident in Unified Queue</strong><br>
              security.microsoft.com ‚Üí Incidents
            </div>
          </div>
          <div class="flow-connector">‚Üì</div>
          <div class="flow-step">
            <div class="flow-step-number">2</div>
            <div class="flow-step-content">
              <strong>Triage with XDR Context</strong><br>
              Attack story, timeline, MITRE mapping provided
            </div>
          </div>
          <div class="flow-connector">‚Üì</div>
          <div class="flow-step">
            <div class="flow-step-number">3</div>
            <div class="flow-step-content">
              <strong>Investigate via Advanced Hunting</strong><br>
              KQL across all tables
            </div>
          </div>
          <div class="flow-connector">‚Üì</div>
          <div class="flow-step">
            <div class="flow-step-number">4</div>
            <div class="flow-step-content">
              <strong>Take Response Actions</strong><br>
              Isolate, disable, block ‚Äî same portal
            </div>
          </div>
          <div class="flow-connector">‚Üì</div>
          <div class="flow-step">
            <div class="flow-step-number">5</div>
            <div class="flow-step-content">
              <strong>Close Incident</strong><br>
              Status syncs to both XDR and Sentinel
            </div>
          </div>
        </div>

        <h3>8.2 Expected Metrics Improvement</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Metric</th><th>Legacy SIEM</th><th>XDR-First</th><th>Improvement</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>MTTD</strong></td><td>~4 hours</td><td>~2 hours</td><td>50% faster</td></tr>
              <tr><td><strong>MTTR</strong></td><td>~6 hours</td><td>~4 hours</td><td>33% faster</td></tr>
              <tr><td><strong>Alert:Incident Ratio</strong></td><td>10:1</td><td>3:1</td><td>70% less noise</td></tr>
              <tr><td><strong>False Positive Rate</strong></td><td>~25%</td><td>~15%</td><td>10% reduction</td></tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION: SECURITY STACK CONFIGURATION TIMELINES ==================== -->
        <h2 id="config-timelines">9. Microsoft Security Stack Configuration Timelines</h2>

        <div class="callout warning">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>These Are NOT Plug-and-Play Products</div>
          <div class="callout-content">
            <p><strong>Configuring MDE, MDO, MDI, and MDCA takes time.</strong> How long depends on environment size, identity maturity, and how clean the tenant is. Each product requires phased onboarding and tuning ‚Äî not just "enable and forget."</p>
          </div>
        </div>

        <h3>9.1 Microsoft Security Stack Overview</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Product</th><th>Purpose</th><th>Typical Setup Time</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>MDE</strong> (Defender for Endpoint)</td><td>Endpoint detection & response</td><td>4‚Äì8 weeks</td></tr>
              <tr><td><strong>MDO</strong> (Defender for Office 365)</td><td>Protects email & collaboration (phishing, malware, BEC)</td><td>2‚Äì4 weeks baseline, 6‚Äì8 weeks to mature</td></tr>
              <tr><td><strong>MDI</strong> (Defender for Identity)</td><td>Detects identity-based threats (AD attacks, lateral movement)</td><td>3‚Äì6 weeks</td></tr>
              <tr><td><strong>MDCA</strong> (Defender for Cloud Apps)</td><td>SaaS visibility, app governance, session control</td><td>4‚Äì8 weeks</td></tr>
              <tr><td><strong>XDR</strong> (Unified)</td><td>Correlates all signals across products</td><td>Immediate once products connected</td></tr>
            </tbody>
          </table>
        </div>

        <h3>9.2 MDE (Defender for Endpoint) ‚Äî 4‚Äì8 Weeks</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDE Configuration Phases</span></div>
          <pre><code>PHASE 1 ‚Äî DEPLOYMENT (Weeks 1-3)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Onboard devices via Intune, GPO, or SCCM
‚Ä¢ Validate agent connectivity and health
‚Ä¢ Configure device groups (pilot ‚Üí production)
‚Ä¢ Enable cloud-delivered protection

PHASE 2 ‚Äî FEATURE ENABLEMENT (Weeks 2-5)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Enable Attack Surface Reduction (ASR) rules in audit mode
‚Ä¢ Configure Device Control policies
‚Ä¢ Enable Tamper Protection
‚Ä¢ Configure Network Protection
‚Ä¢ Set up automated investigation & response (AIR)

PHASE 3 ‚Äî TUNING & ENFORCEMENT (Weeks 4-8)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Analyze ASR audit logs for false positives
‚Ä¢ Tune exclusions (careful ‚Äî don't over-exclude)
‚Ä¢ Move ASR rules from audit ‚Üí block
‚Ä¢ Validate detection coverage
‚Ä¢ Remove legacy AV (ESET in our case)

üîπ WHY IT TAKES TIME:
‚Ä¢ Application compatibility testing (ASR rules break things)
‚Ä¢ Phased rollout to avoid mass disruption
‚Ä¢ Exclusion tuning requires real-world data
‚Ä¢ Legacy AV removal must be coordinated</code></pre>
        </div>

        <h3>9.3 MDO (Defender for Office 365) ‚Äî 2‚Äì8 Weeks</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDO Configuration Phases</span></div>
          <pre><code>PHASE 1 ‚Äî ENABLE & BASELINE (Weeks 1-2)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Enable Defender for O365 Plan 1/2
‚Ä¢ Configure:
   - Anti-phishing policies
   - Anti-malware policies
   - Safe Links
   - Safe Attachments
‚Ä¢ Set monitoring mode (no blocking initially)

PHASE 2 ‚Äî TUNE & VALIDATE (Weeks 2-4)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Reduce false positives
‚Ä¢ Exclude trusted senders/domains
‚Ä¢ Validate email flows (especially for):
   - 3rd-party email marketing tools
   - Automated systems (ticketing, alerts)
   - Partner/vendor communications

PHASE 3 ‚Äî ENFORCE (Weeks 4-8)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Enable blocking mode
‚Ä¢ Enable impersonation protection (executives, partners)
‚Ä¢ Enable user-reported phishing integration
‚Ä¢ Configure quarantine policies

üîπ WHY IT TAKES TIME:
‚Ä¢ Business email flows are complex
‚Ä¢ False positives disrupt operations (blocked invoices = angry CFO)
‚Ä¢ Executive impersonation tuning is critical
‚Ä¢ Third-party integrations need testing</code></pre>
        </div>

        <h3>9.4 MDI (Defender for Identity) ‚Äî 3‚Äì6 Weeks</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDI Configuration Phases</span></div>
          <pre><code>PHASE 1 ‚Äî SENSOR DEPLOYMENT (Week 1-2)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Install MDI sensors on:
   - All Domain Controllers
   - AD FS servers (if applicable)
‚Ä¢ Validate network connectivity to MDI cloud service
‚Ä¢ Ensure no packet loss (port mirroring or agent mode)
‚Ä¢ Configure Directory Service account

PHASE 2 ‚Äî LEARNING PERIOD (Weeks 2-4)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ MDI learns normal behavior:
   - User login patterns
   - Service account behavior
   - Legacy protocols (NTLM, LDAP usage)
‚Ä¢ Mark known service accounts to reduce noise
‚Ä¢ Configure sensitive accounts and groups

PHASE 3 ‚Äî DETECTION TUNING (Weeks 3-6)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Tune alerts for:
   - Lateral movement detection
   - Pass-the-hash / Pass-the-ticket
   - DCSync attacks
   - Abnormal/impossible travel logins
‚Ä¢ Reduce noise from:
   - Service accounts with weird behavior
   - Scanning tools (vulnerability scanners)
   - Legacy applications using NTLM

üîπ WHY IT TAKES TIME:
‚Ä¢ Identity environments are inherently noisy
‚Ä¢ Service accounts behave "weirdly" (multiple IPs, off-hours)
‚Ä¢ MDI needs baseline learning period
‚Ä¢ Legacy protocols generate false positives</code></pre>
        </div>

        <h3>9.5 MDCA (Defender for Cloud Apps) ‚Äî 4‚Äì8 Weeks</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDCA Configuration Phases</span></div>
          <pre><code>PHASE 1 ‚Äî DISCOVERY (Weeks 1-2)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Connect log sources:
   - Microsoft 365
   - Entra ID
   - Firewall / proxy logs (for shadow IT discovery)
‚Ä¢ Enable Cloud Discovery to identify:
   - Sanctioned apps
   - Unsanctioned apps (shadow IT)
   - Risky apps
‚Ä¢ Connect SaaS apps via API:
   - Salesforce
   - Zoom
   - Slack
   - GitHub

PHASE 2 ‚Äî POLICY DESIGN (Weeks 2-5)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Configure policies:
   - Risky app detection
   - OAuth app governance
   - Anomaly detection (mass download, unusual location)
   - File policies (sensitive data in SaaS)
‚Ä¢ Plan session controls (Conditional Access integration)
‚Ä¢ Design DLP integration strategy

PHASE 3 ‚Äî ENFORCEMENT (Weeks 4-8)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ Enable Conditional Access App Control
‚Ä¢ Configure real-time session controls (via reverse proxy)
‚Ä¢ Enable blocking for risky OAuth apps
‚Ä¢ Integrate with Purview DLP

üîπ WHY IT TAKES TIME:
‚Ä¢ Risk tolerance varies per business unit
‚Ä¢ Shadow IT discovery requires stakeholder alignment
‚Ä¢ Blocking too early breaks productivity
‚Ä¢ OAuth governance needs app-by-app review</code></pre>
        </div>

        <h3>9.6 How These Systems Work Together</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">XDR Signal Correlation</span></div>
          <pre><code>XDR CORRELATION ARCHITECTURE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ    MDE      ‚îÇ  ‚îÇ    MDO      ‚îÇ  ‚îÇ    MDI      ‚îÇ  ‚îÇ   MDCA      ‚îÇ
    ‚îÇ  Endpoint   ‚îÇ  ‚îÇ   Email     ‚îÇ  ‚îÇ  Identity   ‚îÇ  ‚îÇ    SaaS     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ                ‚îÇ                ‚îÇ                ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ   M365 DEFENDER XDR  ‚îÇ
                         ‚îÇ   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
                         ‚îÇ   Correlates signals ‚îÇ
                         ‚îÇ   Auto-investigation ‚îÇ
                         ‚îÇ   Unified incidents  ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                                    ‚ñº
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ  MICROSOFT SENTINEL  ‚îÇ
                         ‚îÇ  (Optional)          ‚îÇ
                         ‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
                         ‚îÇ  Network logs        ‚îÇ
                         ‚îÇ  Azure logs          ‚îÇ
                         ‚îÇ  Custom apps         ‚îÇ
                         ‚îÇ  Higher-order rules  ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


EXAMPLE CORRELATION (Why XDR Matters):
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Step 1: MDO detects phishing email ‚Üí user clicks link
           ‚îÇ
Step 2: MDE detects suspicious download on endpoint
           ‚îÇ
Step 3: MDI detects unusual authentication from endpoint
           ‚îÇ
Step 4: MDCA detects risky API calls to Salesforce
           ‚îÇ
           ‚ñº
XDR CORRELATES: Single incident, not 4 separate alerts
              ‚Üí Automated investigation triggered
              ‚Üí Contains compromised account
              ‚Üí SOC sees unified timeline</code></pre>
        </div>

        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Interview Answer: Configuration Timelines</div>
          <div class="callout-content">
            <p><em>"Configuring the Microsoft security stack isn't plug-and-play. Each product ‚Äî MDE, MDO, MDI, MDCA ‚Äî requires phased onboarding:</em></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><em>MDE takes 4-8 weeks because ASR rules need audit mode first, then tuning, then enforcement</em></li>
              <li><em>MDO takes 2-8 weeks because email flows are complex and false positives block business</em></li>
              <li><em>MDI takes 3-6 weeks because it needs a learning period to understand normal identity behavior</em></li>
              <li><em>MDCA takes 4-8 weeks because shadow IT discovery needs stakeholder buy-in before enforcement</em></li>
            </ul>
            <p style="margin-top: 0.5rem;"><em>The value comes when XDR correlates all these signals. A phishing email that leads to endpoint compromise that leads to identity abuse that leads to SaaS exfiltration ‚Äî XDR sees that as one incident, not four separate alerts."</em></p>
          </div>
        </div>

        <h3>9.7 Final Architecture Summary</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Component</th><th>Role</th><th>Setup Time</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>MDE</strong></td><td>Endpoint detection & response</td><td>4-8 weeks</td></tr>
              <tr><td><strong>MDO</strong></td><td>Email & collaboration protection</td><td>2-8 weeks</td></tr>
              <tr><td><strong>MDI</strong></td><td>Identity threat detection</td><td>3-6 weeks</td></tr>
              <tr><td><strong>MDCA</strong></td><td>SaaS visibility & governance</td><td>4-8 weeks</td></tr>
              <tr><td><strong>M365 Defender XDR</strong></td><td>Correlates all signals</td><td>Immediate</td></tr>
              <tr><td><strong>Microsoft Sentinel</strong></td><td>Network + Azure + Custom + Higher-order correlation</td><td>Ongoing</td></tr>
              <tr><td><strong>Unified Portal</strong></td><td>security.microsoft.com ‚Äî single SOC interface</td><td>‚Äî</td></tr>
              <tr><td><strong>Sentinel Rules</strong></td><td>485 (255 migrated + 230 new)</td><td>‚Äî</td></tr>
              <tr><td><strong>Total Timeline</strong></td><td>End-to-end security stack deployment</td><td>12 months</td></tr>
            </tbody>
          </table>
        </div>

        <nav class="page-nav">
          <a href="integration.html" class="page-nav-link prev">
            <span class="page-nav-label">Previous</span>
            <span class="page-nav-title">‚Üê Platform Integration</span>
          </a>
          <a href="../troubleshooting/index.html" class="page-nav-link next">
            <span class="page-nav-label">Next</span>
            <span class="page-nav-title">Troubleshooting ‚Üí</span>
          </a>
        </nav>

      </div>
    </main>
  </div>

  <script src="../js/main.js"></script>
</body>
</html>
