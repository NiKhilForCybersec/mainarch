<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detection Rule Anatomy â€” Why One Threat = Many Rules | SIEM Migration</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .attack-chain { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 1rem 0; }
    .chain-step { padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem; }
    .chain-step.recon { background: rgba(107, 114, 128, 0.2); border: 1px solid rgba(107, 114, 128, 0.4); }
    .chain-step.initial { background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.4); }
    .chain-step.execution { background: rgba(249, 115, 22, 0.2); border: 1px solid rgba(249, 115, 22, 0.4); }
    .chain-step.persistence { background: rgba(234, 179, 8, 0.2); border: 1px solid rgba(234, 179, 8, 0.4); }
    .chain-step.privesc { background: rgba(132, 204, 22, 0.2); border: 1px solid rgba(132, 204, 22, 0.4); }
    .chain-step.defense { background: rgba(34, 197, 94, 0.2); border: 1px solid rgba(34, 197, 94, 0.4); }
    .chain-step.credential { background: rgba(6, 182, 212, 0.2); border: 1px solid rgba(6, 182, 212, 0.4); }
    .chain-step.discovery { background: rgba(59, 130, 246, 0.2); border: 1px solid rgba(59, 130, 246, 0.4); }
    .chain-step.lateral { background: rgba(139, 92, 246, 0.2); border: 1px solid rgba(139, 92, 246, 0.4); }
    .chain-step.collection { background: rgba(168, 85, 247, 0.2); border: 1px solid rgba(168, 85, 247, 0.4); }
    .chain-step.exfil { background: rgba(236, 72, 153, 0.2); border: 1px solid rgba(236, 72, 153, 0.4); }
    .chain-step.impact { background: rgba(239, 68, 68, 0.3); border: 2px solid rgba(239, 68, 68, 0.6); font-weight: 600; }
    .rule-card { background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: 8px; padding: 1.25rem; margin: 1rem 0; }
    .rule-card h4 { margin: 0 0 0.5rem 0; color: #3b82f6; }
    .rule-meta { display: flex; gap: 1rem; margin-bottom: 0.75rem; flex-wrap: wrap; }
    .rule-meta span { font-size: 0.8rem; padding: 2px 8px; border-radius: 4px; }
    .meta-mitre { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
    .meta-tactic { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }
    .meta-severity { background: rgba(234, 179, 8, 0.2); color: #fde047; }
    .meta-xdr { background: rgba(34, 197, 94, 0.2); color: #86efac; }
    .pyramid { margin: 1.5rem 0; }
    .pyramid-level { padding: 1rem; margin: 0.25rem 0; border-radius: 4px; }
    .pyramid-level.ttps { background: rgba(239, 68, 68, 0.15); border-left: 4px solid #ef4444; }
    .pyramid-level.tools { background: rgba(249, 115, 22, 0.15); border-left: 4px solid #f97316; }
    .pyramid-level.artifacts { background: rgba(234, 179, 8, 0.15); border-left: 4px solid #eab308; }
    .pyramid-level.iocs { background: rgba(34, 197, 94, 0.15); border-left: 4px solid #22c55e; }
    .detection-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin: 1rem 0; }
    .detection-count { text-align: center; padding: 1rem; border-radius: 8px; background: var(--bg-secondary); border: 1px solid var(--border-primary); }
    .detection-count .number { font-size: 2rem; font-weight: 700; color: #3b82f6; }
    .detection-count .label { font-size: 0.85rem; color: var(--text-secondary); }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
          <a href="../controls-mapping.html" class="nav-item">Controls Mapping</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/parsing-deep-dive.html" class="nav-item">Parsing Deep Dive</a>
          <a href="../siem/threat-intelligence.html" class="nav-item">Threat Intelligence</a>
          <a href="../siem/detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="../siem/detection-anatomy.html" class="nav-item">Detection Anatomy</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soar-automation.html" class="nav-item">SOAR &amp; Automation</a>
          <a href="../siem/workbooks.html" class="nav-item">Workbooks &amp; Dashboards</a>
          <a href="../siem/cost-optimization.html" class="nav-item">Cost Optimization</a>
          <a href="../siem/casb-saas-security.html" class="nav-item">CASB &amp; SaaS Security</a>
          <a href="../siem/soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/xdr-detection-model.html" class="nav-item">XDR Detection Model</a>
          <a href="../edr/advanced-hunting.html" class="nav-item">Advanced Hunting</a>
          <a href="../edr/live-response.html" class="nav-item">Live Response</a>
          <a href="../edr/tvm.html" class="nav-item">Vulnerability Management</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/device-control.html" class="nav-item">Device Control</a>
          <a href="../edr/compensating-controls.html" class="nav-item">Compensating Controls</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/dlp-catalog.html" class="nav-item">DLP Catalog</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/infrastructure-reference.html" class="nav-item">Infrastructure Reference</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
          <a href="../resources/alternative-architectures.html" class="nav-item">Alternative Architectures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep (Full)</a>
          <a href="../interview-prep-v2.html" class="nav-item">Interview Prep v2</a>
          <a href="../interview-technical-reference.html" class="nav-item">Technical Reference</a>
          <a href="../interview-frameworks.html" class="nav-item">Mental Frameworks</a>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      <div class="content-wrapper">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Detection Anatomy</span>
        </nav>

        <div class="page-header">
          <h1>Detection Rule Anatomy â€” Why One Threat = Many Rules</h1>
          <div class="page-header-meta">
            <span class="page-badge siem">SIEM Track</span>
            <span class="page-reading-time">Deep Dive</span>
          </div>
          <p class="intro-text">This page explains why "23 ransomware detection rules" makes sense, how threats decompose into multiple detection opportunities, and the relationship between MITRE ATT&CK, attack chains, and detection engineering.</p>
        </div>

        <!-- ==================== SECTION 1: THE CORE QUESTION ==================== -->
        <h2>1. The Core Question</h2>

        <div class="callout critical">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Why Would Ransomware Have 23 Detection Rules?</div>
          <div class="callout-content">
            <p><strong>Naive thinking:</strong> "Ransomware = encryption. One rule to detect encryption. Done."</p>
            <p><strong>Reality:</strong> Ransomware is not a single event â€” it's the <em>final stage</em> of a multi-step attack chain. If you only detect encryption, you've already lost.</p>
          </div>
        </div>

        <p>The goal of detection engineering is to catch attackers at <strong>every stage</strong> of their attack, not just the payload detonation. This is why one "threat" becomes many detection rules.</p>

        <!-- ==================== SECTION 2: THE PYRAMID OF PAIN ==================== -->
        <h2>2. The Pyramid of Pain â€” Detection Philosophy</h2>

        <p>David Bianco's "Pyramid of Pain" explains why we need different types of detections:</p>

        <div class="pyramid">
          <div class="pyramid-level ttps">
            <strong>TTPs (Tactics, Techniques, Procedures)</strong> â€” Hardest for attackers to change
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Behavioral patterns: "Process A spawning Process B" / "Credential dump from LSASS"</p>
            <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--text-secondary);">Example: Detecting any process reading LSASS memory, regardless of tool used</p>
          </div>
          <div class="pyramid-level tools">
            <strong>Tools</strong> â€” Attackers can switch tools, but it takes effort
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Known attack tools: Mimikatz, Cobalt Strike, PsExec</p>
            <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--text-secondary);">Example: Detecting Mimikatz.exe by name or known command-line patterns</p>
          </div>
          <div class="pyramid-level artifacts">
            <strong>Network/Host Artifacts</strong> â€” Moderate pain to change
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Registry keys, file paths, named pipes, user agents</p>
            <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--text-secondary);">Example: Detecting specific registry run key used by malware family</p>
          </div>
          <div class="pyramid-level iocs">
            <strong>IOCs (Hash, IP, Domain)</strong> â€” Easy for attackers to change
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Specific file hashes, C2 IPs, malicious domains</p>
            <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--text-secondary);">Example: Blocking SHA256 hash of known ransomware binary</p>
          </div>
        </div>

        <div class="callout info">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Detection Strategy</div>
          <div class="callout-content">
            <p>Good detection programs layer across ALL levels. IOC-based rules catch known threats. TTP-based rules catch unknown/novel threats using the same behaviors.</p>
            <p>This is why one threat = many rules â€” you need rules at each pyramid level.</p>
          </div>
        </div>

        <!-- ==================== SECTION 3: ATTACK CHAIN BREAKDOWN ==================== -->
        <h2>3. Ransomware Attack Chain â€” Why 23+ Detection Points</h2>

        <p>A ransomware attack is NOT a single event. It follows an attack chain with multiple stages, each providing detection opportunities:</p>

        <div class="attack-chain">
          <div class="chain-step initial">ğŸ“§ Initial Access</div>
          <div class="chain-step execution">âš¡ Execution</div>
          <div class="chain-step persistence">ğŸ”„ Persistence</div>
          <div class="chain-step privesc">â¬†ï¸ Privilege Escalation</div>
          <div class="chain-step defense">ğŸ›¡ï¸ Defense Evasion</div>
          <div class="chain-step credential">ğŸ”‘ Credential Access</div>
          <div class="chain-step discovery">ğŸ” Discovery</div>
          <div class="chain-step lateral">â†”ï¸ Lateral Movement</div>
          <div class="chain-step collection">ğŸ“¦ Collection</div>
          <div class="chain-step exfil">ğŸ“¤ Exfiltration</div>
          <div class="chain-step impact">ğŸ’¥ Impact (Encryption)</div>
        </div>

        <p><strong>Each stage has multiple techniques. Each technique can have multiple detection rules.</strong> Let's break down ransomware:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Attack Stage</th><th>MITRE Tactic</th><th>What Happens</th><th>Detection Rules</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Initial Access</strong></td>
                <td>TA0001</td>
                <td>Phishing email with malicious attachment/link</td>
                <td>2-3 rules (MDO handles)</td>
              </tr>
              <tr>
                <td><strong>Execution</strong></td>
                <td>TA0002</td>
                <td>Macro executes PowerShell, downloads payload</td>
                <td>4-5 rules</td>
              </tr>
              <tr>
                <td><strong>Persistence</strong></td>
                <td>TA0003</td>
                <td>Scheduled task, registry run key, service</td>
                <td>3-4 rules</td>
              </tr>
              <tr>
                <td><strong>Privilege Escalation</strong></td>
                <td>TA0004</td>
                <td>UAC bypass, exploit, token manipulation</td>
                <td>2-3 rules</td>
              </tr>
              <tr>
                <td><strong>Defense Evasion</strong></td>
                <td>TA0005</td>
                <td>Disable AV, clear logs, process injection</td>
                <td>3-4 rules</td>
              </tr>
              <tr>
                <td><strong>Credential Access</strong></td>
                <td>TA0006</td>
                <td>Dump LSASS, extract cached credentials</td>
                <td>3-4 rules</td>
              </tr>
              <tr>
                <td><strong>Discovery</strong></td>
                <td>TA0007</td>
                <td>Network scan, AD enumeration, file discovery</td>
                <td>2-3 rules</td>
              </tr>
              <tr>
                <td><strong>Lateral Movement</strong></td>
                <td>TA0008</td>
                <td>RDP, SMB, WMI, PsExec to other hosts</td>
                <td>3-4 rules</td>
              </tr>
              <tr>
                <td><strong>Exfiltration</strong></td>
                <td>TA0010</td>
                <td>Copy sensitive data before encryption (double extortion)</td>
                <td>2-3 rules</td>
              </tr>
              <tr>
                <td><strong>Impact</strong></td>
                <td>TA0040</td>
                <td>Encrypt files, delete shadow copies, ransom note</td>
                <td>3-4 rules</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>This Is Why 23 Rules Makes Sense</div>
          <div class="callout-content">
            <p><strong>23 rules = coverage across the entire attack chain</strong>, not 23 ways to detect encryption.</p>
            <p>If you only detect at "Impact", you detect ransomware <em>after</em> files are encrypted. If you detect at "Credential Access" or "Lateral Movement", you catch the attack <em>before</em> encryption begins.</p>
          </div>
        </div>

        <!-- ==================== SECTION 4: MITRE ATT&CK STRUCTURE ==================== -->
        <h2>4. MITRE ATT&CK â€” How Techniques Multiply Rules</h2>

        <p>MITRE ATT&CK provides the taxonomy. Understanding its structure explains why detection counts grow:</p>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MITRE ATT&CK Hierarchy</span></div>
          <pre><code>TACTIC (The "Why" â€” Attacker's Goal)
    â””â”€â”€ TECHNIQUE (The "How" â€” Method to achieve goal)
            â””â”€â”€ SUB-TECHNIQUE (Specific variant of technique)
                    â””â”€â”€ PROCEDURE (Real-world implementation by specific group)

EXAMPLE: Credential Access Tactic
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
T1003 - OS Credential Dumping (Technique)
    â”œâ”€â”€ T1003.001 - LSASS Memory (Sub-technique)
    â”‚       â”œâ”€â”€ Mimikatz sekurlsa::logonpasswords (Procedure)
    â”‚       â”œâ”€â”€ ProcDump LSASS dump (Procedure)
    â”‚       â”œâ”€â”€ comsvcs.dll MiniDump (Procedure)
    â”‚       â””â”€â”€ Task Manager LSASS dump (Procedure)
    â”œâ”€â”€ T1003.002 - Security Account Manager (Sub-technique)
    â”‚       â”œâ”€â”€ reg.exe save HKLM\SAM (Procedure)
    â”‚       â””â”€â”€ Volume Shadow Copy SAM extraction (Procedure)
    â”œâ”€â”€ T1003.003 - NTDS.dit (Sub-technique)
    â”‚       â”œâ”€â”€ ntdsutil.exe snapshot (Procedure)
    â”‚       â””â”€â”€ Volume Shadow Copy NTDS extraction (Procedure)
    â”œâ”€â”€ T1003.004 - LSA Secrets (Sub-technique)
    â”œâ”€â”€ T1003.005 - Cached Domain Credentials (Sub-technique)
    â”œâ”€â”€ T1003.006 - DCSync (Sub-technique)
    â”‚       â”œâ”€â”€ Mimikatz lsadump::dcsync (Procedure)
    â”‚       â””â”€â”€ Impacket secretsdump.py (Procedure)
    â”œâ”€â”€ T1003.007 - Proc Filesystem (Linux) (Sub-technique)
    â””â”€â”€ T1003.008 - /etc/passwd and /etc/shadow (Sub-technique)

ONE TECHNIQUE (T1003) â†’ 8 SUB-TECHNIQUES â†’ Multiple procedures each
Each may need its own detection rule!</code></pre>
        </div>

        <div class="callout warning">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>Why Not One Rule for T1003?</div>
          <div class="callout-content">
            <p>You could write ONE rule: "Alert on any T1003 activity."</p>
            <p><strong>Problem:</strong> Each sub-technique has different indicators:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li>T1003.001 (LSASS) â€” Look for LSASS memory access</li>
              <li>T1003.002 (SAM) â€” Look for reg.exe accessing SAM hive</li>
              <li>T1003.006 (DCSync) â€” Look for DRS replication requests to non-DC</li>
            </ul>
            <p>Different artifacts, different data sources, different detection logic = different rules.</p>
          </div>
        </div>

        <!-- ==================== SECTION 5: EXAMPLE RULES WITH KQL ==================== -->
        <h2>5. Real Detection Rules â€” Endpoint Examples</h2>

        <p>Let's look at actual detection rules for different attack stages. These demonstrate why multiple rules are needed.</p>

        <!-- Rule 1: LSASS Memory Access -->
        <div class="rule-card">
          <h4>Rule 1: LSASS Memory Access (Credential Theft)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1003.001</span>
            <span class="meta-tactic">Credential Access</span>
            <span class="meta-severity">High</span>
            <span class="meta-xdr">MDE Native</span>
          </div>
          <p><strong>What it detects:</strong> Any process attempting to read LSASS memory (where credentials are stored)</p>
          <p><strong>Why it's separate:</strong> This is THE most common credential theft technique. Needs dedicated, high-fidelity rule.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” LSASS Memory Access Detection</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// MDE Advanced Hunting - LSASS Memory Access
DeviceEvents
| where ActionType == "OpenProcessApiCall"
| where FileName == "lsass.exe"
| where InitiatingProcessFileName !in ("taskmgr.exe", "procexp64.exe", "MsMpEng.exe")
| where InitiatingProcessCommandLine !contains "MicrosoftDefender"
| project TimeGenerated, DeviceName, InitiatingProcessFileName, 
          InitiatingProcessCommandLine, InitiatingProcessAccountName
| summarize AttemptCount = count() by DeviceName, InitiatingProcessFileName

// Why this rule exists:
// - Mimikatz reads LSASS to extract passwords
// - ProcDump can dump LSASS memory
// - comsvcs.dll MiniDump abuses legitimate DLL
// All trigger this rule regardless of specific tool</code></pre>
          </div>
        </div>

        <!-- Rule 2: Shadow Copy Deletion -->
        <div class="rule-card">
          <h4>Rule 2: Shadow Copy Deletion (Ransomware Pre-Encryption)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1490</span>
            <span class="meta-tactic">Impact</span>
            <span class="meta-severity">Critical</span>
            <span class="meta-xdr">MDE Native</span>
          </div>
          <p><strong>What it detects:</strong> Deletion of Volume Shadow Copies (prevents file recovery)</p>
          <p><strong>Why it's separate:</strong> This happens RIGHT BEFORE encryption. Last chance to stop ransomware.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Shadow Copy Deletion</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// MDE Advanced Hunting - Shadow Copy Deletion
DeviceProcessEvents
| where ProcessCommandLine has_any (
    "vssadmin delete shadows",
    "vssadmin.exe delete shadows",
    "wmic shadowcopy delete",
    "Get-WmiObject Win32_ShadowCopy | Remove-WmiObject",
    "bcdedit /set {default} recoveryenabled no"
)
| project TimeGenerated, DeviceName, InitiatingProcessFileName,
          ProcessCommandLine, InitiatingProcessAccountName
| extend AlertTitle = "Shadow Copy Deletion - Potential Ransomware"

// Why this rule exists:
// - Ransomware deletes shadow copies to prevent recovery
// - This happens BEFORE encryption starts
// - Different from encryption detection - catches attack earlier</code></pre>
          </div>
        </div>

        <!-- Rule 3: Encoded PowerShell -->
        <div class="rule-card">
          <h4>Rule 3: Encoded PowerShell Execution (Execution Stage)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1059.001</span>
            <span class="meta-tactic">Execution</span>
            <span class="meta-severity">Medium</span>
            <span class="meta-xdr">MDE Native</span>
          </div>
          <p><strong>What it detects:</strong> PowerShell running with Base64-encoded commands (obfuscation)</p>
          <p><strong>Why it's separate:</strong> Encoded commands are rarely legitimate. Catches payload download/execution.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Encoded PowerShell</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// MDE Advanced Hunting - Encoded PowerShell
DeviceProcessEvents
| where FileName in~ ("powershell.exe", "pwsh.exe")
| where ProcessCommandLine has_any ("-enc", "-encoded", "-e ", "-ec ")
| where ProcessCommandLine !contains "SplunkUniversalForwarder"  // Exclude known good
| project TimeGenerated, DeviceName, ProcessCommandLine,
          InitiatingProcessFileName, InitiatingProcessCommandLine
| extend DecodedCommand = base64_decode_tostring(
    extract(@"-[eE][nN]?[cC]?\s+([A-Za-z0-9+/=]+)", 1, ProcessCommandLine))

// Why this rule exists:
// - Malware commonly uses -EncodedCommand to hide payloads
// - Legitimate admin scripts rarely use encoding
// - Catches malware downloaders, stagers, implants</code></pre>
          </div>
        </div>

        <!-- Rule 4: Remote Service Creation -->
        <div class="rule-card">
          <h4>Rule 4: Remote Service Creation (Lateral Movement)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1021.002</span>
            <span class="meta-tactic">Lateral Movement</span>
            <span class="meta-severity">High</span>
            <span class="meta-xdr">MDE + MDI</span>
          </div>
          <p><strong>What it detects:</strong> Creating Windows services on remote machines (PsExec-style)</p>
          <p><strong>Why it's separate:</strong> Classic lateral movement technique. Different from RDP or WMI lateral movement.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Remote Service Creation</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// MDE Advanced Hunting - Remote Service Installation
DeviceEvents
| where ActionType == "ServiceInstalled"
| where InitiatingProcessFileName in~ ("services.exe")
| where InitiatingProcessCommandLine has "psexec" 
    or AdditionalFields has "RemoteHost"
| project TimeGenerated, DeviceName, 
          ServiceName = tostring(parse_json(AdditionalFields).ServiceName),
          InitiatingProcessAccountName, RemoteIP
| join kind=inner (
    DeviceNetworkEvents
    | where RemotePort == 445
    | summarize by DeviceName, RemoteIP
) on DeviceName

// Why this rule exists:
// - PsExec creates services remotely to execute code
// - Ransomware uses this for network-wide encryption
// - Different technique than WMI or RDP lateral movement</code></pre>
          </div>
        </div>

        <!-- Rule 5: Mass File Encryption -->
        <div class="rule-card">
          <h4>Rule 5: Mass File Encryption Behavior (Impact)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1486</span>
            <span class="meta-tactic">Impact</span>
            <span class="meta-severity">Critical</span>
            <span class="meta-xdr">MDE Native</span>
          </div>
          <p><strong>What it detects:</strong> High volume of file modifications in short time (encryption behavior)</p>
          <p><strong>Why it's separate:</strong> Behavioral detection of encryption itself. Last-resort detection.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Mass File Modification</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// MDE Advanced Hunting - Mass File Encryption Behavior
DeviceFileEvents
| where ActionType in ("FileModified", "FileCreated")
| where Timestamp > ago(5m)
| summarize 
    FileCount = count(),
    UniqueExtensions = dcount(extract(@"\.([^.]+)$", 1, FileName)),
    Folders = dcount(FolderPath)
    by DeviceName, InitiatingProcessFileName, bin(Timestamp, 1m)
| where FileCount > 500 and UniqueExtensions < 3
// 500+ files modified in 1 minute with few extension types = encryption
| project Timestamp, DeviceName, InitiatingProcessFileName, FileCount

// Why this rule exists:
// - Ransomware encrypts thousands of files quickly
// - Normal activity doesn't modify 500+ files per minute
// - Catches encryption WHILE it's happening (last resort)</code></pre>
          </div>
        </div>

        <!-- ==================== SECTION 6: IDENTITY DETECTION EXAMPLES ==================== -->
        <h2>6. Real Detection Rules â€” Identity Examples</h2>

        <p>Identity attacks also decompose into multiple detection rules. Here's how "credential attacks" becomes many rules:</p>

        <!-- Rule 6: Kerberoasting -->
        <div class="rule-card">
          <h4>Rule 6: Kerberoasting (Service Ticket Request Anomaly)</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1558.003</span>
            <span class="meta-tactic">Credential Access</span>
            <span class="meta-severity">High</span>
            <span class="meta-xdr">MDI Native</span>
          </div>
          <p><strong>What it detects:</strong> User requesting many service tickets (TGS) for offline cracking</p>
          <p><strong>Why it's separate:</strong> Different attack pattern than password spray or Pass-the-Hash.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Kerberoasting Detection</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// Sentinel - Kerberoasting Detection (from SecurityEvent)
SecurityEvent
| where EventID == 4769  // Kerberos Service Ticket Request
| where TicketEncryptionType in ("0x17", "0x18")  // RC4 encryption (weak)
| where ServiceName !endswith "$"  // Exclude machine accounts
| summarize 
    TicketCount = count(),
    UniqueServices = dcount(ServiceName),
    Services = make_set(ServiceName, 10)
    by Account, IpAddress, bin(TimeGenerated, 1h)
| where TicketCount > 10 and UniqueServices > 5
// Many service tickets from one user = likely Kerberoasting

// Why this rule exists:
// - Kerberoasting requests TGS tickets for services with SPNs
// - Tickets can be cracked offline to reveal service account passwords
// - Different from Golden Ticket, Silver Ticket, AS-REP Roasting</code></pre>
          </div>
        </div>

        <!-- Rule 7: Password Spray -->
        <div class="rule-card">
          <h4>Rule 7: Password Spray Attack</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1110.003</span>
            <span class="meta-tactic">Credential Access</span>
            <span class="meta-severity">High</span>
            <span class="meta-xdr">Entra ID Protection</span>
          </div>
          <p><strong>What it detects:</strong> Same password tried against many accounts (avoids lockout)</p>
          <p><strong>Why it's separate:</strong> Different pattern than brute force (many passwords vs one account).</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Password Spray Detection</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// Sentinel - Password Spray Detection
SigninLogs
| where ResultType == "50126"  // Invalid username or password
| where TimeGenerated > ago(1h)
| summarize 
    FailedAccounts = dcount(UserPrincipalName),
    AccountList = make_set(UserPrincipalName, 20),
    AttemptCount = count()
    by IPAddress, bin(TimeGenerated, 10m)
| where FailedAccounts > 10 and AttemptCount < FailedAccounts * 3
// Many accounts, few attempts per account = password spray
| extend AttackType = "Password Spray"

// Why this rule exists:
// - Password spray uses 1-2 passwords across many accounts
// - Stays under lockout threshold per account
// - Different from brute force (many passwords, one account)</code></pre>
          </div>
        </div>

        <!-- Rule 8: Impossible Travel -->
        <div class="rule-card">
          <h4>Rule 8: Impossible Travel</h4>
          <div class="rule-meta">
            <span class="meta-mitre">T1078</span>
            <span class="meta-tactic">Initial Access / Persistence</span>
            <span class="meta-severity">Medium</span>
            <span class="meta-xdr">Entra ID Protection</span>
          </div>
          <p><strong>What it detects:</strong> Same user logging in from geographically distant locations</p>
          <p><strong>Why it's separate:</strong> Indicates stolen credentials used by attacker in different location.</p>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">KQL â€” Impossible Travel</span><button class="code-copy-btn">Copy</button></div>
            <pre><code>// Sentinel - Impossible Travel Detection
let TimeWindow = 2h;
SigninLogs
| where ResultType == 0  // Successful logins only
| where TimeGenerated > ago(1d)
| extend City = tostring(LocationDetails.city), 
         Country = tostring(LocationDetails.countryOrRegion),
         Lat = toreal(LocationDetails.geoCoordinates.latitude),
         Long = toreal(LocationDetails.geoCoordinates.longitude)
| order by UserPrincipalName, TimeGenerated
| serialize
| extend PrevCity = prev(City), PrevLat = prev(Lat), PrevLong = prev(Long),
         PrevTime = prev(TimeGenerated), PrevUser = prev(UserPrincipalName)
| where UserPrincipalName == PrevUser
| extend TimeDiffHours = datetime_diff('hour', TimeGenerated, PrevTime)
| extend DistanceKm = geo_distance_2points(Long, Lat, PrevLong, PrevLat) / 1000
| extend RequiredSpeedKmh = DistanceKm / TimeDiffHours
| where RequiredSpeedKmh > 800  // Faster than commercial flight
| project TimeGenerated, UserPrincipalName, City, PrevCity, 
          TimeDiffHours, DistanceKm, RequiredSpeedKmh

// Why this rule exists:
// - User can't be in Toronto and Tokyo within 2 hours
// - Indicates credential compromise
// - Different from VPN/proxy detection or single location anomaly</code></pre>
          </div>
        </div>

        <!-- ==================== SECTION 7: RULE COUNT BY DOMAIN ==================== -->
        <h2>7. Detection Rule Counts â€” How Numbers Add Up</h2>

        <p>Now you can see why each domain has many rules. Here's the breakdown:</p>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Endpoint Detection Rule Breakdown (187 Rules â†’ XDR)</span></div>
          <pre><code>ENDPOINT BEHAVIOR â€” 187 DETECTION RULES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RANSOMWARE / ENCRYPTION (23 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Shadow copy deletion (vssadmin, wmic, PowerShell)           3 rules
â€¢ Recovery disable (bcdedit)                                   1 rule
â€¢ Mass file modification behavior                              2 rules
â€¢ Known ransomware file extensions                             1 rule
â€¢ Ransomware note creation                                     1 rule
â€¢ Encryption API abuse                                         2 rules
â€¢ Pre-encryption staging (file enumeration)                    2 rules
â€¢ Network share enumeration (pre-encryption recon)             2 rules
â€¢ Scheduled task for timed detonation                          2 rules
â€¢ Service-based ransomware execution                           2 rules
â€¢ WMI-based ransomware deployment                              2 rules
â€¢ Boot record modification (MBR ransomware)                    1 rule
â€¢ Safe mode boot manipulation                                  2 rules

CREDENTIAL THEFT (31 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ LSASS memory access (various methods)                        5 rules
â€¢ SAM database access                                          3 rules
â€¢ NTDS.dit extraction                                          3 rules
â€¢ DCSync detection                                             2 rules
â€¢ Credential file access (browser, RDP)                        4 rules
â€¢ Mimikatz command patterns                                    3 rules
â€¢ ProcDump LSASS dump                                          1 rule
â€¢ comsvcs.dll MiniDump abuse                                   1 rule
â€¢ Credential Manager access                                    2 rules
â€¢ Registry credential extraction                               2 rules
â€¢ Token impersonation                                          2 rules
â€¢ Kerberos ticket extraction                                   3 rules

PERSISTENCE (28 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Registry Run keys (multiple locations)                       4 rules
â€¢ Scheduled tasks                                              3 rules
â€¢ Windows services                                             3 rules
â€¢ Startup folder                                               2 rules
â€¢ WMI subscriptions                                            2 rules
â€¢ DLL search order hijacking                                   2 rules
â€¢ COM object hijacking                                         2 rules
â€¢ Boot/Logon scripts                                           2 rules
â€¢ Office persistence (templates, add-ins)                      3 rules
â€¢ Browser extensions                                           2 rules
â€¢ Authentication package abuse                                 1 rule
â€¢ Security Support Provider                                    1 rule
â€¢ AppInit DLLs                                                 1 rule

... (continues for other categories)

TOTAL: 187 endpoint detection rules
ALL HANDLED BY MDE NATIVELY â€” retired from SIEM migration</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Identity Attack Rule Breakdown (89 Rules â†’ XDR)</span></div>
          <pre><code>IDENTITY ATTACKS â€” 89 DETECTION RULES  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KERBEROS ATTACKS (18 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Kerberoasting (TGS request anomaly)                          3 rules
â€¢ AS-REP Roasting (pre-auth disabled abuse)                    2 rules
â€¢ Golden Ticket (forged TGT)                                   2 rules
â€¢ Silver Ticket (forged TGS)                                   2 rules
â€¢ Pass-the-Ticket                                              2 rules
â€¢ Kerberos delegation abuse                                    3 rules
â€¢ SPN manipulation                                             2 rules
â€¢ Skeleton Key                                                 2 rules

CREDENTIAL ATTACKS (14 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Pass-the-Hash                                                3 rules
â€¢ Pass-the-Certificate                                         2 rules
â€¢ NTLM relay                                                   3 rules
â€¢ Credential stuffing                                          2 rules
â€¢ Overpass-the-Hash                                            2 rules
â€¢ LDAP credential exposure                                     2 rules

BRUTE FORCE / PASSWORD ATTACKS (12 rules)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Password spray                                               2 rules
â€¢ Brute force (single account)                                 2 rules
â€¢ Distributed brute force                                      2 rules
â€¢ Legacy authentication abuse                                  2 rules
â€¢ Failed MFA attempts                                          2 rules
â€¢ Smart lockout bypass attempts                                2 rules

... (continues)

TOTAL: 89 identity detection rules
HANDLED BY MDI + ENTRA ID PROTECTION â€” retired from SIEM migration</code></pre>
        </div>

        <!-- ==================== SECTION 8: INTERVIEW ANSWERS ==================== -->
        <h2>8. Interview-Ready Answers</h2>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "Why do you have 23 rules just for ransomware?"</span></div>
          <pre><code>"Because ransomware isn't a single event â€” it's the final stage of a 
multi-phase attack. If I only detect encryption, I've already lost.

The 23 rules cover the entire attack chain:
â€¢ Pre-encryption reconnaissance (network share enumeration)
â€¢ Defense evasion (disabling AV, clearing logs)
â€¢ Recovery prevention (shadow copy deletion)
â€¢ Credential theft (for lateral movement)
â€¢ Staging behavior (scheduling detonation)
â€¢ The encryption itself (mass file modification)

Each technique has different indicators and different detection logic.
Shadow copy deletion uses vssadmin or wmic â€” that's a specific command 
pattern. Mass file encryption is behavioral â€” thousands of file 
modifications per minute. They require separate rules.

The goal is defense in depth. If shadow copy deletion fails to alert,
maybe the network share enumeration caught it earlier. If that missed,
maybe the credential theft detection caught it. 23 rules means 23 
chances to stop the attack before encryption."</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "How do you decide when to create a new rule vs. modify existing?"</span></div>
          <pre><code>"It depends on whether the detection logic is fundamentally different.

SAME RULE: Slight variations of the same indicator
â€¢ Mimikatz via command line vs Mimikatz loaded as DLL
â€¢ Same detection: process accessing LSASS memory

DIFFERENT RULES: Different indicators entirely
â€¢ LSASS memory dump (process memory access)
â€¢ SAM database extraction (registry access)
â€¢ DCSync (DRSUAPI network calls)
All achieve credential theft, but require completely different 
detection logic â€” different data sources, different artifacts.

I also create separate rules for alert fidelity. A rule detecting 
'any LSASS access' would alert on legitimate tools. Separate rules 
for 'unknown process accessing LSASS' vs 'known attack tool pattern' 
give SOC analysts different confidence levels."</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "How do you use MITRE ATT&CK for detection engineering?"</span></div>
          <pre><code>"MITRE ATT&CK is the taxonomy, not the detection logic.

I use it three ways:

1. COVERAGE MAPPING
   Map existing detections to MITRE techniques. Identify gaps.
   'We have no detection for T1003.006 DCSync' â†’ build one.

2. RULE NAMING / ORGANIZATION
   Every rule maps to at least one technique. This makes 
   reporting meaningful. 'We detected 47 T1059 Execution attempts
   this month' is actionable.

3. UNDERSTANDING ATTACK CHAINS
   MITRE shows which techniques appear together. Ransomware 
   groups use specific TTPs. If I see T1003 (Credential Dumping)
   followed by T1021 (Remote Services), I know lateral movement
   is happening â€” prioritize response.

But MITRE doesn't tell me HOW to detect. That's detection engineering.
T1003.001 says 'adversaries may dump LSASS.' My job is writing KQL 
that catches that reliably without flooding SOC with false positives."</code></pre>
        </div>

        <!-- ==================== SECTION 9: VISUALIZATION ==================== -->
        <h2>9. Visual Summary â€” One Threat, Many Detections</h2>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">How "Ransomware" Becomes 23 Detection Rules</span></div>
          <pre><code>                              "RANSOMWARE"
                                   â”‚
                                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚           MITRE ATT&CK MAPPING           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼             â–¼             â–¼             â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ TA0002  â”‚  â”‚ TA0003  â”‚  â”‚ TA0006  â”‚  â”‚ TA0008  â”‚  â”‚ TA0040  â”‚
    â”‚Executionâ”‚  â”‚Persist. â”‚  â”‚Cred.Acc.â”‚  â”‚ Lateral â”‚  â”‚ Impact  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚            â”‚            â”‚            â”‚            â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚T1059.001â”‚  â”‚ T1053   â”‚  â”‚ T1003   â”‚  â”‚ T1021   â”‚  â”‚ T1486   â”‚
    â”‚PowerShelâ”‚  â”‚Sched.Tskâ”‚  â”‚Cred.Dumpâ”‚  â”‚Rem.Serv.â”‚  â”‚DataEncr.â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚            â”‚            â”‚            â”‚            â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ 4 rules â”‚  â”‚ 3 rules â”‚  â”‚ 5 rules â”‚  â”‚ 4 rules â”‚  â”‚ 4 rules â”‚
    â”‚-Encoded â”‚  â”‚-At.exe  â”‚  â”‚-LSASS   â”‚  â”‚-PsExec  â”‚  â”‚-MassMod â”‚
    â”‚-Downloadâ”‚  â”‚-schtasksâ”‚  â”‚-SAM     â”‚  â”‚-WMI     â”‚  â”‚-Shadow  â”‚
    â”‚-IEX     â”‚  â”‚-WMI     â”‚  â”‚-NTDS    â”‚  â”‚-RDP     â”‚  â”‚-BCDEdit â”‚
    â”‚-Bypass  â”‚  â”‚         â”‚  â”‚-DCSync  â”‚  â”‚-SMB     â”‚  â”‚-RNote   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚            â”‚            â”‚            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    23 DETECTION RULES    â”‚
                    â”‚  Covering full attack    â”‚
                    â”‚  chain, not just payload â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
        </div>

        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Key Takeaway</div>
          <div class="callout-content">
            <p><strong>Detection engineering is about catching attackers at every stage.</strong></p>
            <p>23 ransomware rules means 23 opportunities to stop an attack â€” from initial PowerShell download to shadow copy deletion to file encryption. MITRE ATT&CK provides the taxonomy; you provide the detection logic.</p>
          </div>
        </div>

        <nav class="page-nav">
          <a href="detection-engineering.html" class="page-nav-link prev"><span class="page-nav-label">Previous</span><span class="page-nav-title">â† Detection Engineering</span></a>
          <a href="detection-catalog.html" class="page-nav-link next"><span class="page-nav-label">Next</span><span class="page-nav-title">Detection Catalog â†’</span></a>
        </nav>
      </div>
    </main>
  </div>
  <script src="../js/main.js"></script>
</body>
</html>
