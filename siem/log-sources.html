<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Log Source Strategy | SIEM Migration</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <div class="layout">
        <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="index.html" class="nav-item">SIEM Overview</a>
          <a href="discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="log-sources.html" class="nav-item active">Log Source Strategy</a>
          <a href="log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/dlp-catalog.html" class="nav-item">DLP Catalog</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/infrastructure-reference.html" class="nav-item">Infrastructure Reference</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep</a>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      <div class="content-wrapper">

        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Log Source Strategy</span>
        </nav>

        <div class="page-header">
          <h1>Log Source Strategy</h1>
          <div class="page-header-meta">
            <span class="page-badge siem">SIEM Track</span>
            <span class="page-reading-time">Core Planning Document</span>
          </div>
          <p class="intro-text">Strategic overview of what logs go where and why. The key principle: <strong>Defender detects attacks; Entra ID logs record changes.</strong> This drives every ingestion decision.</p>
        </div>

        <!-- ==================== SECTION 1: CRITICAL DISTINCTION ==================== -->
        <h2>1. The Critical Distinction: Attacks vs. Control-Plane</h2>

        <div class="callout critical">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>This Changes Everything</div>
          <div class="callout-content">
            <p><strong>Defender products detect ATTACKS.</strong> They do NOT provide audit logs for control-plane changes.</p>
            <p>Account creation, group changes, role assignments, CA policy changes — these come from <strong>Entra ID diagnostic logs</strong>, NOT from Defender.</p>
            <p style="margin-top: 0.5rem;"><strong>Understanding this determines your entire log ingestion strategy.</strong></p>
          </div>
        </div>

        <h3>1.1 What Each Defender Product Provides</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Defender Product</th><th>Detects (Attacks) ✓</th><th>Does NOT Provide ✗</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>MDI</strong><br>Defender for Identity</td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>Pass-the-Hash / Pass-the-Ticket</li>
                    <li>Kerberoasting, Golden Ticket</li>
                    <li>DCSync / replication abuse</li>
                    <li>Lateral movement via SMB/NTLM</li>
                    <li>LDAP reconnaissance</li>
                  </ul>
                </td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>❌ User account creation logs</li>
                    <li>❌ Group membership change logs</li>
                    <li>❌ Role assignment audits</li>
                    <li>❌ MFA / CA policy changes</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>MDO</strong><br>Defender for Office 365</td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>Phishing campaigns</li>
                    <li>Malicious attachments/URLs</li>
                    <li>Business Email Compromise (BEC)</li>
                    <li>Email-based lateral movement</li>
                  </ul>
                </td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>❌ Mailbox permission changes</li>
                    <li>❌ Transport rule changes</li>
                    <li>❌ Mailbox forwarding audits</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>MDE</strong><br>Defender for Endpoint</td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>Malware and ransomware</li>
                    <li>LOLBins abuse</li>
                    <li>Credential theft (LSASS, SAM)</li>
                    <li>Persistence mechanisms</li>
                    <li>Exploit activity</li>
                  </ul>
                </td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>❌ Device join/removal audits</li>
                    <li>❌ Entra ID role assignments</li>
                    <li>❌ Identity lifecycle events</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>MDA</strong><br>Defender for Cloud Apps</td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>Impossible travel</li>
                    <li>Risky OAuth app consent</li>
                    <li>Data exfiltration behavior</li>
                    <li>Shadow IT detection</li>
                  </ul>
                </td>
                <td>
                  <ul style="margin: 0; padding-left: 1rem;">
                    <li>❌ App registration audit logs</li>
                    <li>❌ Consent changes (full fidelity)</li>
                    <li>❌ Tenant-wide config history</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>1.2 How This Drives Log Ingestion</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Log Architecture Model</span></div>
          <pre><code>LOG INGESTION STRATEGY - DRIVEN BY ATTACKS VS. CHANGES
═══════════════════════════════════════════════════════════════════════════════

QUESTION: "Where do I see that a user was added to Global Admins?"
ANSWER:   AuditLogs (Entra ID) — NOT MDI

QUESTION: "Where do I see Pass-the-Hash attack detection?"
ANSWER:   SecurityAlert (from XDR/MDI) — NOT AuditLogs

QUESTION: "Where do I see CA policy was modified?"
ANSWER:   AuditLogs (Entra ID) — NOT any Defender product

QUESTION: "Where do I see ransomware detection?"
ANSWER:   SecurityAlert (from XDR/MDE) — NOT SecurityEvent


THEREFORE:
┌─────────────────────────────────────────────────────────────────────────────┐
│ MUST INGEST SEPARATELY (Not from XDR)                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│ • Entra ID AuditLogs       → User/group/role changes                       │
│ • Entra ID SigninLogs      → Authentication, MFA, CA evaluation            │
│ • OfficeActivity           → SharePoint, Exchange, Teams admin             │
│ • AzureActivity            → Azure control-plane                           │
│ • IntuneAuditLogs          → Device management changes                     │
│ • Network logs (Palo Alto) → Firewall, VPN                                 │
│ • SaaS logs (SF, WD, NS)   → App-specific activity                         │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ FROM XDR (Alerts & Incidents only)                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│ • SecurityAlert            → All Defender alerts                           │
│ • SecurityIncident         → Correlated incidents                          │
│ • AlertEvidence            → Entity context                                │
│ • Raw telemetry           → STAYS IN XDR (query via Advanced Hunting)      │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
        </div>

        <!-- ==================== SECTION 2: COMPLETE LOG SOURCE MAP ==================== -->
        <h2>2. Complete Log Source Map</h2>

        <p>All log sources for RevFlow's security operations, categorized by priority and ingestion decision.</p>

        <h3>2.1 P0 — Critical (Must Have)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Category</th><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Why Critical</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td rowspan="8"><strong>Entra ID<br>(Identity)</strong></td>
                <td>Audit Logs</td>
                <td><code>AuditLogs</code></td>
                <td>Analytics</td>
                <td>User/group/role changes — NOT in XDR</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Sign-in Logs</td>
                <td><code>SigninLogs</code></td>
                <td>Analytics</td>
                <td>Auth events, MFA, CA evaluation</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Non-Interactive Sign-ins</td>
                <td><code>AADNonInteractiveUserSignInLogs</code></td>
                <td>Basic</td>
                <td>Token refreshes, background auth</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Service Principal Sign-ins</td>
                <td><code>AADServicePrincipalSignInLogs</code></td>
                <td>Analytics</td>
                <td>App-to-app auth, automation</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Managed Identity Sign-ins</td>
                <td><code>AADManagedIdentitySignInLogs</code></td>
                <td>Analytics</td>
                <td>Azure resource identities</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Provisioning Logs</td>
                <td><code>AADProvisioningLogs</code></td>
                <td>Analytics</td>
                <td>HR sync (Workday → Entra)</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>Risky Users</td>
                <td><code>AADRiskyUsers</code></td>
                <td>Analytics</td>
                <td>Identity Protection risk</td>
              </tr>
              <tr style="background: rgba(239, 68, 68, 0.05);">
                <td>User Risk Events</td>
                <td><code>AADUserRiskEvents</code></td>
                <td>Analytics</td>
                <td>Risk detections (leaked creds, etc.)</td>
              </tr>
              <tr style="background: rgba(251, 191, 36, 0.05);">
                <td rowspan="3"><strong>XDR<br>(Attacks)</strong></td>
                <td>XDR Alerts</td>
                <td><code>SecurityAlert</code></td>
                <td>Analytics</td>
                <td>All Defender alerts for correlation</td>
              </tr>
              <tr style="background: rgba(251, 191, 36, 0.05);">
                <td>XDR Incidents</td>
                <td><code>SecurityIncident</code></td>
                <td>Analytics</td>
                <td>Correlated incidents</td>
              </tr>
              <tr style="background: rgba(251, 191, 36, 0.05);">
                <td>Alert Evidence</td>
                <td><code>AlertEvidence</code></td>
                <td>Analytics</td>
                <td>Entity context</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.05);">
                <td rowspan="2"><strong>Microsoft 365</strong></td>
                <td>Office Activity</td>
                <td><code>OfficeActivity</code></td>
                <td>Analytics</td>
                <td>SharePoint, Exchange, Teams admin</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.05);">
                <td>Azure Activity</td>
                <td><code>AzureActivity</code></td>
                <td>Free</td>
                <td>Azure control-plane changes</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>2.2 P1 — Important (Required for Coverage)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Category</th><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Why Important</th></tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="4"><strong>Intune<br>(Device Mgmt)</strong></td>
                <td>Intune Audit Logs</td>
                <td><code>IntuneAuditLogs</code></td>
                <td>Analytics</td>
                <td>Policy changes, admin actions</td>
              </tr>
              <tr>
                <td>Device Compliance</td>
                <td><code>IntuneDeviceComplianceOrg</code></td>
                <td>Analytics</td>
                <td>Compliance state changes</td>
              </tr>
              <tr>
                <td>Intune Devices</td>
                <td><code>IntuneDevices</code></td>
                <td>Basic</td>
                <td>Device inventory for context</td>
              </tr>
              <tr>
                <td>Operational Logs</td>
                <td><code>IntuneOperationalLogs</code></td>
                <td>Basic</td>
                <td>Enrollment, sync issues</td>
              </tr>
              <tr>
                <td rowspan="3"><strong>Network</strong></td>
                <td>Palo Alto (Threat)</td>
                <td><code>CommonSecurityLog</code></td>
                <td>Analytics</td>
                <td>Network threat detection</td>
              </tr>
              <tr>
                <td>Palo Alto (VPN/GlobalProtect)</td>
                <td><code>Syslog</code></td>
                <td>Analytics</td>
                <td>VPN connections, geo correlation</td>
              </tr>
              <tr>
                <td>DNS Events</td>
                <td><code>DnsEvents</code></td>
                <td>Analytics</td>
                <td>DNS tunneling, suspicious domains</td>
              </tr>
              <tr>
                <td rowspan="4"><strong>SaaS Apps</strong></td>
                <td>Salesforce</td>
                <td><code>Salesforce_CL</code></td>
                <td>Analytics</td>
                <td>Data export monitoring</td>
              </tr>
              <tr>
                <td>Workday</td>
                <td><code>Workday_CL</code></td>
                <td>Analytics</td>
                <td>HR changes, termination correlation</td>
              </tr>
              <tr>
                <td>NetSuite</td>
                <td><code>NetSuite_CL</code></td>
                <td>Analytics</td>
                <td>Financial system, BEC risk</td>
              </tr>
              <tr>
                <td>GitHub</td>
                <td><code>GitHub_CL</code></td>
                <td>Analytics</td>
                <td>Code access, PAT creation</td>
              </tr>
              <tr>
                <td rowspan="2"><strong>Windows<br>(Tier 0 only)</strong></td>
                <td>Domain Controllers</td>
                <td><code>SecurityEvent</code></td>
                <td>Analytics</td>
                <td>AD audit beyond MDI coverage</td>
              </tr>
              <tr>
                <td>Certificate Authority</td>
                <td><code>SecurityEvent</code></td>
                <td>Analytics</td>
                <td>Certificate issuance, key access</td>
              </tr>
              <tr>
                <td><strong>Linux</strong></td>
                <td>Linux Servers (via AMA)</td>
                <td><code>Syslog</code></td>
                <td>Analytics</td>
                <td>SSH, sudo, system events</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>2.3 P2 — Selective (High Volume / Forensics)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Why Basic Tier</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Palo Alto (Traffic)</td>
                <td><code>CommonSecurityLog</code></td>
                <td>Basic</td>
                <td>High volume (~50GB/day), forensics only</td>
              </tr>
              <tr>
                <td>NSG Flow Logs</td>
                <td><code>AzureNetworkAnalytics_CL</code></td>
                <td>Basic</td>
                <td>Very high volume, forensics only</td>
              </tr>
              <tr>
                <td>AWS VPC Flow Logs</td>
                <td><code>AWSVPCFlow</code></td>
                <td>Basic</td>
                <td>High volume, forensics only</td>
              </tr>
              <tr>
                <td>Azure Diagnostics (Storage)</td>
                <td><code>AzureDiagnostics</code></td>
                <td>Basic</td>
                <td>High volume storage operations</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>2.4 P3 — Do NOT Ingest (XDR Handles or Skip)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Sentinel Table</th><th>Decision</th><th>Reason</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDE Process Events</td>
                <td><code>DeviceProcessEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>~50M events/day, XDR handles detection</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDE Network Events</td>
                <td><code>DeviceNetworkEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>~30M events/day, XDR handles detection</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDE File Events</td>
                <td><code>DeviceFileEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>~40M events/day, XDR handles detection</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDE Registry Events</td>
                <td><code>DeviceRegistryEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>~20M events/day, XDR handles detection</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDO Email Events</td>
                <td><code>EmailEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>XDR handles email detection</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>MDA Cloud App Events</td>
                <td><code>CloudAppEvents</code></td>
                <td><span class="status-badge">Query in XDR</span></td>
                <td>High volume, MDA alerts sufficient</td>
              </tr>
              <tr style="background: rgba(107, 114, 128, 0.05);">
                <td>Workstation Security Events</td>
                <td><code>SecurityEvent</code></td>
                <td><span class="status-badge">Skip</span></td>
                <td>MDE covers endpoints; avoid duplication</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout info">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Cost Impact of XDR Selective Ingestion</div>
          <div class="callout-content">
            <p><strong>If you ingested all MDE raw telemetry:</strong> ~150M events/day = ~$15,000/month</p>
            <p><strong>By ingesting only alerts/incidents:</strong> ~250 events/day = ~$50/month</p>
            <p><strong>Savings:</strong> ~$15,000/month — query raw data in XDR Advanced Hunting at no extra cost.</p>
          </div>
        </div>

        <!-- ==================== SECTION 3: CLOUD & AWS ==================== -->
        <h2>3. Cloud Infrastructure Logs</h2>

        <h3>3.1 Azure Resources</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Detection Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Azure Activity (all subs)</td>
                <td><code>AzureActivity</code></td>
                <td>Free</td>
                <td>RBAC changes, resource CRUD, policy changes</td>
              </tr>
              <tr>
                <td>Key Vault</td>
                <td><code>AzureDiagnostics</code></td>
                <td>Analytics</td>
                <td>Secret access, key operations</td>
              </tr>
              <tr>
                <td>Storage Accounts</td>
                <td><code>AzureDiagnostics</code></td>
                <td>Basic</td>
                <td>Blob access (high volume)</td>
              </tr>
              <tr>
                <td>App Service</td>
                <td><code>AzureDiagnostics</code></td>
                <td>Analytics</td>
                <td>Web app requests, auth failures</td>
              </tr>
              <tr>
                <td>SQL Auditing</td>
                <td><code>AzureDiagnostics</code></td>
                <td>Analytics</td>
                <td>Database queries, admin actions</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>3.2 AWS (Legacy Workloads)</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Detection Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>CloudTrail</td>
                <td><code>AWSCloudTrail</code></td>
                <td>Analytics</td>
                <td>API calls, IAM changes, console logins</td>
              </tr>
              <tr>
                <td>GuardDuty</td>
                <td><code>AWSGuardDuty</code></td>
                <td>Analytics</td>
                <td>Threat findings from AWS</td>
              </tr>
              <tr>
                <td>VPC Flow Logs</td>
                <td><code>AWSVPCFlow</code></td>
                <td>Basic</td>
                <td>Network flows (forensics only)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 4: DEFENDER FOR CLOUD & TI ==================== -->
        <h2>4. Defender for Cloud & Threat Intelligence</h2>

        <h3>4.1 Defender for Cloud Tables</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Sentinel Table</th><th>Tier</th><th>Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Security Alerts (MDC)</td>
                <td><code>SecurityAlert</code></td>
                <td>Analytics</td>
                <td>Cloud security alerts (separate from XDR)</td>
              </tr>
              <tr>
                <td>Security Recommendations</td>
                <td><code>SecurityRecommendation</code></td>
                <td>Analytics</td>
                <td>Misconfigurations, hardening</td>
              </tr>
              <tr>
                <td>Regulatory Compliance</td>
                <td><code>SecurityRegulatoryCompliance</code></td>
                <td>Analytics</td>
                <td>CIS, NIST, SOC 2 benchmark results</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>4.2 Threat Intelligence</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Source</th><th>Sentinel Table</th><th>Tier</th><th>Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Microsoft TI / TAXII Feeds</td>
                <td><code>ThreatIntelligenceIndicator</code></td>
                <td>Analytics</td>
                <td>IOC matching, enrichment</td>
              </tr>
              <tr>
                <td>Custom Watchlists</td>
                <td><code>Watchlist</code></td>
                <td>Analytics</td>
                <td>VIP users, Tier 0 assets, terminated employees</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 5: WHAT STAYS IN SPLUNK ==================== -->
        <h2>5. What Stays in Splunk (Operations)</h2>

        <p>RevFlow maintains Splunk Cloud for application monitoring. Security owns Sentinel; Engineering owns Splunk.</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Log Source</th><th>Splunk Index</th><th>Owner</th><th>Why Not Sentinel</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Application Performance</td>
                <td><code>app_perf</code></td>
                <td>SRE</td>
                <td>Operational, not security</td>
              </tr>
              <tr>
                <td>RevFlow API Logs</td>
                <td><code>api_logs</code></td>
                <td>Engineering</td>
                <td>Debugging, not security</td>
              </tr>
              <tr>
                <td>Kubernetes Logs</td>
                <td><code>k8s_logs</code></td>
                <td>SRE</td>
                <td>Container ops, not security</td>
              </tr>
              <tr>
                <td>Business Transactions</td>
                <td><code>business_txn</code></td>
                <td>Product</td>
                <td>Feature usage, not security</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 6: COST SUMMARY ==================== -->
        <h2>6. Monthly Cost Projection</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Category</th><th>Daily Volume</th><th>Tier</th><th>Monthly Cost</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Entra ID (all tables)</td>
                <td>~30 GB</td>
                <td>Analytics + Basic</td>
                <td>~$1,500</td>
              </tr>
              <tr>
                <td>XDR Alerts + Incidents</td>
                <td>~0.1 GB</td>
                <td>Analytics</td>
                <td>~$10</td>
              </tr>
              <tr>
                <td>OfficeActivity</td>
                <td>~5 GB</td>
                <td>Analytics</td>
                <td>~$400</td>
              </tr>
              <tr>
                <td>AzureActivity</td>
                <td>~2 GB</td>
                <td>Free</td>
                <td>$0</td>
              </tr>
              <tr>
                <td>Intune (all tables)</td>
                <td>~2 GB</td>
                <td>Analytics + Basic</td>
                <td>~$100</td>
              </tr>
              <tr>
                <td>Network (Palo Alto Threat)</td>
                <td>~5 GB</td>
                <td>Analytics</td>
                <td>~$400</td>
              </tr>
              <tr>
                <td>Network (Palo Alto Traffic)</td>
                <td>~50 GB</td>
                <td>Basic</td>
                <td>~$750</td>
              </tr>
              <tr>
                <td>SaaS Apps (SF, WD, NS, GH)</td>
                <td>~8 GB</td>
                <td>Analytics</td>
                <td>~$660</td>
              </tr>
              <tr>
                <td>Windows (Tier 0 only)</td>
                <td>~3 GB</td>
                <td>Analytics</td>
                <td>~$250</td>
              </tr>
              <tr>
                <td>Linux Servers</td>
                <td>~2 GB</td>
                <td>Analytics</td>
                <td>~$165</td>
              </tr>
              <tr>
                <td>AWS (CloudTrail, GuardDuty)</td>
                <td>~10 GB</td>
                <td>Analytics</td>
                <td>~$830</td>
              </tr>
              <tr>
                <td>AWS VPC Flow</td>
                <td>~20 GB</td>
                <td>Basic</td>
                <td>~$300</td>
              </tr>
              <tr>
                <td>Azure Diagnostics</td>
                <td>~5 GB</td>
                <td>Analytics</td>
                <td>~$400</td>
              </tr>
              <tr>
                <td>Defender for Cloud</td>
                <td>~0.5 GB</td>
                <td>Analytics</td>
                <td>~$40</td>
              </tr>
              <tr style="font-weight: bold; background: var(--bg-tertiary);">
                <td><strong>TOTAL</strong></td>
                <td><strong>~143 GB/day</strong></td>
                <td>—</td>
                <td><strong>~$5,800/month</strong></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Cost Comparison</div>
          <div class="callout-content">
            <p><strong>RSA NetWitness (current):</strong> ~$35,000/month</p>
            <p><strong>Microsoft Sentinel (projected):</strong> ~$5,800/month (with 100 GB commitment tier)</p>
            <p><strong>Savings:</strong> ~83% reduction with improved XDR integration</p>
          </div>
        </div>

        <!-- ==================== SECTION 7: INTERVIEW SUMMARY ==================== -->
        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Interview-Ready Summary</div>
          <div class="callout-content">
            <p><em>"The log source strategy is driven by one key insight: Defender products detect attacks, not control-plane changes. MDI detects Pass-the-Hash, but if you want to know who was added to Global Admins, that's in Entra ID AuditLogs — which we ingest separately.</em></p>
            <p><em>For XDR, we ingest alerts and incidents into Sentinel, but raw telemetry like DeviceProcessEvents stays in XDR — that saves $15K/month and the data is still queryable via Advanced Hunting.</em></p>
            <p><em>The rest of the strategy fills gaps XDR doesn't cover: network logs from Palo Alto, SaaS activity from Salesforce and Workday, and SecurityEvents from Tier 0 infrastructure like Domain Controllers. That's what Sentinel correlation rules need for cross-domain detection."</em></p>
          </div>
        </div>

        <nav class="page-nav">
          <a href="discovery.html" class="page-nav-link prev"><span class="page-nav-label">Previous</span><span class="page-nav-title">← Discovery & Assessment</span></a>
          <a href="log-engineering.html" class="page-nav-link next"><span class="page-nav-label">Next</span><span class="page-nav-title">Log Engineering →</span></a>
        </nav>
      </div>
    </main>
  </div>
  <script src="../js/main.js"></script>
</body>
</html>
