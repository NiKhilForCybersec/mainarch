<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Splunk Parsing Deep Dive | props, transforms, CIM</title>
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .concept-card {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.02));
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    
    .flow-diagram {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
      overflow-x: auto;
      white-space: pre;
      line-height: 1.4;
    }
    
    .code-block {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      overflow-x: auto;
    }
    
    .code-block .comment {
      color: #6b7280;
    }
    
    .code-block .keyword {
      color: #22c55e;
    }
    
    .code-block .function {
      color: #8b5cf6;
    }
    
    .code-block .string {
      color: #f59e0b;
    }
    
    .code-block .field {
      color: #06b6d4;
    }
    
    .code-block .stanza {
      color: #ec4899;
      font-weight: bold;
    }
    
    .pattern-box {
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .pattern-box h4 {
      color: #22c55e;
      margin-top: 0;
    }
    
    .warning-box {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .warning-box h4 {
      color: #ef4444;
      margin-top: 0;
    }
    
    .info-box {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .info-box h4 {
      color: #3b82f6;
      margin-top: 0;
    }
    
    .tip-box {
      background: rgba(234, 179, 8, 0.1);
      border: 1px solid rgba(234, 179, 8, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .tip-box h4 {
      color: #eab308;
      margin-top: 0;
    }
    
    .two-column {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 1.5rem;
    }
    
    .three-column {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }
    
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    .comparison-table th {
      background: rgba(34, 197, 94, 0.2);
      padding: 0.75rem;
      text-align: left;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .comparison-table td {
      padding: 0.75rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      vertical-align: top;
    }
    
    .comparison-table tr:nth-child(even) {
      background: rgba(0, 0, 0, 0.2);
    }
    
    .stage-header {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.1));
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin: 2rem 0 1rem 0;
      border-left: 4px solid #22c55e;
    }
    
    .stage-header h2 {
      margin: 0;
      color: #22c55e;
    }
    
    .stage-header p {
      margin: 0.5rem 0 0 0;
      color: var(--text-secondary);
    }
    
    .file-reference {
      background: rgba(139, 92, 246, 0.1);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 8px;
      padding: 0.5rem 1rem;
      margin: 0.5rem 0;
      display: inline-block;
    }
    
    .file-reference code {
      color: #8b5cf6;
      font-weight: bold;
    }
    
    details {
      margin: 1rem 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    
    details summary {
      background: rgba(34, 197, 94, 0.1);
      padding: 0.75rem 1rem;
      cursor: pointer;
      font-weight: 600;
    }
    
    details summary:hover {
      background: rgba(34, 197, 94, 0.15);
    }
    
    details[open] summary {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    details .details-content {
      padding: 1rem;
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/parsing-deep-dive.html" class="nav-item">Parsing Deep Dive</a>
          <a href="../siem/parsing-normalization-overview.html" class="nav-item">Parsing Overview</a>
          <a href="../siem/sentinel-parsing-deep-dive.html" class="nav-item">Sentinel Parsing</a>
          <a href="../siem/splunk-parsing-deep-dive.html" class="nav-item active">Splunk Parsing</a>
          <a href="../siem/parsing-patterns-comparison.html" class="nav-item">Parsing Comparison</a>
          <a href="../siem/threat-intelligence.html" class="nav-item">Threat Intelligence</a>
          <a href="../siem/threat-intel-integration.html" class="nav-item">TI Integration</a>
          <a href="../siem/vuln-management-workflow.html" class="nav-item">Vuln Management</a>
          <a href="../siem/detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soar-automation.html" class="nav-item">SOAR &amp; Automation</a>
          <a href="../siem/cost-optimization.html" class="nav-item">Cost Optimization</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/advanced-hunting.html" class="nav-item">Advanced Hunting</a>
          <a href="../edr/tvm.html" class="nav-item">Vulnerability Management</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">â˜… Interview Prep</div>
          <a href="../interview-behavioral.html" class="nav-item">Behavioral Questions</a>
          <a href="../interview-technical.html" class="nav-item">Technical Questions</a>
          <a href="../interview-team-fit.html" class="nav-item">Team Fit &amp; Director</a>
          <a href="../interview-cheatsheet.html" class="nav-item">âš¡ Quick Cheat Sheet</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career &amp; Reference</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../director-interview-prep.html" class="nav-item">Director Prep (Full)</a>
        </div>
      </nav>
    </aside>
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>
    <div class="sidebar-overlay"></div>
    <main class="main-content">
      <div class="content-wrapper">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Splunk Parsing</span>
        </nav>
        <h1>Splunk: Parsing Deep Dive</h1>
        <p class="section-description">Complete guide to parsing, normalization, and enrichment</p>
      </div>

      <!-- ==================== ARCHITECTURE OVERVIEW ==================== -->
      <section id="overview">
        <div class="concept-card">
          <h2>ğŸ—ï¸ Splunk Data Processing Architecture</h2>
          
          <div class="flow-diagram">
<span style="color: #22c55e; font-weight: bold;">SPLUNK DATA FLOW â€” COMPLETE PIPELINE</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #22c55e;">DATA SOURCES</span>                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Windows  â”‚  â”‚  Linux   â”‚  â”‚  Network â”‚  â”‚ Firewall â”‚  â”‚  Custom  â”‚  â”‚   APIs   â”‚       â”‚
â”‚  â”‚  Events  â”‚  â”‚  Syslog  â”‚  â”‚  Devices â”‚  â”‚  Logs    â”‚  â”‚   Apps   â”‚  â”‚  (HEC)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              <span style="color: #f59e0b;">FORWARDER LAYER</span>                                             â”‚
â”‚                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Universal Forwarder (UF)                                     â”‚   â”‚
â”‚  â”‚  â€¢ Collects logs from sources                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Minimal processing (line breaking, encoding)                                     â”‚   â”‚
â”‚  â”‚  â€¢ Forwards raw data to indexers or heavy forwarder                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚              â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                        â”‚                                                    â”‚
â”‚                                        â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Heavy Forwarder (HF) â€” OPTIONAL                              â”‚   â”‚
â”‚  â”‚  â€¢ Full parsing capability                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Can apply props.conf / transforms.conf                                           â”‚   â”‚
â”‚  â”‚  â€¢ Routing, filtering, field extraction                                             â”‚   â”‚
â”‚  â”‚  â€¢ Use case: Pre-process before indexing, reduce load on indexers                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                              â”‚
                                                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          <span style="color: #ef4444;">INDEX-TIME PROCESSING (Indexer)</span>                                â”‚
â”‚                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              Indexer Processing                                     â”‚   â”‚
â”‚  â”‚                                                                                     â”‚   â”‚
â”‚  â”‚  <span style="color: #ec4899;">props.conf</span>                          <span style="color: #ec4899;">transforms.conf</span>                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Line breaking         â”‚     â”‚ â€¢ Field extractions     â”‚                        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Timestamp recognition â”‚     â”‚ â€¢ Routing rules         â”‚                        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Sourcetype assignment â”‚     â”‚ â€¢ Masking/anonymization â”‚                        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Character encoding    â”‚     â”‚ â€¢ Null queue (drop)     â”‚                        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Event breaking        â”‚     â”‚ â€¢ Index-time fields     â”‚                        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚  â”‚                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              <span style="color: #06b6d4;">INDEXES (Storage)</span>                                          â”‚
â”‚                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                 Index Buckets                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚    main      â”‚  â”‚   security   â”‚  â”‚   network    â”‚  â”‚   custom     â”‚            â”‚   â”‚
â”‚  â”‚  â”‚   (default)  â”‚  â”‚  (sec logs)  â”‚  â”‚ (fw, router) â”‚  â”‚  (app logs)  â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                                                     â”‚   â”‚
â”‚  â”‚  Raw data stored + basic metadata (source, sourcetype, host, _time)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          <span style="color: #8b5cf6;">SEARCH-TIME PROCESSING (Search Head)</span>                           â”‚
â”‚                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                            Knowledge Objects                                         â”‚  â”‚
â”‚  â”‚                                                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚ Field          â”‚  â”‚ Field Aliases  â”‚  â”‚ Calculated     â”‚  â”‚ Lookups        â”‚     â”‚  â”‚
â”‚  â”‚  â”‚ Extractions    â”‚  â”‚ (CIM mapping)  â”‚  â”‚ Fields (eval)  â”‚  â”‚ (enrichment)   â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚  â”‚ Event Types    â”‚  â”‚ Tags           â”‚  â”‚ Data Models    â”‚                         â”‚  â”‚
â”‚  â”‚  â”‚ (categorize)   â”‚  â”‚ (classify)     â”‚  â”‚ (acceleration) â”‚                         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â”‚                                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              SPL Commands (Search Processing)                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚   rex     â”‚â”€â”€â–¶â”‚   eval    â”‚â”€â”€â–¶â”‚  lookup   â”‚â”€â”€â–¶â”‚   join    â”‚â”€â”€â–¶â”‚ tstats    â”‚     â”‚  â”‚
â”‚  â”‚  â”‚ (extract) â”‚   â”‚ (compute) â”‚   â”‚ (enrich)  â”‚   â”‚ (combine) â”‚   â”‚ (accel)   â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </div>
        </div>

        <div class="concept-card">
          <h3>Key Configuration Files</h3>
          
          <div class="three-column">
            <div class="file-reference">
              <code>props.conf</code>
              <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Parsing rules tied to sourcetype. Line breaking, timestamp, field extractions.</p>
            </div>
            
            <div class="file-reference">
              <code>transforms.conf</code>
              <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Reusable transformations. Field extraction regexes, routing, masking.</p>
            </div>
            
            <div class="file-reference">
              <code>fields.conf</code>
              <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Field properties. Indexed vs extracted, multivalued settings.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- ==================== INDEX-TIME PROCESSING ==================== -->
      <section id="index-time">
        <div class="stage-header">
          <h2>ğŸ“¥ Stage 1: Index-Time Processing</h2>
          <p>Processing that happens BEFORE data is written to disk â€” permanent and affects license</p>
        </div>

        <div class="concept-card">
          <h3>props.conf â€” The Heart of Parsing</h3>
          <p>Defines how Splunk handles incoming data based on sourcetype.</p>
          
          <div class="code-block">
<span class="comment"># props.conf - Located in $SPLUNK_HOME/etc/system/local/ or app directory</span>

<span class="stanza">[paloalto:traffic]</span>
<span class="comment"># Time parsing</span>
<span class="field">TIME_FORMAT</span> = %Y/%m/%d %H:%M:%S
<span class="field">TIME_PREFIX</span> = ^
<span class="field">MAX_TIMESTAMP_LOOKAHEAD</span> = 25

<span class="comment"># Event breaking</span>
<span class="field">SHOULD_LINEMERGE</span> = false
<span class="field">LINE_BREAKER</span> = ([\r\n]+)

<span class="comment"># Truncation</span>
<span class="field">TRUNCATE</span> = 10000

<span class="comment"># Character encoding</span>
<span class="field">CHARSET</span> = UTF-8

<span class="comment"># Field extractions (calls transforms.conf)</span>
<span class="field">TRANSFORMS-paloalto</span> = paloalto_traffic_extract

<span class="comment"># Search-time field aliases (CIM)</span>
<span class="field">FIELDALIAS-src</span> = src_ip AS src
<span class="field">FIELDALIAS-dest</span> = dest_ip AS dest
<span class="field">FIELDALIAS-user</span> = src_user AS user
          </div>
        </div>

        <div class="concept-card">
          <h3>transforms.conf â€” Reusable Transformations</h3>
          
          <div class="code-block">
<span class="comment"># transforms.conf</span>

<span class="stanza">[paloalto_traffic_extract]</span>
<span class="comment"># Regex field extraction</span>
<span class="field">REGEX</span> = ^(?:[^,]*,){6}([^,]+),(?:[^,]*,){2}([^,]+),([^,]+),(?:[^,]*,){2}([^,]+),([^,]+),([^,]+)
<span class="field">FORMAT</span> = action::$1 src_ip::$2 dest_ip::$3 src_port::$4 dest_port::$5 protocol::$6

<span class="stanza">[paloalto_routing]</span>
<span class="comment"># Route to specific index based on content</span>
<span class="field">REGEX</span> = action="?(allow|deny)"?
<span class="field">DEST_KEY</span> = _MetaData:Index
<span class="field">FORMAT</span> = security

<span class="stanza">[mask_credit_card]</span>
<span class="comment"># Mask sensitive data before indexing</span>
<span class="field">REGEX</span> = \b(\d{4})\d{8}(\d{4})\b
<span class="field">FORMAT</span> = $1********$2
<span class="field">DEST_KEY</span> = _raw

<span class="stanza">[null_queue_debug]</span>
<span class="comment"># Drop events completely (don't index)</span>
<span class="field">REGEX</span> = DEBUG|TRACE|healthcheck
<span class="field">DEST_KEY</span> = queue
<span class="field">FORMAT</span> = nullQueue
          </div>
        </div>

        <div class="two-column">
          <div class="pattern-box">
            <h4>âœ… Use Index-Time Processing For:</h4>
            <ul>
              <li><strong>Line breaking:</strong> Multi-line events need correct breaking</li>
              <li><strong>Timestamp extraction:</strong> Must be done at index time</li>
              <li><strong>Routing:</strong> Send to different indexes based on content</li>
              <li><strong>Masking PII:</strong> Must happen before indexing</li>
              <li><strong>Dropping noise:</strong> nullQueue saves license</li>
              <li><strong>High-cardinality indexed fields:</strong> For faster filtering</li>
            </ul>
          </div>
          
          <div class="warning-box">
            <h4>âš ï¸ Index-Time Limitations:</h4>
            <ul>
              <li><strong>Increases license:</strong> Extracted fields count toward license</li>
              <li><strong>Permanent:</strong> Mistakes require re-indexing to fix</li>
              <li><strong>Deployment overhead:</strong> Changes need cluster restart</li>
              <li><strong>Testing required:</strong> Always test in dev first</li>
              <li><strong>Complex regex = slow:</strong> Impacts ingestion throughput</li>
            </ul>
          </div>
        </div>

        <details>
          <summary><strong>Pattern: Route Logs to Different Indexes</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="comment"># props.conf</span>
<span class="stanza">[firewall_logs]</span>
<span class="field">TRANSFORMS-routing</span> = route_by_action

<span class="comment"># transforms.conf</span>
<span class="stanza">[route_by_action]</span>
<span class="comment"># Allow traffic goes to network index</span>
<span class="field">REGEX</span> = action="allow"
<span class="field">DEST_KEY</span> = _MetaData:Index
<span class="field">FORMAT</span> = network

<span class="stanza">[route_deny_to_security]</span>
<span class="comment"># Deny traffic goes to security index</span>
<span class="field">REGEX</span> = action="deny"
<span class="field">DEST_KEY</span> = _MetaData:Index
<span class="field">FORMAT</span> = security
            </div>
          </div>
        </details>

        <details>
          <summary><strong>Pattern: Drop Noisy Events (Save License)</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="comment"># props.conf</span>
<span class="stanza">[windows:security]</span>
<span class="field">TRANSFORMS-drop</span> = drop_noisy_windows_events

<span class="comment"># transforms.conf</span>
<span class="stanza">[drop_noisy_windows_events]</span>
<span class="comment"># Drop EventIDs that are noise (adjust based on your needs)</span>
<span class="field">REGEX</span> = EventCode=(4634|4647|4658|4660|4663|5156|5158)
<span class="field">DEST_KEY</span> = queue
<span class="field">FORMAT</span> = nullQueue
            </div>
            <p><strong>Impact:</strong> Can reduce Windows Security log volume by 40-60%</p>
          </div>
        </details>
      </section>

      <!-- ==================== SEARCH-TIME PROCESSING ==================== -->
      <section id="search-time">
        <div class="stage-header">
          <h2>ğŸ” Stage 2: Search-Time Processing</h2>
          <p>Processing during search execution â€” flexible, no re-indexing needed</p>
        </div>

        <div class="concept-card">
          <h3>Knowledge Objects for Search-Time</h3>
          
          <div class="two-column">
            <div class="info-box">
              <h4>Field Extractions</h4>
              <p>Extract fields from raw events during search.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># props.conf (search-time extraction)</span>
<span class="stanza">[sourcetype::custom_app]</span>
<span class="field">EXTRACT-user</span> = user=(?P&lt;<span class="field">user</span>&gt;[^\s]+)
<span class="field">EXTRACT-action</span> = action=(?P&lt;<span class="field">action</span>&gt;\w+)
<span class="field">EXTRACT-ip</span> = ip=(?P&lt;<span class="field">src_ip</span>&gt;\d+\.\d+\.\d+\.\d+)
              </div>
            </div>
            
            <div class="info-box">
              <h4>Field Aliases</h4>
              <p>Map source-specific fields to CIM standard names.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># props.conf</span>
<span class="stanza">[sourcetype::firewall_logs]</span>
<span class="field">FIELDALIAS-src</span> = source_address AS src
<span class="field">FIELDALIAS-dest</span> = destination_address AS dest
<span class="field">FIELDALIAS-src_port</span> = source_port AS src_port
<span class="field">FIELDALIAS-action</span> = fw_action AS action
              </div>
            </div>
            
            <div class="info-box">
              <h4>Calculated Fields</h4>
              <p>Derive new fields using eval expressions.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># props.conf</span>
<span class="stanza">[sourcetype::web_access]</span>
<span class="field">EVAL-response_time_ms</span> = response_time * 1000
<span class="field">EVAL-is_error</span> = if(status >= 400, "true", "false")
<span class="field">EVAL-bytes_kb</span> = bytes / 1024
              </div>
            </div>
            
            <div class="info-box">
              <h4>Event Types & Tags</h4>
              <p>Categorize events for easier searching and CIM compliance.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># eventtypes.conf</span>
<span class="stanza">[authentication_success]</span>
<span class="field">search</span> = sourcetype=windows:security EventCode=4624

<span class="comment"># tags.conf</span>
<span class="stanza">[eventtype=authentication_success]</span>
<span class="field">authentication</span> = enabled
<span class="field">success</span> = enabled
              </div>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3>SPL Commands for Parsing</h3>
          
          <div class="three-column">
            <div class="info-box">
              <h4>rex (Regex Extract)</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Extract with regex</span>
| <span class="keyword">rex</span> field=_raw 
    <span class="string">"user=(?P&lt;user&gt;[^\s]+)"</span>
| <span class="keyword">rex</span> field=message 
    <span class="string">"from (?P&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"</span>
              </div>
            </div>
            
            <div class="info-box">
              <h4>eval (Calculate)</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Derive fields</span>
| <span class="keyword">eval</span> duration_min = duration/60
| <span class="keyword">eval</span> is_admin = 
    <span class="function">if</span>(<span class="function">match</span>(user, "admin"), 
    "yes", "no")
| <span class="keyword">eval</span> risk = bytes * 0.001
              </div>
            </div>
            
            <div class="info-box">
              <h4>spath (JSON/XML)</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Parse JSON</span>
| <span class="keyword">spath</span> input=_raw
| <span class="keyword">spath</span> path=user.name output=username
| <span class="keyword">spath</span> path=event.action output=action
              </div>
            </div>
            
            <div class="info-box">
              <h4>mvexpand (Multi-value)</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Expand multi-value field</span>
| <span class="keyword">makemv</span> delim="," permissions
| <span class="keyword">mvexpand</span> permissions
| <span class="keyword">stats</span> count by permissions
              </div>
            </div>
            
            <div class="info-box">
              <h4>xmlkv / kvform</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Parse key-value pairs</span>
| <span class="keyword">kvform</span>
<span class="comment">| Parse XML</span>
| <span class="keyword">xmlkv</span>
              </div>
            </div>
            
            <div class="info-box">
              <h4>rename / fields</h4>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Normalize field names</span>
| <span class="keyword">rename</span> source_ip AS src_ip
| <span class="keyword">rename</span> dest_address AS dest
| <span class="keyword">fields</span> - _raw, _time
              </div>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3>Complete Search-Time Parsing Example</h3>
          
          <div class="code-block">
<span class="comment">| Parse custom JSON application logs with full enrichment</span>

index=custom_apps sourcetype=myapp:json
| <span class="keyword">spath</span> input=_raw
<span class="comment">| Extract nested fields</span>
| <span class="keyword">eval</span> user = <span class="function">spath</span>(_raw, "user.email")
| <span class="keyword">eval</span> action = <span class="function">spath</span>(_raw, "event.action")
| <span class="keyword">eval</span> resource = <span class="function">spath</span>(_raw, "resource.name")
| <span class="keyword">eval</span> src_ip = <span class="function">spath</span>(_raw, "client.ip")
| <span class="keyword">eval</span> result = <span class="function">spath</span>(_raw, "result.status")
<span class="comment">| Handle array field</span>
| <span class="keyword">eval</span> permissions = <span class="function">spath</span>(_raw, "permissions{}")
| <span class="keyword">mvexpand</span> permissions
<span class="comment">| Normalize field names for CIM</span>
| <span class="keyword">eval</span> src = src_ip
| <span class="keyword">eval</span> dest = resource
<span class="comment">| Add calculated fields</span>
| <span class="keyword">eval</span> is_failure = <span class="function">if</span>(result=="failure", 1, 0)
| <span class="keyword">eval</span> hour = <span class="function">strftime</span>(_time, "%H")
| <span class="keyword">eval</span> is_after_hours = <span class="function">if</span>(hour < 7 OR hour > 19, 1, 0)
<span class="comment">| Lookup enrichment</span>
| <span class="keyword">lookup</span> asset_classification.csv dest OUTPUT asset_criticality, owner
| <span class="keyword">lookup</span> geo_ip.csv src_ip OUTPUT country, city
<span class="comment">| Filter and aggregate</span>
| <span class="keyword">where</span> is_failure=1 AND asset_criticality="critical"
| <span class="keyword">stats</span> count as failures by user, src_ip, country, resource
          </div>
        </div>
      </section>

      <!-- ==================== CIM NORMALIZATION ==================== -->
      <section id="cim">
        <div class="stage-header">
          <h2>ğŸ“ Stage 3: CIM Normalization</h2>
          <p>Splunk's Common Information Model for cross-source correlation</p>
        </div>

        <div class="concept-card">
          <h3>How CIM Works</h3>
          
          <div class="flow-diagram">
<span style="color: #22c55e; font-weight: bold;">CIM NORMALIZATION FLOW</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              RAW DATA (Native Fields)                           â”‚
â”‚                                                                                 â”‚
â”‚  <span style="color: #f59e0b;">Windows Security:</span>          <span style="color: #f59e0b;">Palo Alto:</span>              <span style="color: #f59e0b;">Linux PAM:</span>                â”‚
â”‚  TargetUserName            src_user                user                        â”‚
â”‚  IpAddress                 src_ip                  rhost                       â”‚
â”‚  EventCode=4624            action="allow"          type=USER_AUTH              â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                              â”‚
                                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     <span style="color: #8b5cf6;">Technology Add-ons (TAs)</span>                                  â”‚
â”‚                                                                                 â”‚
â”‚  Each TA contains:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ <span style="color: #ec4899;">props.conf</span> â€” Field aliases + calculated fields                            â”‚â”‚
â”‚  â”‚                                                                            â”‚â”‚
â”‚  â”‚ FIELDALIAS-user = TargetUserName AS user                                   â”‚â”‚
â”‚  â”‚ FIELDALIAS-src = IpAddress AS src                                          â”‚â”‚
â”‚  â”‚ EVAL-action = if(EventCode=4624, "success", "failure")                     â”‚â”‚
â”‚  â”‚                                                                            â”‚â”‚
â”‚  â”‚ <span style="color: #ec4899;">tags.conf</span> â€” Map to CIM data models                                        â”‚â”‚
â”‚  â”‚                                                                            â”‚â”‚
â”‚  â”‚ [eventtype=windows_authentication]                                         â”‚â”‚
â”‚  â”‚ authentication = enabled                                                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                              â”‚
                                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      <span style="color: #06b6d4;">CIM Data Model (Authentication)</span>                         â”‚
â”‚                                                                                 â”‚
â”‚  All sources now have normalized fields:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  <span style="color: #22c55e;">user</span>    â”‚  <span style="color: #22c55e;">src</span>     â”‚  <span style="color: #22c55e;">action</span>   â”‚  <span style="color: #22c55e;">app</span>     â”‚  <span style="color: #22c55e;">dest</span>    â”‚  <span style="color: #22c55e;">signature</span>  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚  Search using data model:                                                       â”‚
â”‚  | datamodel Authentication Successful_Authentication search                    â”‚
â”‚  | stats count by user, src, app                                                â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </div>
        </div>

        <div class="concept-card">
          <h3>CIM Data Models Reference</h3>
          
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Data Model</th>
                <th>Key CIM Fields</th>
                <th>Common Source Types</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Authentication</strong></td>
                <td>user, src, dest, action, app, signature</td>
                <td>windows:security, linux:auth, okta, azure:aad</td>
              </tr>
              <tr>
                <td><strong>Network Traffic</strong></td>
                <td>src_ip, dest_ip, src_port, dest_port, bytes, action, protocol</td>
                <td>pan:traffic, cisco:asa, aws:cloudtrail</td>
              </tr>
              <tr>
                <td><strong>Endpoint</strong></td>
                <td>process, parent_process, user, dest, action, file_path</td>
                <td>windows:sysmon, crowdstrike:events, carbon_black</td>
              </tr>
              <tr>
                <td><strong>Malware</strong></td>
                <td>file_name, file_hash, signature, action, user, dest</td>
                <td>symantec:ep, mcafee:epo, windows:defender</td>
              </tr>
              <tr>
                <td><strong>Web</strong></td>
                <td>url, uri_path, http_method, status, user, src, dest</td>
                <td>apache:access, iis, nginx, proxy logs</td>
              </tr>
              <tr>
                <td><strong>Change</strong></td>
                <td>object, action, user, result, object_category</td>
                <td>windows:security (object access), audit logs</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="concept-card">
          <h3>Writing CIM-Compliant Detections</h3>
          
          <div class="code-block">
<span class="comment">| Brute force detection across ALL authentication sources using CIM</span>
<span class="comment">| Works for Windows, Linux, Okta, Azure AD, etc.</span>

| <span class="keyword">tstats</span> 
    <span class="function">count</span> 
    <span class="function">values</span>(Authentication.user) as users
    <span class="function">dc</span>(Authentication.user) as unique_users
  <span class="keyword">from</span> datamodel=Authentication.Failed_Authentication 
  <span class="keyword">where</span> earliest=-1h
  <span class="keyword">by</span> Authentication.src, _time span=5m
| <span class="keyword">rename</span> Authentication.* as *
| <span class="keyword">where</span> count > 10 AND unique_users > 3
| <span class="keyword">eval</span> severity = <span class="function">case</span>(
    count > 50, "critical",
    count > 20, "high",
    count > 10, "medium",
    1=1, "low"
  )
| <span class="keyword">table</span> _time, src, count, unique_users, users, severity
          </div>
          
          <div class="tip-box">
            <h4>ğŸ’¡ Why tstats?</h4>
            <p><code>tstats</code> queries accelerated data models, making searches 10-100x faster than regular searches. Always use <code>tstats</code> with CIM data models when possible.</p>
          </div>
        </div>
      </section>

      <!-- ==================== ENRICHMENT ==================== -->
      <section id="enrichment">
        <div class="stage-header">
          <h2>ğŸ”— Stage 4: Enrichment</h2>
          <p>Adding context from external data sources</p>
        </div>

        <div class="concept-card">
          <h3>Enrichment Methods in Splunk</h3>
          
          <div class="two-column">
            <div class="info-box">
              <h4>1. CSV Lookups</h4>
              <p>Static CSV files for simple lookups.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># transforms.conf</span>
<span class="stanza">[asset_lookup]</span>
<span class="field">filename</span> = assets.csv
<span class="field">case_sensitive_match</span> = false

<span class="comment"># SPL usage</span>
| <span class="keyword">lookup</span> asset_lookup ip AS src_ip 
    OUTPUT asset_name, criticality, owner
              </div>
            </div>
            
            <div class="info-box">
              <h4>2. KVStore Lookups</h4>
              <p>Dynamic key-value store for larger datasets.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># collections.conf</span>
<span class="stanza">[threat_intel]</span>
<span class="field">enforceTypes</span> = true
<span class="field">field.ip</span> = string
<span class="field">field.threat_type</span> = string

<span class="comment"># SPL usage</span>
| <span class="keyword">lookup</span> threat_intel_lookup ip AS src_ip 
    OUTPUT threat_type, confidence
              </div>
            </div>
            
            <div class="info-box">
              <h4>3. External Lookups (Scripts)</h4>
              <p>Python/shell scripts for dynamic enrichment.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># transforms.conf</span>
<span class="stanza">[geoip_lookup]</span>
<span class="field">external_cmd</span> = geoip.py ip
<span class="field">fields_list</span> = ip, country, city, lat, lon

<span class="comment"># SPL usage</span>
| <span class="keyword">lookup</span> geoip_lookup ip AS src_ip
              </div>
            </div>
            
            <div class="info-box">
              <h4>4. Automatic Lookups</h4>
              <p>Run lookups automatically at search time.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment"># props.conf</span>
<span class="stanza">[firewall_logs]</span>
<span class="field">LOOKUP-assets</span> = asset_lookup ip AS src_ip 
    OUTPUT asset_name, criticality

<span class="comment"># Now every search on firewall_logs</span>
<span class="comment"># automatically enriches with asset info</span>
              </div>
            </div>
          </div>
        </div>

        <div class="concept-card">
          <h3>Complete Enrichment Example</h3>
          
          <div class="code-block">
<span class="comment">| Authentication monitoring with full enrichment</span>

index=security sourcetype=windows:security EventCode=4625
<span class="comment">| Extract base fields</span>
| <span class="keyword">table</span> _time, TargetUserName, IpAddress, WorkstationName, LogonType
| <span class="keyword">rename</span> TargetUserName AS user, IpAddress AS src_ip, WorkstationName AS dest

<span class="comment">| Geo-IP enrichment</span>
| <span class="keyword">lookup</span> geoip_lookup ip AS src_ip OUTPUT country, city, lat, lon

<span class="comment">| Asset classification</span>
| <span class="keyword">lookup</span> asset_lookup hostname AS dest OUTPUT asset_type, criticality, department

<span class="comment">| VIP user enrichment</span>
| <span class="keyword">lookup</span> vip_users.csv user OUTPUT vip_level, executive_flag

<span class="comment">| Threat intel enrichment</span>
| <span class="keyword">lookup</span> threat_intel ip AS src_ip OUTPUT threat_category, threat_score

<span class="comment">| Risk scoring</span>
| <span class="keyword">eval</span> risk_score = 
    <span class="function">if</span>(<span class="function">isnotnull</span>(threat_category), 50, 0) +
    <span class="function">if</span>(executive_flag="true", 30, 0) +
    <span class="function">if</span>(criticality="high", 20, 0) +
    <span class="function">if</span>(country!="United States" AND country!="Canada", 15, 0)

<span class="comment">| Filter high-risk events</span>
| <span class="keyword">where</span> risk_score > 30

<span class="comment">| Aggregate</span>
| <span class="keyword">stats</span> 
    <span class="function">count</span> as failed_attempts,
    <span class="function">values</span>(country) as countries,
    <span class="function">values</span>(dest) as targets,
    <span class="function">max</span>(risk_score) as max_risk
  <span class="keyword">by</span> user, src_ip
| <span class="keyword">sort</span> - max_risk
          </div>
        </div>
      </section>

      <!-- ==================== ACCELERATION ==================== -->
      <section id="acceleration">
        <div class="stage-header">
          <h2>âš¡ Stage 5: Acceleration</h2>
          <p>Pre-computing data for faster searches</p>
        </div>

        <div class="concept-card">
          <h3>Acceleration Methods</h3>
          
          <div class="two-column">
            <div class="info-box">
              <h4>Data Model Acceleration</h4>
              <p>Pre-compute CIM data models for tstats queries.</p>
              <ul>
                <li>Enable in Settings â†’ Data Models</li>
                <li>Choose acceleration period (default: All time)</li>
                <li>Backfill runs in background</li>
                <li>Use <code>tstats</code> to query accelerated data</li>
              </ul>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Query accelerated data model</span>
| <span class="keyword">tstats</span> <span class="function">count</span> 
    <span class="keyword">from</span> datamodel=Authentication 
    <span class="keyword">where</span> Authentication.action=failure
    <span class="keyword">by</span> Authentication.user, _time span=1h
              </div>
            </div>
            
            <div class="info-box">
              <h4>Report Acceleration</h4>
              <p>Cache search results for scheduled reports.</p>
              <ul>
                <li>Enable per saved search</li>
                <li>Results cached after first run</li>
                <li>Subsequent views use cache</li>
                <li>Good for dashboards</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>Summary Indexing</h4>
              <p>Store pre-aggregated results in separate index.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Scheduled search that summarizes hourly</span>
index=security sourcetype=firewall
| <span class="keyword">stats</span> count by src_ip, dest_ip, action
| <span class="keyword">collect</span> index=summary marker="firewall_hourly"
              </div>
            </div>
            
            <div class="info-box">
              <h4>Event Sampling</h4>
              <p>Reduce search volume for exploration.</p>
              <div class="code-block" style="font-size: 0.8rem;">
<span class="comment">| Sample 10% of events for exploration</span>
index=high_volume
| <span class="keyword">sample</span> ratio=10
| <span class="keyword">stats</span> count by sourcetype
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ==================== SUMMARY ==================== -->
      <div class="concept-card">
        <h2>ğŸ“ Quick Reference Summary</h2>
        
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Goal</th>
              <th>Method</th>
              <th>When/Where</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Drop noisy events</td>
              <td>transforms.conf nullQueue</td>
              <td>Index-time â€” saves license</td>
            </tr>
            <tr>
              <td>Route to indexes</td>
              <td>transforms.conf DEST_KEY routing</td>
              <td>Index-time</td>
            </tr>
            <tr>
              <td>Mask PII</td>
              <td>transforms.conf SEDCMD / FORMAT</td>
              <td>Index-time â€” must happen before storage</td>
            </tr>
            <tr>
              <td>Extract fields (stable format)</td>
              <td>props.conf EXTRACT / transforms.conf REGEX</td>
              <td>Index or Search-time</td>
            </tr>
            <tr>
              <td>Extract fields (flexible)</td>
              <td>rex, spath, eval in SPL</td>
              <td>Search-time</td>
            </tr>
            <tr>
              <td>CIM normalization</td>
              <td>FIELDALIAS, EVAL, tags in props.conf</td>
              <td>Search-time via TAs</td>
            </tr>
            <tr>
              <td>Enrichment</td>
              <td>lookup command, LOOKUP in props.conf</td>
              <td>Search-time</td>
            </tr>
            <tr>
              <td>Fast correlation</td>
              <td>tstats + accelerated data models</td>
              <td>Search-time with pre-computed acceleration</td>
            </tr>
          </tbody>
        </table>
      </div>

    </main>
  </div>
</body>
</html>
