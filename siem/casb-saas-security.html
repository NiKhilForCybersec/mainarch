<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CASB & SaaS Security â€” XDR vs SIEM | Cloud Security</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .comparison-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin: 1.5rem 0; }
    .comparison-card { background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: 8px; padding: 1.25rem; }
    .comparison-card h4 { margin: 0 0 1rem 0; display: flex; align-items: center; gap: 0.5rem; }
    .comparison-card.xdr { border-left: 3px solid #3b82f6; }
    .comparison-card.siem { border-left: 3px solid #8b5cf6; }
    .saas-flow { background: var(--bg-tertiary); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
    .capability-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; margin-right: 4px; }
    .capability-badge.xdr { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }
    .capability-badge.siem { background: rgba(139, 92, 246, 0.2); color: #c4b5fd; }
    .capability-badge.both { background: rgba(34, 197, 94, 0.2); color: #86efac; }
    @media (max-width: 768px) { .comparison-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
          <a href="../controls-mapping.html" class="nav-item">Controls Mapping</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/parsing-deep-dive.html" class="nav-item">Parsing Deep Dive</a>
          <a href="../siem/threat-intelligence.html" class="nav-item">Threat Intelligence</a>
          <a href="../siem/detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="../siem/detection-anatomy.html" class="nav-item">Detection Anatomy</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soar-automation.html" class="nav-item">SOAR &amp; Automation</a>
          <a href="../siem/workbooks.html" class="nav-item">Workbooks &amp; Dashboards</a>
          <a href="../siem/cost-optimization.html" class="nav-item">Cost Optimization</a>
          <a href="../siem/casb-saas-security.html" class="nav-item">CASB &amp; SaaS Security</a>
          <a href="../siem/soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/xdr-detection-model.html" class="nav-item">XDR Detection Model</a>
          <a href="../edr/advanced-hunting.html" class="nav-item">Advanced Hunting</a>
          <a href="../edr/live-response.html" class="nav-item">Live Response</a>
          <a href="../edr/tvm.html" class="nav-item">Vulnerability Management</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/device-control.html" class="nav-item">Device Control</a>
          <a href="../edr/compensating-controls.html" class="nav-item">Compensating Controls</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/dlp-catalog.html" class="nav-item">DLP Catalog</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/infrastructure-reference.html" class="nav-item">Infrastructure Reference</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
          <a href="../resources/alternative-architectures.html" class="nav-item">Alternative Architectures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep (Full)</a>
          <a href="../interview-prep-v2.html" class="nav-item">Interview Prep v2</a>
          <a href="../interview-technical-reference.html" class="nav-item">Technical Reference</a>
          <a href="../interview-frameworks.html" class="nav-item">Mental Frameworks</a>
          <a href="../director-interview-prep.html" class="nav-item">Director Interview Prep</a>
          <a href="../soc-maturity.html" class="nav-item">SOC Maturity Roadmap</a>
          <a href="../security-mental-model.html" class="nav-item">Security Mental Model</a>
          <a href="../ai-security-risk.html" class="nav-item">AI Security & Risk</a>
        </div>
      </nav>
    </aside>
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>
    <div class="sidebar-overlay"></div>
    <main class="main-content">
      <div class="content-wrapper">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">CASB & SaaS Security</span>
        </nav>

        <div class="page-header">
          <h1>CASB & SaaS Security</h1>
          <div class="page-header-meta">
            <span class="page-badge siem">SIEM Track</span>
            <span class="page-badge edr">XDR Track</span>
            <span class="page-reading-time">Interview Critical</span>
          </div>
          <p class="intro-text">This page covers the critical distinction between XDR's CASB capabilities and SIEM's SaaS log collection â€” a topic that separates senior security engineers from junior ones in interviews. Understand how Microsoft Defender for Cloud Apps (MDA), Sentinel, and third-party SaaS integrations work together.</p>
        </div>

        <!-- ==================== SECTION 1: THE KEY DISTINCTION ==================== -->
        <h2>1. The Critical Distinction (Interview Winner)</h2>

        <div class="callout info" style="margin-bottom: 1.5rem;">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Why This Matters for RevFlow</div>
          <div class="callout-content">
            <p>As a B2B revenue intelligence SaaS that integrates deeply with customer Salesforce, Teams, and Zoom environments, SaaS security is a <strong>core business requirement</strong>, not a nice-to-have. Our security architecture prioritizes SaaS visibility and API monitoring over traditional perimeter controls.</p>
            <p>ğŸ‘‰ <strong><a href="../resources/timeline.html#product-configs">Full MDCA Configuration Journey â†’</a></strong></p>
          </div>
        </div>

        <div class="callout success">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>MDCA Portal Quick Reference (December 2025)</div>
          <div class="callout-content">
            <p><strong>Primary Portal:</strong> <code>security.microsoft.com â†’ Cloud Apps</code></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Cloud Discovery:</strong> Shadow IT analysis, app risk scores</li>
              <li><strong>App connectors:</strong> Connected SaaS apps (Salesforce, Zoom, Slack, GitHub, etc.)</li>
              <li><strong>Policies:</strong> Activity policies, anomaly detection, OAuth governance</li>
              <li><strong>Investigation:</strong> Activity log, alerts, files</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Key Evolution (June 2024 â†’ December 2025):</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Portal moved:</strong> portal.cloudappsecurity.com â†’ security.microsoft.com</li>
              <li><strong>App connectors:</strong> ~30 â†’ ~50+ supported apps</li>
              <li><strong>OAuth App Governance:</strong> Now GA</li>
              <li><strong>SaaS Posture Management:</strong> Preview</li>
              <li><strong>CloudAppEvents:</strong> Flows FREE via Defender XDR connector to Sentinel</li>
            </ul>
            <p>ğŸ‘‰ <strong><a href="../resources/timeline.html#ms-evolution">Full Microsoft Platform Evolution â†’</a></strong></p>
          </div>
        </div>

        <div class="callout warning">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>Key Interview Point</div>
          <div class="callout-content">
            <p><strong>XDR SaaS visibility â‰  All SaaS logs</strong></p>
            <p>This distinction wins interviews. Many candidates conflate CASB behavioral monitoring with full SaaS audit log collection. They are complementary but different.</p>
          </div>
        </div>

        <div class="comparison-grid">
          <div class="comparison-card xdr">
            <h4><span class="capability-badge xdr">XDR / CASB</span> Behavioral Monitoring</h4>
            <p><strong>Microsoft Defender for Cloud Apps (MDA)</strong></p>
            <p><strong>What it does:</strong></p>
            <ul>
              <li>Monitors SaaS <em>behavior patterns</em></li>
              <li>Detects risky user actions</li>
              <li>Identifies data exfiltration attempts</li>
              <li>Catches OAuth abuse and shadow IT</li>
              <li>Enforces session controls and policies</li>
            </ul>
            <p><strong>Works best with:</strong></p>
            <ul>
              <li>Microsoft 365 (native integration)</li>
              <li>Select third-party SaaS (API connectors)</li>
              <li>~30 supported apps with full API</li>
            </ul>
            <p><strong>Does NOT provide:</strong></p>
            <ul>
              <li>Complete audit trail of all actions</li>
              <li>Full log retention for compliance</li>
              <li>Coverage for all SaaS apps</li>
            </ul>
          </div>
          
          <div class="comparison-card siem">
            <h4><span class="capability-badge siem">SIEM</span> Full Audit Logs</h4>
            <p><strong>Microsoft Sentinel + Data Connectors</strong></p>
            <p><strong>What it does:</strong></p>
            <ul>
              <li>Collects <em>complete audit logs</em> via APIs</li>
              <li>Provides full event history for forensics</li>
              <li>Enables cross-platform correlation</li>
              <li>Supports compliance retention requirements</li>
              <li>Custom detection rules on raw events</li>
            </ul>
            <p><strong>Covers:</strong></p>
            <ul>
              <li>Any SaaS with API access</li>
              <li>Salesforce, Workday, ServiceNow, etc.</li>
              <li>Custom/niche SaaS applications</li>
            </ul>
            <p><strong>Does NOT provide:</strong></p>
            <ul>
              <li>Real-time session blocking</li>
              <li>Inline policy enforcement</li>
              <li>Shadow IT discovery</li>
            </ul>
          </div>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Interview Answer â€” Memorize This</span></div>
          <pre><code>"SaaS refers to any cloud-hosted application, including third-party platforms 
like Salesforce, not just Azure services. 

In security architecture, there are two complementary approaches:

1. CASB (XDR) â€” Microsoft Defender for Cloud Apps monitors SaaS BEHAVIOR:
   â€¢ Risky user actions, data exfiltration, OAuth abuse
   â€¢ Real-time session controls and policy enforcement
   â€¢ Works great for M365 and supported third-party apps
   â€¢ But it's behavioral alerting, not full audit logs

2. SIEM â€” SaaS audit logs collected via APIs for FULL VISIBILITY:
   â€¢ Complete audit trail for forensics and compliance
   â€¢ Correlation with identity, endpoint, network events
   â€¢ Covers any SaaS with an API, not just supported CASB apps
   â€¢ Custom detections on raw events

They work together: CASB catches risky behavior in real-time, 
SIEM provides the full picture for investigation and compliance."</code></pre>
        </div>

        <!-- ==================== SECTION 2: WHAT IS CASB ==================== -->
        <h2>2. Understanding CASB (Cloud Access Security Broker)</h2>

        <h3>2.1 CASB Definition</h3>

        <p>A <strong>Cloud Access Security Broker (CASB)</strong> is a security policy enforcement point between cloud service consumers and cloud service providers. It provides visibility, compliance, data security, and threat protection for cloud applications.</p>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">CASB Architecture</span></div>
          <pre><code>CASB DEPLOYMENT MODES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                      CASB                                â”‚
                    â”‚         (Microsoft Defender for Cloud Apps)              â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                              â”‚                              â”‚
           â–¼                              â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API MODE          â”‚      â”‚   PROXY MODE        â”‚      â”‚   LOG COLLECTOR     â”‚
â”‚   (Out-of-band)     â”‚      â”‚   (Inline)          â”‚      â”‚   (Discovery)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Connects to SaaS  â”‚      â”‚ â€¢ Reverse proxy for â”‚      â”‚ â€¢ Collects firewall â”‚
â”‚   APIs directly     â”‚      â”‚   managed apps      â”‚      â”‚   /proxy logs       â”‚
â”‚ â€¢ Scans content     â”‚      â”‚ â€¢ Forward proxy via â”‚      â”‚ â€¢ Discovers shadow  â”‚
â”‚ â€¢ Applies policies  â”‚      â”‚   Conditional Accessâ”‚      â”‚   IT usage          â”‚
â”‚ â€¢ No inline control â”‚      â”‚ â€¢ Real-time session â”‚      â”‚ â€¢ Risk scoring      â”‚
â”‚                     â”‚      â”‚   controls          â”‚      â”‚                     â”‚
â”‚ Examples:           â”‚      â”‚ Examples:           â”‚      â”‚ Examples:           â”‚
â”‚ â€¢ Scan SharePoint   â”‚      â”‚ â€¢ Block download on â”‚      â”‚ â€¢ "400 users are    â”‚
â”‚ â€¢ Detect malware    â”‚      â”‚   unmanaged device  â”‚      â”‚    using Dropbox"   â”‚
â”‚ â€¢ Find sensitive    â”‚      â”‚ â€¢ Watermark docs    â”‚      â”‚ â€¢ "50 apps with     â”‚
â”‚   data in OneDrive  â”‚      â”‚ â€¢ Copy/paste block  â”‚      â”‚    OAuth access"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
        </div>

        <h3>2.2 Microsoft Defender for Cloud Apps (MDA) Capabilities</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Capability</th><th>What It Does</th><th>Example Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Shadow IT Discovery</strong></td>
                <td>Analyzes firewall/proxy logs to find unsanctioned apps</td>
                <td>"Discovered 47 employees using personal Dropbox"</td>
              </tr>
              <tr>
                <td><strong>App Governance</strong></td>
                <td>Monitors OAuth apps with access to M365 data</td>
                <td>"Third-party app has Mail.Read permissions for 200 users"</td>
              </tr>
              <tr>
                <td><strong>Session Controls</strong></td>
                <td>Conditional Access App Control for real-time enforcement</td>
                <td>"Block download of sensitive files on unmanaged devices"</td>
              </tr>
              <tr>
                <td><strong>Data Classification</strong></td>
                <td>Scans files in connected apps for sensitive content</td>
                <td>"Found 500 files with credit card numbers in SharePoint"</td>
              </tr>
              <tr>
                <td><strong>Anomaly Detection</strong></td>
                <td>ML-based detection of unusual user behavior</td>
                <td>"Impossible travel: User in NY then London in 30 mins"</td>
              </tr>
              <tr>
                <td><strong>Activity Policies</strong></td>
                <td>Custom rules on user activities</td>
                <td>"Alert when admin shares file externally"</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>2.3 MDA Connected Apps</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">SaaS Apps with Full API Integration</span></div>
          <pre><code>MICROSOFT DEFENDER FOR CLOUD APPS â€” SUPPORTED CONNECTORS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NATIVE/DEEP INTEGRATION (Full visibility + controls):
â”œâ”€â”€ Microsoft 365 (Exchange, SharePoint, OneDrive, Teams)
â”œâ”€â”€ Azure (Activity logs, resources)
â”œâ”€â”€ Power Platform (Power BI, Power Apps)
â””â”€â”€ Dynamics 365

API CONNECTORS (Good visibility, some controls):
â”œâ”€â”€ AWS
â”œâ”€â”€ Google Workspace
â”œâ”€â”€ Salesforce
â”œâ”€â”€ Box
â”œâ”€â”€ Dropbox
â”œâ”€â”€ ServiceNow
â”œâ”€â”€ Okta
â”œâ”€â”€ GitHub
â”œâ”€â”€ Workday (limited)
â”œâ”€â”€ Slack Enterprise
â”œâ”€â”€ Zoom
â”œâ”€â”€ DocuSign
â”œâ”€â”€ Atlassian (Jira, Confluence)
â”œâ”€â”€ Zendesk
â””â”€â”€ ~15 more apps

CONDITIONAL ACCESS APP CONTROL (Proxy-based session controls):
â”œâ”€â”€ Any SAML/OIDC app through Entra ID
â”œâ”€â”€ Works with Conditional Access policies
â”œâ”€â”€ Enables: download blocking, copy/paste restrictions, watermarking
â””â”€â”€ Limited to apps federated with Azure AD

NOT COVERED:
â”œâ”€â”€ Custom internal SaaS apps (unless proxied)
â”œâ”€â”€ SaaS apps not using SSO
â”œâ”€â”€ Apps without API connectors
â””â”€â”€ Consumer versions of apps (personal Gmail, etc.)</code></pre>
        </div>

        <!-- ==================== SECTION: MDCA PORTAL & CONFIGURATION ==================== -->
        <h2>2.4 MDCA Portal & Configuration Deep Dive</h2>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Portal Location â€” Unified Security Portal
          </div>
          <div class="callout-content">
            <p><strong>Microsoft Defender for Cloud Apps is accessed through the unified Microsoft Defender portal:</strong></p>
            <p style="font-size: 1.1rem; margin-top: 0.5rem;"><code>https://security.microsoft.com</code></p>
            <p style="margin-top: 0.5rem;">Previously, MDCA had its own standalone portal at <code>portal.cloudappsecurity.com</code>, but this has been integrated into the unified security portal as of 2023.</p>
          </div>
        </div>

        <h3>Portal Navigation</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDCA Location in Microsoft Defender Portal</span></div>
          <pre><code>MICROSOFT DEFENDER PORTAL (security.microsoft.com)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LEFT NAVIGATION:
â”œâ”€â”€ Home
â”œâ”€â”€ Incidents & alerts
â”‚   â””â”€â”€ Incidents â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cloud Apps incidents appear here
â”œâ”€â”€ Hunting
â”‚   â””â”€â”€ Advanced hunting â†â”€â”€â”€â”€â”€ Query CloudAppEvents table
â”œâ”€â”€ Actions & submissions
â”œâ”€â”€ Threat intelligence
â”œâ”€â”€ Assets
â”‚   â”œâ”€â”€ Devices
â”‚   â”œâ”€â”€ Identities
â”‚   â””â”€â”€ Apps â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ App catalog, OAuth apps, app hygiene
â”œâ”€â”€ ğŸ“ Cloud Apps â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MAIN MDCA SECTION
â”‚   â”œâ”€â”€ Cloud discovery â†â”€â”€â”€â”€â”€â”€ Shadow IT dashboard
â”‚   â”œâ”€â”€ App catalog â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 31,000+ app risk ratings
â”‚   â”œâ”€â”€ App governance â†â”€â”€â”€â”€â”€â”€â”€ OAuth app monitoring
â”‚   â”œâ”€â”€ Policies â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Activity, session, anomaly policies
â”‚   â”œâ”€â”€ Files â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Scanned files from connected apps
â”‚   â”œâ”€â”€ Users â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ User risk profiles
â”‚   â””â”€â”€ Connected apps â†â”€â”€â”€â”€â”€â”€â”€ SALESFORCE, ZOOM, ETC. CONFIGURED HERE
â”œâ”€â”€ Endpoints
â”œâ”€â”€ Email & collaboration
â”œâ”€â”€ Identities
â””â”€â”€ Settings
    â””â”€â”€ Cloud Apps â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MDCA settings & configuration

PERMISSIONS REQUIRED:
â”œâ”€â”€ Global Administrator â€” Full access
â”œâ”€â”€ Security Administrator â€” Full access
â”œâ”€â”€ Security Operator â€” Read + limited actions
â”œâ”€â”€ Security Reader â€” Read-only
â””â”€â”€ Cloud App Security Administrator â€” Full MDCA access</code></pre>
        </div>

        <h3>2.5 Salesforce Connector Setup â€” Step by Step</h3>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Why Salesforce Connector Is Critical for RevFlow
          </div>
          <div class="callout-content">
            <p>As a B2B SaaS platform that integrates with customer Salesforce instances, RevFlow employees have access to Salesforce for:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Sales team:</strong> Managing deals, customer relationships</li>
              <li><strong>Customer Success:</strong> Account management, renewals</li>
              <li><strong>Engineering:</strong> Salesforce API integrations (development/testing)</li>
            </ul>
            <p style="margin-top: 0.5rem;">MDCA Salesforce connector provides visibility into: admin changes, bulk data exports, unusual access patterns, and permission modifications.</p>
          </div>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Salesforce Connector Setup Flow</span></div>
          <pre><code>STEP 1: PREREQUISITES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Salesforce Requirements:
â”œâ”€â”€ Salesforce Enterprise Edition or higher (API access required)
â”œâ”€â”€ Salesforce admin account with "Manage Users" permission
â”œâ”€â”€ API enabled in Salesforce org
â””â”€â”€ Event Monitoring license (for real-time events) â€” OPTIONAL but recommended

Microsoft Requirements:
â”œâ”€â”€ Microsoft 365 E5 OR Microsoft Defender for Cloud Apps license
â”œâ”€â”€ Global Admin or Security Admin role in Entra ID
â””â”€â”€ Access to security.microsoft.com


STEP 2: ENABLE SALESFORCE API ACCESS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

In Salesforce Setup:
1. Setup â†’ Administration â†’ Users â†’ Permission Sets
2. Create or modify permission set with:
   â”œâ”€â”€ "API Enabled" = TRUE
   â”œâ”€â”€ "View All Data" = TRUE (for full visibility)
   â”œâ”€â”€ "View Event Log Files" = TRUE (for monitoring)
   â””â”€â”€ "Manage Users" = TRUE (for governance actions)
3. Assign permission set to MDCA integration user


STEP 3: CREATE CONNECTED APP IN SALESFORCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

In Salesforce Setup:
1. Setup â†’ Platform Tools â†’ Apps â†’ App Manager â†’ New Connected App

   App Name: Microsoft Defender for Cloud Apps
   API Name: Microsoft_Defender_Cloud_Apps
   Contact Email: security-team@revflow.com

2. Enable OAuth Settings:
   â”œâ”€â”€ Callback URL: https://portal.cloudappsecurity.com/api/oauth/saga
   â”‚   (or https://portal.cloudappsecurity.us/api/oauth/saga for US Gov)
   â”œâ”€â”€ Selected OAuth Scopes:
   â”‚   â”œâ”€â”€ Access and manage your data (api)
   â”‚   â”œâ”€â”€ Access your basic information (id, profile, email, address, phone)
   â”‚   â”œâ”€â”€ Perform requests on your behalf at any time (refresh_token, offline_access)
   â”‚   â””â”€â”€ Access Salesforce REST API resources (chatter_api)
   â””â”€â”€ Enable: Require Secret for Web Server Flow

3. Save â†’ Wait 2-10 minutes for propagation
4. Copy: Consumer Key and Consumer Secret


STEP 4: CONNECT SALESFORCE IN MDCA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

In Microsoft Defender Portal (security.microsoft.com):

1. Cloud Apps â†’ Connected apps â†’ App connectors â†’ + Connect an app

2. Select "Salesforce" from the list

3. Instance name: "RevFlow-Production-Salesforce"
   (Use descriptive name if you have multiple Salesforce orgs)

4. Click "Connect Salesforce"
   â”œâ”€â”€ Opens Salesforce OAuth window
   â”œâ”€â”€ Login with Salesforce admin account
   â”œâ”€â”€ Authorize Microsoft Defender for Cloud Apps
   â””â”€â”€ Redirects back to Defender portal

5. Connection status: "Connected" âœ“

6. Wait for initial sync (can take 1-24 hours depending on data volume)


STEP 5: VERIFY CONNECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Check in Defender Portal:

Cloud Apps â†’ Connected apps â†’ Salesforce:
â”œâ”€â”€ Status: Connected âœ“
â”œâ”€â”€ Users discovered: ~500 (RevFlow Salesforce users)
â”œâ”€â”€ Files scanned: ~10,000 (attachments, documents)
â”œâ”€â”€ Last sync: [timestamp]
â””â”€â”€ Permissions: Full (API + Events)

Verify data flowing:
â”œâ”€â”€ Cloud Apps â†’ Activity log â†’ Filter by App = Salesforce
â”œâ”€â”€ Should see: Logins, record views, report exports, admin changes
â””â”€â”€ If empty after 24h, check Salesforce API permissions</code></pre>
        </div>

        <h3>2.6 MDCA Policies for Salesforce</h3>

        <p>Once connected, configure policies to monitor Salesforce activity:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Policy Type</th><th>Policy Name</th><th>Detection</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Activity Policy</strong></td>
                <td>Salesforce bulk data export</td>
                <td>User exports report with >10,000 records</td>
                <td>Alert SOC, require justification</td>
              </tr>
              <tr>
                <td><strong>Activity Policy</strong></td>
                <td>Salesforce admin permission change</td>
                <td>User granted "Modify All Data" permission</td>
                <td>Alert Security, confirm with IT</td>
              </tr>
              <tr>
                <td><strong>Anomaly Detection</strong></td>
                <td>Unusual Salesforce access location</td>
                <td>Login from new country (impossible travel)</td>
                <td>Alert, request MFA re-authentication</td>
              </tr>
              <tr>
                <td><strong>Anomaly Detection</strong></td>
                <td>Mass download from Salesforce</td>
                <td>User downloads significantly more than baseline</td>
                <td>Alert SOC, investigate for data exfiltration</td>
              </tr>
              <tr>
                <td><strong>Activity Policy</strong></td>
                <td>Salesforce API token creation</td>
                <td>New connected app or API token created</td>
                <td>Alert Engineering, verify legitimate integration</td>
              </tr>
              <tr>
                <td><strong>Activity Policy</strong></td>
                <td>Salesforce user role change</td>
                <td>User role changed to System Administrator</td>
                <td>Alert Security, requires approval</td>
              </tr>
              <tr>
                <td><strong>File Policy</strong></td>
                <td>Sensitive data in Salesforce files</td>
                <td>Attachments containing PII/credit cards</td>
                <td>Alert, apply sensitivity label</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Creating an Activity Policy â€” Example</span></div>
          <pre><code>POLICY: SALESFORCE BULK DATA EXPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Location: Cloud Apps â†’ Policies â†’ Policy management â†’ Create policy â†’ Activity policy

POLICY CONFIGURATION:
â”œâ”€â”€ Policy name: Salesforce Bulk Data Export Alert
â”œâ”€â”€ Policy severity: Medium
â”œâ”€â”€ Category: DLP
â”œâ”€â”€ Description: Alert when user exports large amounts of Salesforce data
â”‚
â”œâ”€â”€ FILTERS:
â”‚   â”œâ”€â”€ App equals: Salesforce
â”‚   â”œâ”€â”€ Activity type equals: Export report, Download file, Data export
â”‚   â””â”€â”€ Repeated activity: More than 10 activities in 1 hour
â”‚
â”œâ”€â”€ ALERTS:
â”‚   â”œâ”€â”€ Create an alert for each matching event
â”‚   â”œâ”€â”€ Send alert as email to: soc@revflow.com
â”‚   â”œâ”€â”€ Daily alert limit: 5 (prevent alert fatigue)
â”‚   â””â”€â”€ Alert name template: "Bulk Salesforce export by {{user}}"
â”‚
â””â”€â”€ GOVERNANCE ACTIONS:
    â”œâ”€â”€ Microsoft Entra ID: Require user to sign in again
    â””â”€â”€ Notify user: "Your Salesforce activity triggered a security review"


ADVANCED FILTERS (OPTIONAL):
â”œâ”€â”€ User: Exclude service accounts (integration users)
â”œâ”€â”€ IP address: Exclude known office IPs
â”œâ”€â”€ User groups: Apply only to Sales + Customer Success
â””â”€â”€ Time: Weekdays only (weekend activity more suspicious)</code></pre>
        </div>

        <h3>2.7 Other Critical SaaS Connectors for RevFlow</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>SaaS App</th><th>Why Connected</th><th>Key Detections</th><th>Setup Complexity</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Salesforce</strong></td>
                <td>Core business CRM, customer data</td>
                <td>Bulk exports, admin changes, API abuse</td>
                <td>Medium (OAuth + API permissions)</td>
              </tr>
              <tr>
                <td><strong>Zoom</strong></td>
                <td>Customer meetings, recordings</td>
                <td>Recording downloads, external sharing, admin changes</td>
                <td>Easy (OAuth)</td>
              </tr>
              <tr>
                <td><strong>Slack Enterprise</strong></td>
                <td>Internal communication</td>
                <td>File sharing to external, DLP violations, admin changes</td>
                <td>Easy (OAuth)</td>
              </tr>
              <tr>
                <td><strong>GitHub</strong></td>
                <td>Source code repository</td>
                <td>Public repo creation, secrets in code, external collaborators</td>
                <td>Easy (OAuth)</td>
              </tr>
              <tr>
                <td><strong>Box/Dropbox</strong></td>
                <td>Unsanctioned file storage (detect)</td>
                <td>Shadow IT usage, sensitive file uploads</td>
                <td>Easy (OAuth)</td>
              </tr>
              <tr>
                <td><strong>Okta</strong></td>
                <td>If using Okta for SSO</td>
                <td>Admin changes, suspicious logins, MFA bypass</td>
                <td>Easy (API token)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>2.8 MDCA Integration with Microsoft Sentinel</h3>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Two-Way Integration
          </div>
          <div class="callout-content">
            <p>MDCA and Sentinel have bidirectional integration:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>MDCA â†’ Sentinel:</strong> Alerts and activity logs flow to Sentinel for correlation</li>
              <li><strong>Sentinel â†’ MDCA:</strong> Sentinel can trigger MDCA governance actions via playbooks</li>
            </ul>
          </div>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">MDCA Connector in Sentinel</span></div>
          <pre><code>SENTINEL DATA CONNECTOR: MICROSOFT DEFENDER FOR CLOUD APPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Location: Sentinel â†’ Data connectors â†’ Microsoft Defender for Cloud Apps

WHAT IT INGESTS:
â”œâ”€â”€ CloudAppEvents â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Activity logs from connected apps
â”œâ”€â”€ SecurityAlert â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MDCA alerts (anomaly, policy violations)
â””â”€â”€ McasShadowItReporting â†â”€â”€â”€â”€ Shadow IT discovery data

TABLE: CloudAppEvents (in Sentinel)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TimeGenerated     â”‚ ActionType      â”‚ Application  â”‚ AccountDisplayName    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2024-01-15 09:23  â”‚ FileDownloaded  â”‚ Salesforce   â”‚ john.smith@revflow    â”‚
â”‚ 2024-01-15 09:25  â”‚ ReportExported  â”‚ Salesforce   â”‚ john.smith@revflow    â”‚
â”‚ 2024-01-15 09:30  â”‚ AdminRoleGrantedâ”‚ Salesforce   â”‚ admin@revflow         â”‚
â”‚ 2024-01-15 09:45  â”‚ MeetingRecorded â”‚ Zoom         â”‚ jane.doe@revflow      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


CONFIGURATION STEPS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Go to: Sentinel â†’ Data connectors â†’ Microsoft Defender for Cloud Apps
2. Click "Open connector page"
3. Select data types to ingest:
   â”œâ”€â”€ â˜‘ Alerts (MDCA alerts appear as SecurityAlert)
   â”œâ”€â”€ â˜‘ Discovery logs (Shadow IT reports)
   â””â”€â”€ â˜‘ Cloud App events (CloudAppEvents table)
4. Click "Connect"
5. Verify: Check CloudAppEvents table has data after ~15 minutes


SAMPLE KQL QUERY â€” SALESFORCE ACTIVITY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Salesforce bulk export detection in Sentinel
CloudAppEvents
| where Application == "Salesforce"
| where ActionType in ("ReportExported", "DataExport", "FileDownloaded")
| summarize ExportCount = count(), 
            TotalBytes = sum(tolong(RawEventData.bytes)),
            by AccountDisplayName, bin(TimeGenerated, 1h)
| where ExportCount > 10 or TotalBytes > 100000000  // 100MB
| project TimeGenerated, AccountDisplayName, ExportCount, 
          TotalBytes_MB = TotalBytes / 1000000


// Salesforce admin changes
CloudAppEvents
| where Application == "Salesforce"
| where ActionType has_any ("PermissionSet", "Role", "Profile", "Admin")
| project TimeGenerated, AccountDisplayName, ActionType, 
          ObjectName, IPAddress, City, Country</code></pre>
        </div>

        <h3>2.9 Defender for Cloud (CSPM) vs Defender for Cloud Apps (CASB)</h3>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            Common Interview Confusion â€” Know the Difference!
          </div>
          <div class="callout-content">
            <p>These are two different products with confusingly similar names:</p>
          </div>
        </div>

        <div class="comparison-grid">
          <div class="comparison-card" style="border-left: 3px solid #06b6d4;">
            <h4>Microsoft Defender for Cloud Apps (MDCA)</h4>
            <p><strong>Formerly:</strong> Microsoft Cloud App Security (MCAS)</p>
            <p><strong>Type:</strong> CASB (Cloud Access Security Broker)</p>
            <p><strong>Purpose:</strong> SaaS application security</p>
            <p><strong>Protects:</strong></p>
            <ul>
              <li>Salesforce, Zoom, Slack, Box, etc.</li>
              <li>OAuth apps accessing your data</li>
              <li>Shadow IT discovery</li>
              <li>SaaS user behavior</li>
            </ul>
            <p><strong>Portal:</strong> security.microsoft.com â†’ Cloud Apps</p>
          </div>
          
          <div class="comparison-card" style="border-left: 3px solid #8b5cf6;">
            <h4>Microsoft Defender for Cloud (MDC)</h4>
            <p><strong>Formerly:</strong> Azure Security Center + Azure Defender</p>
            <p><strong>Type:</strong> CSPM + CWPP (Cloud Security Posture Management + Workload Protection)</p>
            <p><strong>Purpose:</strong> Cloud infrastructure security</p>
            <p><strong>Protects:</strong></p>
            <ul>
              <li>Azure VMs, containers, serverless</li>
              <li>AWS and GCP resources (multi-cloud)</li>
              <li>Infrastructure misconfigurations</li>
              <li>Compliance posture (CIS, SOC 2)</li>
            </ul>
            <p><strong>Portal:</strong> portal.azure.com â†’ Defender for Cloud</p>
          </div>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Interview Answer â€” The Two Defenders</span></div>
          <pre><code>"There are two Microsoft products with 'Defender for Cloud' in the name, and 
they protect different things:

DEFENDER FOR CLOUD APPS (CASB):
â€¢ Protects SaaS applications â€” Salesforce, Zoom, Slack, Box
â€¢ Monitors user behavior in cloud apps
â€¢ Discovers shadow IT and OAuth abuse
â€¢ Session controls via Conditional Access
â€¢ Lives in the unified security portal: security.microsoft.com

DEFENDER FOR CLOUD (CSPM/CWPP):
â€¢ Protects cloud INFRASTRUCTURE â€” Azure VMs, AWS EC2, containers
â€¢ Scans for misconfigurations and vulnerabilities
â€¢ Compliance posture management (CIS benchmarks, SOC 2)
â€¢ Workload protection for servers, databases, storage
â€¢ Lives in the Azure portal: portal.azure.com

For RevFlow as a B2B SaaS company:
â€¢ We use MDCA (Cloud Apps) to monitor Salesforce, Zoom, Slack
â€¢ We use MDC (Defender for Cloud) to secure our Azure infrastructure
â€¢ Both are critical â€” SaaS visibility AND cloud security"</code></pre>
        </div>

        <!-- ==================== SECTION 3: XDR + CASB ==================== -->
        <h2>3. How XDR Uses CASB Data</h2>

        <p>Microsoft Defender XDR integrates MDA alerts into its unified incident experience:</p>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">XDR + CASB Integration Flow</span></div>
          <pre><code>XDR CORRELATION WITH CASB ALERTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

USER: john.smith@company.com

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MICROSOFT DEFENDER XDR                                â”‚
â”‚                      (Unified Incident View)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                          â”‚                              â”‚
         â–¼                          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MDE (Endpoint)     â”‚  â”‚  MDI (Identity)     â”‚  â”‚  MDA (Cloud Apps)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 9:00 AM             â”‚  â”‚ 9:05 AM             â”‚  â”‚ 9:15 AM             â”‚
â”‚ Suspicious          â”‚  â”‚ Password spray      â”‚  â”‚ Mass download       â”‚
â”‚ PowerShell          â”‚  â”‚ attempt detected    â”‚  â”‚ from SharePoint     â”‚
â”‚ execution           â”‚  â”‚                     â”‚  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                          â”‚                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CORRELATED INCIDENT              â”‚
                    â”‚  "Compromised User Account"       â”‚
                    â”‚  High Severity                    â”‚
                    â”‚                                   â”‚
                    â”‚  Attack Story:                    â”‚
                    â”‚  1. Credential theft via phishing â”‚
                    â”‚  2. Lateral movement attempts     â”‚
                    â”‚  3. Data exfiltration in progress â”‚
                    â”‚                                   â”‚
                    â”‚  Auto-Response:                   â”‚
                    â”‚  â†’ User session revoked           â”‚
                    â”‚  â†’ Account disabled               â”‚
                    â”‚  â†’ Endpoint isolated              â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
        </div>

        <h3>3.1 MDA Alert Types in XDR</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Alert Category</th><th>Detection Method</th><th>Example Alert</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Impossible Travel</strong></td>
                <td>ML anomaly detection</td>
                <td>"User accessed from US and Germany within 30 minutes"</td>
              </tr>
              <tr>
                <td><strong>Mass Download</strong></td>
                <td>Threshold-based</td>
                <td>"User downloaded 500+ files in 1 hour"</td>
              </tr>
              <tr>
                <td><strong>Risky OAuth App</strong></td>
                <td>App governance</td>
                <td>"High-risk app granted Mail.ReadWrite permissions"</td>
              </tr>
              <tr>
                <td><strong>Ransomware Activity</strong></td>
                <td>Pattern matching</td>
                <td>"Multiple file extensions changed to .encrypted"</td>
              </tr>
              <tr>
                <td><strong>Suspicious Inbox Rules</strong></td>
                <td>Activity policy</td>
                <td>"Inbox rule created to forward emails externally"</td>
              </tr>
              <tr>
                <td><strong>Admin Activity Anomaly</strong></td>
                <td>UEBA baseline</td>
                <td>"First-time admin action: Global Admin added"</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ==================== SECTION 4: SIEM SaaS LOG COLLECTION ==================== -->
        <h2>4. SIEM: Full SaaS Audit Log Collection</h2>

        <p>While CASB monitors behavior, SIEM collects the <strong>complete audit trail</strong> for forensics, compliance, and custom detections.</p>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">SaaS Log Collection Architecture</span></div>
          <pre><code>SIEM SaaS LOG COLLECTION â€” FULL AUDIT VISIBILITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚         MICROSOFT SENTINEL          â”‚
                              â”‚        (Log Analytics Workspace)    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â–²
                                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚                               â”‚
              â–¼                               â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NATIVE CONNECTORS      â”‚     â”‚  API-BASED CONNECTORS   â”‚     â”‚  CUSTOM API INGESTION   â”‚
â”‚  (Microsoft Sources)    â”‚     â”‚  (Third-Party SaaS)     â”‚     â”‚  (Logic Apps/Functions) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚     â”‚                         â”‚     â”‚                         â”‚
â”‚ â€¢ Azure Activity Logs   â”‚     â”‚ â€¢ Salesforce            â”‚     â”‚ â€¢ Any SaaS with API     â”‚
â”‚ â€¢ Azure AD Sign-in Logs â”‚     â”‚ â€¢ AWS CloudTrail        â”‚     â”‚ â€¢ Custom connectors     â”‚
â”‚ â€¢ Azure AD Audit Logs   â”‚     â”‚ â€¢ Google Workspace      â”‚     â”‚ â€¢ Logic App pulls API   â”‚
â”‚ â€¢ Microsoft 365 Logs    â”‚     â”‚ â€¢ Okta                  â”‚     â”‚ â€¢ Azure Function        â”‚
â”‚ â€¢ Defender for Cloud    â”‚     â”‚ â€¢ GitHub                â”‚     â”‚ â€¢ Data Collector API    â”‚
â”‚ â€¢ MDA Alerts            â”‚     â”‚ â€¢ Zoom                  â”‚     â”‚                         â”‚
â”‚                         â”‚     â”‚ â€¢ ServiceNow            â”‚     â”‚ Examples:               â”‚
â”‚ Tables:                 â”‚     â”‚ â€¢ Workday               â”‚     â”‚ â€¢ Workday (full logs)   â”‚
â”‚ â€¢ SigninLogs            â”‚     â”‚                         â”‚     â”‚ â€¢ SAP SuccessFactors    â”‚
â”‚ â€¢ AuditLogs             â”‚     â”‚ Tables:                 â”‚     â”‚ â€¢ Coupa, Concur         â”‚
â”‚ â€¢ OfficeActivity        â”‚     â”‚ â€¢ Salesforce_CL         â”‚     â”‚ â€¢ Custom SaaS apps      â”‚
â”‚ â€¢ CloudAppEvents        â”‚     â”‚ â€¢ AWS_CloudTrail_CL     â”‚     â”‚                         â”‚
â”‚                         â”‚     â”‚ â€¢ GoogleWorkspace_CL    â”‚     â”‚ Table:                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ CustomSaaS_CL         â”‚
                                                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
        </div>

        <h3>4.1 Key SaaS Audit Log Tables in Sentinel</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Table</th><th>Source</th><th>Key Fields</th><th>Use Case</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><code>OfficeActivity</code></td>
                <td>M365 Unified Audit Log</td>
                <td>Operation, UserId, ClientIP, Workload</td>
                <td>SharePoint access, Exchange activity, Teams events</td>
              </tr>
              <tr>
                <td><code>CloudAppEvents</code></td>
                <td>Defender for Cloud Apps</td>
                <td>ActionType, Application, AccountName</td>
                <td>Cross-SaaS activity (MDA connected apps)</td>
              </tr>
              <tr>
                <td><code>SigninLogs</code></td>
                <td>Azure AD / Entra ID</td>
                <td>UserPrincipalName, AppDisplayName, ResultType</td>
                <td>Authentication to all federated SaaS apps</td>
              </tr>
              <tr>
                <td><code>AuditLogs</code></td>
                <td>Azure AD / Entra ID</td>
                <td>OperationName, TargetResources, InitiatedBy</td>
                <td>Directory changes, app consent, role assignments</td>
              </tr>
              <tr>
                <td><code>AWSCloudTrail</code></td>
                <td>AWS (via connector)</td>
                <td>eventName, userIdentity, sourceIPAddress</td>
                <td>AWS API calls, IAM changes, resource access</td>
              </tr>
              <tr>
                <td><code>GWorkspace_*</code></td>
                <td>Google Workspace</td>
                <td>actor.email, event_name, parameters</td>
                <td>Google Drive, Gmail, Admin Console activity</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>4.2 Example: Salesforce Audit Logs in Sentinel</h3>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Logic App â€” Salesforce Event Log Collection</span><button class="code-copy-btn">Copy</button></div>
          <pre><code># Salesforce Event Monitoring (hourly pull)
# Uses Salesforce Event Monitoring API

1. AUTHENTICATE TO SALESFORCE
   POST https://login.salesforce.com/services/oauth2/token
   Body: grant_type=password&client_id=...&client_secret=...&username=...&password=...

2. QUERY EVENT LOG FILES
   GET https://[instance].salesforce.com/services/data/v58.0/query
   Query: SELECT Id, EventType, LogDate, LogFileLength 
          FROM EventLogFile 
          WHERE LogDate = TODAY

3. DOWNLOAD LOG FILE
   GET https://[instance].salesforce.com/services/data/v58.0/sobjects/EventLogFile/{Id}/LogFile

4. PARSE AND SEND TO SENTINEL
   POST https://[workspace-id].ods.opinsights.azure.com/api/logs?api-version=2016-04-01
   Header: Log-Type: Salesforce_EventLog
   Body: [array of log events]

# Captured Salesforce Event Types:
- Login / LoginAs / Logout
- Report / Dashboard / Document
- API / RestApi / BulkApi
- ContentTransfer (file download)
- ApexExecution / ApexTrigger
- ChangeSetOperation</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">KQL â€” Salesforce Anomaly Detection</span><button class="code-copy-btn">Copy</button></div>
          <pre><code>// Detect mass export from Salesforce (report exports > 1000 records)
Salesforce_EventLog_CL
| where EventType_s == "ReportExport"
| where RowsProcessed_d > 1000
| project TimeGenerated, User_s, ReportName_s, RowsProcessed_d, ClientIP_s
| order by RowsProcessed_d desc

// Detect after-hours Salesforce access
Salesforce_EventLog_CL
| where EventType_s == "Login"
| extend Hour = datetime_part("hour", TimeGenerated)
| where Hour < 6 or Hour > 22  // Outside 6 AM - 10 PM
| summarize LoginCount = count() by User_s, bin(TimeGenerated, 1d)
| where LoginCount > 3

// Detect first-time API access (potential token theft)
let known_api_users = Salesforce_EventLog_CL
    | where TimeGenerated between (ago(30d) .. ago(1d))
    | where EventType_s == "API"
    | distinct User_s;
Salesforce_EventLog_CL
| where TimeGenerated > ago(1d)
| where EventType_s == "API"
| where User_s !in (known_api_users)
| project TimeGenerated, User_s, ApiType_s, ClientIP_s</code></pre>
        </div>

        <!-- ==================== SECTION 5: XDR vs SIEM COMPARISON ==================== -->
        <h2>5. XDR vs SIEM for SaaS â€” When to Use Each</h2>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Decision Matrix</span></div>
          <pre><code>SAAS SECURITY: XDR (CASB) vs SIEM â€” WHEN TO USE WHICH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USE CASE                      â”‚  XDR / CASB (MDA)   â”‚  SIEM (Sentinel)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Real-time session blocking    â”‚       âœ…            â”‚       âŒ            â”‚
â”‚  "Block download on BYOD"      â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Shadow IT discovery           â”‚       âœ…            â”‚       âŒ            â”‚
â”‚  "Find unsanctioned apps"      â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OAuth app governance          â”‚       âœ…            â”‚       âš ï¸ Limited    â”‚
â”‚  "Risky third-party apps"      â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Behavioral anomaly detection  â”‚       âœ…            â”‚       âœ…            â”‚
â”‚  "Impossible travel"           â”‚   (Built-in ML)     â”‚   (Custom rules)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Full audit log for forensics  â”‚       âŒ            â”‚       âœ…            â”‚
â”‚  "Show all actions last week"  â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Compliance log retention      â”‚       âŒ            â”‚       âœ…            â”‚
â”‚  "7-year retention for SOX"    â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cross-platform correlation    â”‚       âš ï¸ XDR only  â”‚       âœ…            â”‚
â”‚  "SaaS + on-prem + network"    â”‚                     â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Third-party SaaS visibility   â”‚       âš ï¸ Limited   â”‚       âœ…            â”‚
â”‚  "Workday + SAP + Coupa"       â”‚   (~30 apps)        â”‚   (Any with API)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Custom detection logic        â”‚       âš ï¸ Basic     â”‚       âœ…            â”‚
â”‚  "Complex multi-step rules"    â”‚                     â”‚   (Full KQL)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RECOMMENDATION: Use BOTH
â€¢ CASB (MDA) for real-time controls and behavioral alerts on supported apps
â€¢ SIEM (Sentinel) for full audit logs, forensics, and broader SaaS coverage</code></pre>
        </div>

        <!-- ==================== SECTION 6: DATA FLOW ARCHITECTURE ==================== -->
        <h2>6. Complete SaaS Security Data Flow</h2>

        <div class="saas-flow">
          <pre><code>COMPLETE SAAS SECURITY ARCHITECTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                                    USERS
                                      â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                       â”‚
                          â–¼                       â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  MANAGED    â”‚         â”‚  UNMANAGED  â”‚
                   â”‚  DEVICE     â”‚         â”‚  DEVICE     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚                       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           AZURE AD / ENTRA ID       â”‚
                    â”‚           (Conditional Access)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                  â”‚                  â”‚
                   â–¼                  â–¼                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   MICROSOFT     â”‚ â”‚   THIRD-PARTY   â”‚ â”‚   OTHER SAAS    â”‚
         â”‚   365           â”‚ â”‚   SAAS (CASB)   â”‚ â”‚   (API Only)    â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Exchange        â”‚ â”‚ Salesforce      â”‚ â”‚ Workday         â”‚
         â”‚ SharePoint      â”‚ â”‚ Box             â”‚ â”‚ SAP             â”‚
         â”‚ Teams           â”‚ â”‚ ServiceNow      â”‚ â”‚ Custom Apps     â”‚
         â”‚ OneDrive        â”‚ â”‚ Slack           â”‚ â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                   â”‚                   â”‚
                  â”‚                   â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                    â”‚
    â”‚                  DATA COLLECTION LAYER                             â”‚
    â”‚                                                                    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ CASB (MDA)         â”‚  â”‚ NATIVE CONNECTORS  â”‚  â”‚ LOGIC APPS   â”‚ â”‚
    â”‚  â”‚ â€¢ Behavioral alertsâ”‚  â”‚ â€¢ OfficeActivity   â”‚  â”‚ â€¢ Custom API â”‚ â”‚
    â”‚  â”‚ â€¢ Session controls â”‚  â”‚ â€¢ SigninLogs       â”‚  â”‚   ingestion  â”‚ â”‚
    â”‚  â”‚ â€¢ OAuth governance â”‚  â”‚ â€¢ CloudAppEvents   â”‚  â”‚ â€¢ Workday    â”‚ â”‚
    â”‚  â”‚                    â”‚  â”‚ â€¢ AuditLogs        â”‚  â”‚ â€¢ SAP logs   â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚            â”‚                       â”‚                    â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                       â”‚                    â”‚
                 â–¼                       â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       MICROSOFT SENTINEL                            â”‚
    â”‚                    (Log Analytics Workspace)                        â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚   â”‚CloudAppEventsâ”‚  â”‚OfficeActivityâ”‚  â”‚ SigninLogs â”‚  â”‚CustomSaaS_CLâ”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                                                                     â”‚
    â”‚   ANALYTICS RULES                 WORKBOOKS                         â”‚
    â”‚   â€¢ Impossible travel             â€¢ SaaS Activity Dashboard         â”‚
    â”‚   â€¢ Mass download                 â€¢ OAuth App Inventory             â”‚
    â”‚   â€¢ Suspicious OAuth grant        â€¢ User Risk Timeline              â”‚
    â”‚   â€¢ Cross-SaaS exfiltration       â€¢ Compliance Reports              â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚           SECURITY OPERATIONS        â”‚
                         â”‚                                      â”‚
                         â”‚   â€¢ Unified incident investigation   â”‚
                         â”‚   â€¢ Automated response (SOAR)        â”‚
                         â”‚   â€¢ Threat hunting across SaaS       â”‚
                         â”‚   â€¢ Compliance evidence              â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
        </div>

        <!-- ==================== SECTION 7: INTERVIEW ANSWERS ==================== -->
        <h2>7. Interview-Ready Answers</h2>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "How do you monitor SaaS applications in your security architecture?"</span></div>
          <pre><code>"I use a layered approach combining CASB and SIEM:

LAYER 1: CASB (Microsoft Defender for Cloud Apps)
Real-time behavioral monitoring and controls:
â€¢ Session controls via Conditional Access App Control â€” block downloads 
  on unmanaged devices, apply watermarks
â€¢ Shadow IT discovery â€” analyze proxy logs to find unsanctioned apps
â€¢ OAuth governance â€” monitor and control third-party app permissions
â€¢ Built-in anomaly detection â€” impossible travel, mass downloads

This works great for Microsoft 365 and the ~30 supported third-party 
apps like Salesforce, Box, and ServiceNow.

LAYER 2: SIEM (Sentinel) Full Audit Logs
Complete visibility via API-based log collection:
â€¢ OfficeActivity table for M365 audit logs
â€¢ CloudAppEvents for MDA-connected apps
â€¢ Custom connectors (Logic Apps) for SaaS without native support â€” 
  Workday, SAP, custom apps
â€¢ Full audit trail for forensics and compliance

KEY DISTINCTION:
CASB catches risky BEHAVIOR in real-time. SIEM provides the COMPLETE 
PICTURE for investigation. They're complementary â€” CASB alerts tell 
you something's wrong, SIEM logs tell you exactly what happened.

For example: CASB alerts on 'mass download.' I pivot to Sentinel to 
see exactly which files, correlate with sign-in location, check if 
the same user accessed other SaaS apps, and build the full timeline."</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "What's the difference between CASB and SIEM for SaaS?"</span></div>
          <pre><code>"The key difference is BEHAVIORAL MONITORING vs AUDIT LOG COLLECTION.

CASB (Defender for Cloud Apps):
â€¢ Monitors PATTERNS â€” 'user is downloading a lot of files'
â€¢ Provides CONTROLS â€” 'block download on BYOD'
â€¢ Discovers SHADOW IT â€” 'employees are using Dropbox'
â€¢ Governs OAUTH APPS â€” 'this app has risky permissions'
â€¢ Limited to SUPPORTED APPS (~30 with full API integration)

SIEM (Sentinel):
â€¢ Collects EVERY EVENT â€” 'user downloaded file X at time Y'
â€¢ Provides FULL AUDIT TRAIL â€” 'show me all actions for last 90 days'
â€¢ Enables CUSTOM DETECTIONS â€” complex multi-condition rules in KQL
â€¢ Supports COMPLIANCE â€” 7-year retention for SOX, HIPAA, etc.
â€¢ Covers ANY SAAS with an API â€” not limited to CASB connectors

Real-world example:
CASB alert: 'Suspicious OAuth app granted Mail.Read permission'
SIEM investigation: 
  1. When was consent granted? (AuditLogs)
  2. Which user granted it? (AuditLogs)
  3. What did the app access? (OfficeActivity)
  4. Did the app exfiltrate data? (CloudAppEvents)
  5. Did the user's account show other signs of compromise? (SigninLogs)

That full investigation requires SIEM data, not just the CASB alert."</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "How do you collect logs from SaaS apps that don't have native Sentinel connectors?"</span></div>
          <pre><code>"For SaaS apps without native connectors, I build custom integrations:

1. IDENTIFY THE API
   Most enterprise SaaS has an audit log API. For example:
   â€¢ Workday: REST API for activity logs
   â€¢ SAP SuccessFactors: OData API
   â€¢ Coupa: Reporting API

2. BUILD THE CONNECTOR
   Option A: Logic App (low-code)
   - Timer trigger (hourly)
   - HTTP action to call SaaS API
   - Parse JSON
   - Send to Log Analytics via Data Collector API

   Option B: Azure Function (more control)
   - Python/PowerShell function
   - Handle pagination, rate limits
   - Transform to common schema
   - Write to custom table (e.g., Workday_Audit_CL)

3. DEFINE THE SCHEMA
   I normalize fields to a common format:
   - TimeGenerated, User, Action, Target, SourceIP, Result
   - Makes cross-SaaS correlation easier

4. BUILD DETECTIONS
   Once logs are in Sentinel, I write analytics rules:
   - 'Employee termination in Workday â†’ check for data exfil in M365'
   - 'New vendor in Coupa from unusual country'
   - 'SAP role change outside change window'

The key is treating SaaS logs like any other data source â€” 
normalize, ingest, correlate, detect."</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header"><span class="code-lang">Q: "What is OAuth abuse and how do you detect it?"</span></div>
          <pre><code>"OAuth abuse is when attackers trick users into granting permissions 
to malicious applications, giving them persistent access to corporate 
data without needing credentials.

HOW IT WORKS:
1. Attacker creates a malicious app (or compromises a legitimate one)
2. Sends phishing email: 'Click here to update your calendar'
3. User clicks, sees OAuth consent prompt
4. User clicks 'Allow' without reading permissions
5. App now has Mail.Read, Files.ReadWrite, etc.
6. Attacker exfiltrates data through the app's token

WHY IT'S DANGEROUS:
â€¢ Bypasses MFA â€” app token doesn't require re-authentication
â€¢ Persists through password reset â€” token still valid
â€¢ Legitimate traffic â€” app calls look like normal API usage
â€¢ Hard to detect â€” no failed logins, no malware

DETECTION (CASB + SIEM):

CASB (Defender for Cloud Apps) â€” App Governance:
â€¢ Alerts on high-risk OAuth apps
â€¢ Shows apps with overprivileged permissions
â€¢ Tracks dormant apps with broad access
â€¢ One-click revoke

SIEM (Sentinel) â€” Analytics Rules:
// New OAuth app with sensitive permissions
AuditLogs
| where OperationName == 'Consent to application'
| extend AppName = TargetResources[0].displayName
| extend Permissions = TargetResources[0].modifiedProperties
| where Permissions contains 'Mail.' or Permissions contains 'Files.'
| project TimeGenerated, InitiatedBy.user.userPrincipalName, AppName

// App accessing data outside business hours
CloudAppEvents
| where Application != 'Microsoft 365'
| where ActionType contains 'FileDownload' or ActionType contains 'MailRead'
| extend Hour = datetime_part('hour', TimeGenerated)
| where Hour < 6 or Hour > 22

RESPONSE:
1. Revoke app permissions in Entra ID
2. Revoke user sessions (force re-auth)
3. Audit what data the app accessed
4. Block app ID tenant-wide"</code></pre>
        </div>

        <!-- ==================== SECTION 8: REVFLOW IMPLEMENTATION ==================== -->
        <h2>8. RevFlow SaaS Security Implementation</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>SaaS Category</th><th>Applications</th><th>Collection Method</th><th>Detections</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Productivity</strong></td>
                <td>Microsoft 365 (Exchange, SharePoint, Teams, OneDrive)</td>
                <td>Native connector (OfficeActivity)</td>
                <td>Mass download, external sharing, inbox rules</td>
              </tr>
              <tr>
                <td><strong>Identity</strong></td>
                <td>Azure AD / Entra ID</td>
                <td>Native connector (SigninLogs, AuditLogs)</td>
                <td>Impossible travel, risky sign-in, OAuth consent</td>
              </tr>
              <tr>
                <td><strong>CRM</strong></td>
                <td>Salesforce</td>
                <td>MDA connector + Logic App for Event Logs</td>
                <td>Mass export, login anomaly, API abuse</td>
              </tr>
              <tr>
                <td><strong>ITSM</strong></td>
                <td>ServiceNow</td>
                <td>MDA connector + native Sentinel connector</td>
                <td>Privilege escalation, sensitive record access</td>
              </tr>
              <tr>
                <td><strong>HCM</strong></td>
                <td>Workday</td>
                <td>Custom Logic App (REST API)</td>
                <td>Termination + access correlation, PII access</td>
              </tr>
              <tr>
                <td><strong>Cloud Infra</strong></td>
                <td>AWS</td>
                <td>Native connector (CloudTrail)</td>
                <td>IAM changes, S3 exposure, unusual region</td>
              </tr>
              <tr>
                <td><strong>DevOps</strong></td>
                <td>GitHub Enterprise</td>
                <td>Native connector</td>
                <td>Public repo, secrets in code, unusual clone</td>
              </tr>
            </tbody>
          </table>
        </div>

        <nav class="page-nav">
          <a href="cost-optimization.html" class="page-nav-link prev"><span class="page-nav-label">Previous</span><span class="page-nav-title">â† Cost Optimization</span></a>
          <a href="soc-transition.html" class="page-nav-link next"><span class="page-nav-label">Next</span><span class="page-nav-title">SOC Transition â†’</span></a>
        </nav>
      </div>
    </main>
  </div>
  <script src="../js/main.js"></script>
</body>
</html>
