<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Threat Intelligence Integration | Custom TI Sources & Vulnerability Prioritization</title>
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .concept-card {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.02));
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    
    .flow-diagram {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      overflow-x: auto;
      white-space: pre;
      line-height: 1.4;
    }
    
    .code-block {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
      overflow-x: auto;
    }
    
    .code-block .comment {
      color: #6b7280;
    }
    
    .code-block .keyword {
      color: #8b5cf6;
    }
    
    .code-block .function {
      color: #22c55e;
    }
    
    .code-block .string {
      color: #f59e0b;
    }
    
    .code-block .field {
      color: #06b6d4;
    }
    
    .code-block .number {
      color: #ec4899;
    }
    
    .pattern-box {
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .pattern-box h4 {
      color: #22c55e;
      margin-top: 0;
    }
    
    .warning-box {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .warning-box h4 {
      color: #ef4444;
      margin-top: 0;
    }
    
    .info-box {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .info-box h4 {
      color: #3b82f6;
      margin-top: 0;
    }
    
    .tip-box {
      background: rgba(234, 179, 8, 0.1);
      border: 1px solid rgba(234, 179, 8, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1rem 0;
    }
    
    .tip-box h4 {
      color: #eab308;
      margin-top: 0;
    }
    
    .two-column {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 1.5rem;
    }
    
    .three-column {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }
    
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    .comparison-table th {
      background: rgba(239, 68, 68, 0.2);
      padding: 0.75rem;
      text-align: left;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .comparison-table td {
      padding: 0.75rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      vertical-align: top;
    }
    
    .comparison-table tr:nth-child(even) {
      background: rgba(0, 0, 0, 0.2);
    }
    
    .stage-header {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(239, 68, 68, 0.1));
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin: 2rem 0 1rem 0;
      border-left: 4px solid #ef4444;
    }
    
    .stage-header h2 {
      margin: 0;
      color: #ef4444;
    }
    
    .stage-header p {
      margin: 0.5rem 0 0 0;
      color: var(--text-secondary);
    }
    
    details {
      margin: 1rem 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    
    details summary {
      background: rgba(239, 68, 68, 0.1);
      padding: 0.75rem 1rem;
      cursor: pointer;
      font-weight: 600;
    }
    
    details summary:hover {
      background: rgba(239, 68, 68, 0.15);
    }
    
    details[open] summary {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    details .details-content {
      padding: 1rem;
    }
    
    .architecture-step {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin: 1rem 0;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
    }
    
    .step-number {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    .step-content {
      flex: 1;
    }
    
    .step-content h4 {
      margin: 0 0 0.5rem 0;
      color: #ef4444;
    }
    
    .scoring-formula {
      background: rgba(139, 92, 246, 0.1);
      border: 2px solid rgba(139, 92, 246, 0.3);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
      text-align: center;
    }
    
    .scoring-formula h4 {
      color: #8b5cf6;
      margin-top: 0;
    }
    
    .scoring-formula .formula {
      font-family: 'Courier New', monospace;
      font-size: 1.1rem;
      color: #22c55e;
      margin: 1rem 0;
    }
    
    .timeline-badge {
      display: inline-block;
      background: rgba(59, 130, 246, 0.2);
      border: 1px solid rgba(59, 130, 246, 0.4);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      margin-right: 0.5rem;
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
          <a href="../controls-mapping.html" class="nav-item">Controls Mapping</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/parsing-deep-dive.html" class="nav-item">Parsing Deep Dive</a>
          <a href="../siem/parsing-normalization-overview.html" class="nav-item">Parsing Overview</a>
          <a href="../siem/sentinel-parsing-deep-dive.html" class="nav-item">Sentinel Parsing</a>
          <a href="../siem/splunk-parsing-deep-dive.html" class="nav-item">Splunk Parsing</a>
          <a href="../siem/parsing-patterns-comparison.html" class="nav-item">Parsing Comparison</a>
          <a href="../siem/threat-intelligence.html" class="nav-item">Threat Intelligence</a>
          <a href="../siem/threat-intel-integration.html" class="nav-item active">TI Integration</a>
          <a href="../siem/vuln-management-workflow.html" class="nav-item">Vuln Management</a>
          <a href="../siem/detection-engineering.html" class="nav-item">Detection Engineering</a>
          <a href="../siem/detection-anatomy.html" class="nav-item">Detection Anatomy</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soar-automation.html" class="nav-item">SOAR &amp; Automation</a>
          <a href="../siem/workbooks.html" class="nav-item">Workbooks &amp; Dashboards</a>
          <a href="../siem/cost-optimization.html" class="nav-item">Cost Optimization</a>
          <a href="../siem/casb-saas-security.html" class="nav-item">CASB &amp; SaaS Security</a>
          <a href="../siem/soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/xdr-detection-model.html" class="nav-item">XDR Detection Model</a>
          <a href="../edr/advanced-hunting.html" class="nav-item">Advanced Hunting</a>
          <a href="../edr/live-response.html" class="nav-item">Live Response</a>
          <a href="../edr/tvm.html" class="nav-item">Vulnerability Management</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/device-control.html" class="nav-item">Device Control</a>
          <a href="../edr/compensating-controls.html" class="nav-item">Compensating Controls</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/dlp-catalog.html" class="nav-item">DLP Catalog</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/infrastructure-reference.html" class="nav-item">Infrastructure Reference</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
          <a href="../resources/alternative-architectures.html" class="nav-item">Alternative Architectures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep (Full)</a>
          <a href="../interview-prep-v2.html" class="nav-item">Interview Prep v2</a>
          <a href="../interview-technical-reference.html" class="nav-item">Technical Reference</a>
          <a href="../interview-frameworks.html" class="nav-item">Mental Frameworks</a>
          <a href="../director-interview-prep.html" class="nav-item">Director Interview Prep</a>
          <a href="../soc-maturity.html" class="nav-item">SOC Maturity Roadmap</a>
          <a href="../security-mental-model.html" class="nav-item">Security Mental Model</a>
          <a href="../ai-security-risk.html" class="nav-item">AI Security & Risk</a>
        </div>
      </nav>
    </aside>
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>
    <div class="sidebar-overlay"></div>
    <main class="main-content">
      <div class="content-wrapper">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Threat Intel Integration</span>
        </nav>
        <h1>Threat Intelligence Integration</h1>
        <p class="section-description">Custom TI sources, vulnerability prioritization, and risk-based alerting</p>
      </div>

      <!-- ==================== ARCHITECTURE OVERVIEW ==================== -->
      <section id="architecture">
        <div class="concept-card">
          <h2>ğŸ—ï¸ Integration Architecture Overview</h2>
          
          <div class="flow-diagram">
<span style="color: #ef4444; font-weight: bold;">THREAT INTELLIGENCE INTEGRATION ARCHITECTURE</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #f59e0b;">EXTERNAL THREAT INTEL SOURCES</span>                                    â”‚
â”‚                                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    EPSS     â”‚  â”‚  CISA KEV   â”‚  â”‚   Qualys    â”‚  â”‚  AbuseIPDB  â”‚  â”‚ AlienVault  â”‚  â”‚  VirusTotal â”‚ â”‚
â”‚  â”‚ (CVE Risk)  â”‚  â”‚ (Exploited) â”‚  â”‚   (Vulns)   â”‚  â”‚ (IP Repute) â”‚  â”‚    OTX      â”‚  â”‚  (Hashes)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                â”‚                â”‚                â”‚                â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚                â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼                â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #22c55e;">INGESTION LAYER</span>                                                   â”‚
â”‚                                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              Azure Functions (Python/PowerShell)                                 â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚ func-epss-sync  â”‚  â”‚ func-kev-sync   â”‚  â”‚ func-qualys-syncâ”‚  â”‚ func-iprepute   â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ (Daily 6 AM)    â”‚  â”‚ (Daily 7 AM)    â”‚  â”‚ (Daily 8 AM)    â”‚  â”‚ (Every 4 hours) â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚           â”‚                    â”‚                    â”‚                    â”‚                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â”‚                    â”‚                    â”‚                    â”‚                          â”‚
â”‚              â–¼                    â–¼                    â–¼                    â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              Azure Blob Storage (Staging)                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚
â”‚  â”‚  â”‚ epss.json   â”‚  â”‚ kev.json    â”‚  â”‚ qualys.json â”‚  â”‚ iprepute.csvâ”‚  â”‚ otx_iocs.jsonâ”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #8b5cf6;">LOG ANALYTICS INGESTION</span>                                          â”‚
â”‚                                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Data Collection Rules (DCR) + Log Ingestion API                               â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚  Azure Function â†’ HTTP POST â†’ DCE Endpoint â†’ DCR Transform â†’ Custom Table                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚                                                          â”‚
â”‚                                              â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              Custom Tables (Log Analytics)                                       â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚  â”‚ EPSS_Scores_CL   â”‚  â”‚ CISA_KEV_CL      â”‚  â”‚ Qualys_Vulns_CL  â”‚  â”‚ IPReputation_CL  â”‚         â”‚  â”‚
â”‚  â”‚  â”‚ (CVE, Score,     â”‚  â”‚ (CVE, Vendor,    â”‚  â”‚ (QID, CVE,       â”‚  â”‚ (IP, Score,      â”‚         â”‚  â”‚
â”‚  â”‚  â”‚  Percentile)     â”‚  â”‚  Product, Date)  â”‚  â”‚  Severity, Host) â”‚  â”‚  Source, Type)   â”‚         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #06b6d4;">INTERNAL DATA SOURCES</span>                                             â”‚
â”‚                                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Microsoft TVM    â”‚  â”‚ Asset Inventory  â”‚  â”‚ SecurityEvent    â”‚  â”‚ SigninLogs       â”‚                â”‚
â”‚  â”‚ (DeviceTvmSoft.. â”‚  â”‚ (Watchlist)      â”‚  â”‚ (Windows Events) â”‚  â”‚ (Entra ID)       â”‚                â”‚
â”‚  â”‚  wareVulnerab..) â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    <span style="color: #ef4444;">CORRELATION & ALERTING</span>                                            â”‚
â”‚                                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              Sentinel Analytics Rules                                            â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚ Rule: Critical Vulnerability on High-Value Asset                                        â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                                                         â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ TVM Vulns + EPSS (>0.7) + CISA KEV + Asset Criticality = Custom Risk Score            â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                                                         â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ IF RiskScore > 85 AND AssetCriticality = "Critical" â†’ High Severity Alert             â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚ Rule: Connection to Known Malicious IP                                                  â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                                                         â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ Network Logs + IPReputation_CL (Score > 80) â†’ Alert with TI Context                    â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </div>
        </div>

        <div class="concept-card">
          <h3>Key Components</h3>
          
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Component</th>
                <th>Purpose</th>
                <th>Technology</th>
                <th>Schedule</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Azure Functions</strong></td>
                <td>Fetch data from external TI APIs</td>
                <td>Python 3.11 / PowerShell</td>
                <td>Timer triggers (configurable)</td>
              </tr>
              <tr>
                <td><strong>Blob Storage</strong></td>
                <td>Stage data before ingestion, caching</td>
                <td>Azure Storage Account</td>
                <td>Intermediate storage</td>
              </tr>
              <tr>
                <td><strong>Log Ingestion API</strong></td>
                <td>Push data to Log Analytics</td>
                <td>DCE + DCR</td>
                <td>Called by Azure Functions</td>
              </tr>
              <tr>
                <td><strong>Custom Tables</strong></td>
                <td>Store TI data for queries</td>
                <td>Log Analytics _CL tables</td>
                <td>Queryable immediately</td>
              </tr>
              <tr>
                <td><strong>Watchlists</strong></td>
                <td>Asset inventory, allow/block lists</td>
                <td>Sentinel Watchlists</td>
                <td>Updated weekly</td>
              </tr>
              <tr>
                <td><strong>Analytics Rules</strong></td>
                <td>Correlate TI with logs, alert</td>
                <td>KQL Scheduled Rules</td>
                <td>Every 5-15 minutes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- ==================== USE CASE 1: VULNERABILITY PRIORITIZATION ==================== -->
      <section id="use-case-1">
        <div class="stage-header">
          <h2>ğŸ¯ Use Case 1: Risk-Based Vulnerability Prioritization</h2>
          <p>Merge TVM + Qualys + EPSS + CISA KEV + Asset Criticality â†’ Custom Risk Score â†’ Alert on Critical</p>
        </div>

        <div class="concept-card">
          <h3>Business Problem</h3>
          <p>Organizations face thousands of vulnerabilities daily. Without prioritization:</p>
          <ul>
            <li>Teams chase CVSSv3 "Critical" scores that may never be exploited</li>
            <li>Actively exploited vulnerabilities get lost in the noise</li>
            <li>No consideration for asset business criticality</li>
            <li>Multiple scanners (TVM, Qualys) create duplicate findings</li>
          </ul>
          
          <div class="scoring-formula">
            <h4>Custom Risk Score Formula</h4>
            <div class="formula">
              RiskScore = (CVSS Ã— 0.15) + (EPSS Ã— 100 Ã— 0.30) + (KEV Ã— 30) + (QualysTruRisk Ã— 0.15) + (AssetCriticality Ã— 0.10)
            </div>
            <p style="margin-top: 1rem; font-size: 0.9rem;">
              <strong>Weights:</strong> EPSS (30%) prioritizes exploitability, KEV (+30 points) flags active exploitation, 
              Asset criticality ensures business context.
            </p>
          </div>
        </div>
      </section>

      <!-- ==================== EPSS INTEGRATION ==================== -->
      <section id="epss">
        <div class="stage-header">
          <h2>ğŸ“Š Step 1: EPSS Integration</h2>
          <p>Exploit Prediction Scoring System â€” probability a CVE will be exploited in the wild</p>
        </div>

        <div class="concept-card">
          <h3>What is EPSS?</h3>
          <div class="info-box">
            <h4>EPSS (Exploit Prediction Scoring System)</h4>
            <ul>
              <li><strong>Provider:</strong> FIRST.org (same organization behind CVSS)</li>
              <li><strong>URL:</strong> <code>https://api.first.org/data/v1/epss</code></li>
              <li><strong>Update Frequency:</strong> Daily</li>
              <li><strong>Data:</strong> CVE ID, EPSS Score (0-1), Percentile</li>
              <li><strong>Value:</strong> Predicts probability of exploitation in next 30 days</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Example:</strong> CVE-2024-1234 with EPSS 0.85 means 85% probability of being exploited â€” far more actionable than CVSS alone.</p>
          </div>
        </div>

        <div class="concept-card">
          <h3>Azure Function: EPSS Sync</h3>
          
          <div class="architecture-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>Create Azure Function App</h4>
              <p>Python 3.11 runtime, Consumption plan, System-assigned managed identity</p>
            </div>
          </div>

          <details>
            <summary><strong>func-epss-sync/function.json</strong></summary>
            <div class="details-content">
              <div class="code-block">
{
  "<span class="field">scriptFile</span>": "<span class="string">__init__.py</span>",
  "<span class="field">bindings</span>": [
    {
      "<span class="field">name</span>": "<span class="string">timer</span>",
      "<span class="field">type</span>": "<span class="string">timerTrigger</span>",
      "<span class="field">direction</span>": "<span class="string">in</span>",
      "<span class="field">schedule</span>": "<span class="string">0 0 6 * * *</span>"  <span class="comment">// Daily at 6 AM UTC</span>
    }
  ]
}
              </div>
            </div>
          </details>

          <details>
            <summary><strong>func-epss-sync/__init__.py (Complete Code)</strong></summary>
            <div class="details-content">
              <div class="code-block">
<span class="keyword">import</span> azure.functions <span class="keyword">as</span> func
<span class="keyword">import</span> requests
<span class="keyword">import</span> json
<span class="keyword">import</span> os
<span class="keyword">import</span> logging
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone
<span class="keyword">from</span> azure.identity <span class="keyword">import</span> DefaultAzureCredential
<span class="keyword">from</span> azure.monitor.ingestion <span class="keyword">import</span> LogsIngestionClient

<span class="comment"># Configuration from environment variables</span>
DCE_ENDPOINT = os.environ[<span class="string">"DCE_ENDPOINT"</span>]  <span class="comment"># e.g., https://dce-xxx.eastus.ingest.monitor.azure.com</span>
DCR_IMMUTABLE_ID = os.environ[<span class="string">"DCR_EPSS_IMMUTABLE_ID"</span>]  <span class="comment"># e.g., dcr-xxx</span>
STREAM_NAME = <span class="string">"Custom-EPSS_Scores_CL"</span>

<span class="keyword">def</span> <span class="function">main</span>(timer: func.TimerRequest) -> <span class="keyword">None</span>:
    logging.info(<span class="string">'EPSS sync function started'</span>)
    
    <span class="comment"># Step 1: Fetch EPSS data from FIRST.org API</span>
    epss_url = <span class="string">"https://api.first.org/data/v1/epss?envelope=true"</span>
    
    <span class="keyword">try</span>:
        <span class="comment"># EPSS API returns all CVEs with scores</span>
        <span class="comment"># For efficiency, we filter to scores > 0.1 (top 10% exploitability)</span>
        response = requests.get(epss_url, timeout=<span class="number">300</span>)
        response.raise_for_status()
        data = response.json()
        
        epss_records = []
        timestamp = datetime.now(timezone.utc).isoformat()
        
        <span class="keyword">for</span> item <span class="keyword">in</span> data.get(<span class="string">"data"</span>, []):
            score = <span class="function">float</span>(item.get(<span class="string">"epss"</span>, <span class="number">0</span>))
            
            <span class="comment"># Only ingest CVEs with meaningful exploit probability</span>
            <span class="keyword">if</span> score >= <span class="number">0.1</span>:  <span class="comment"># Top 10% most likely to be exploited</span>
                epss_records.append({
                    <span class="string">"TimeGenerated"</span>: timestamp,
                    <span class="string">"CVE_ID"</span>: item.get(<span class="string">"cve"</span>),
                    <span class="string">"EPSS_Score"</span>: score,
                    <span class="string">"EPSS_Percentile"</span>: <span class="function">float</span>(item.get(<span class="string">"percentile"</span>, <span class="number">0</span>)),
                    <span class="string">"DataSource"</span>: <span class="string">"FIRST.org EPSS"</span>,
                    <span class="string">"LastUpdated"</span>: item.get(<span class="string">"date"</span>, timestamp)
                })
        
        logging.info(<span class="string">f'Fetched {len(epss_records)} high-risk EPSS records'</span>)
        
        <span class="comment"># Step 2: Ingest to Log Analytics using DCR</span>
        <span class="keyword">if</span> epss_records:
            credential = DefaultAzureCredential()
            client = LogsIngestionClient(
                endpoint=DCE_ENDPOINT,
                credential=credential,
                logging_enable=<span class="keyword">True</span>
            )
            
            <span class="comment"># Upload in batches of 10,000 (API limit)</span>
            batch_size = <span class="number">10000</span>
            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">0</span>, <span class="function">len</span>(epss_records), batch_size):
                batch = epss_records[i:i + batch_size]
                client.upload(
                    rule_id=DCR_IMMUTABLE_ID,
                    stream_name=STREAM_NAME,
                    logs=batch
                )
                logging.info(<span class="string">f'Uploaded batch {i//batch_size + 1}'</span>)
            
            logging.info(<span class="string">f'Successfully ingested {len(epss_records)} EPSS records'</span>)
    
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        logging.error(<span class="string">f'EPSS sync failed: {str(e)}'</span>)
        <span class="keyword">raise</span>
              </div>
            </div>
          </details>

          <details>
            <summary><strong>DCR Configuration for EPSS Table</strong></summary>
            <div class="details-content">
              <div class="code-block">
<span class="comment">// ARM Template snippet for DCR</span>
{
  "<span class="field">type</span>": "<span class="string">Microsoft.Insights/dataCollectionRules</span>",
  "<span class="field">apiVersion</span>": "<span class="string">2022-06-01</span>",
  "<span class="field">name</span>": "<span class="string">dcr-epss-ingestion</span>",
  "<span class="field">location</span>": "<span class="string">[resourceGroup().location]</span>",
  "<span class="field">properties</span>": {
    "<span class="field">streamDeclarations</span>": {
      "<span class="field">Custom-EPSS_Scores_CL</span>": {
        "<span class="field">columns</span>": [
          { "<span class="field">name</span>": "<span class="string">TimeGenerated</span>", "<span class="field">type</span>": "<span class="string">datetime</span>" },
          { "<span class="field">name</span>": "<span class="string">CVE_ID</span>", "<span class="field">type</span>": "<span class="string">string</span>" },
          { "<span class="field">name</span>": "<span class="string">EPSS_Score</span>", "<span class="field">type</span>": "<span class="string">real</span>" },
          { "<span class="field">name</span>": "<span class="string">EPSS_Percentile</span>", "<span class="field">type</span>": "<span class="string">real</span>" },
          { "<span class="field">name</span>": "<span class="string">DataSource</span>", "<span class="field">type</span>": "<span class="string">string</span>" },
          { "<span class="field">name</span>": "<span class="string">LastUpdated</span>", "<span class="field">type</span>": "<span class="string">string</span>" }
        ]
      }
    },
    "<span class="field">destinations</span>": {
      "<span class="field">logAnalytics</span>": [
        {
          "<span class="field">workspaceResourceId</span>": "<span class="string">[parameters('workspaceResourceId')]</span>",
          "<span class="field">name</span>": "<span class="string">la-destination</span>"
        }
      ]
    },
    "<span class="field">dataFlows</span>": [
      {
        "<span class="field">streams</span>": ["<span class="string">Custom-EPSS_Scores_CL</span>"],
        "<span class="field">destinations</span>": ["<span class="string">la-destination</span>"],
        "<span class="field">transformKql</span>": "<span class="string">source</span>",
        "<span class="field">outputStream</span>": "<span class="string">Custom-EPSS_Scores_CL</span>"
      }
    ]
  }
}
              </div>
            </div>
          </details>
        </div>
      </section>

      <!-- ==================== CISA KEV INTEGRATION ==================== -->
      <section id="cisa-kev">
        <div class="stage-header">
          <h2>ğŸš¨ Step 2: CISA KEV Integration</h2>
          <p>Known Exploited Vulnerabilities catalog â€” CVEs actively being exploited in the wild</p>
        </div>

        <div class="concept-card">
          <h3>What is CISA KEV?</h3>
          <div class="warning-box">
            <h4>CISA Known Exploited Vulnerabilities (KEV)</h4>
            <ul>
              <li><strong>Provider:</strong> US Cybersecurity and Infrastructure Security Agency</li>
              <li><strong>URL:</strong> <code>https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json</code></li>
              <li><strong>Update Frequency:</strong> As new exploited vulnerabilities are discovered</li>
              <li><strong>Data:</strong> CVE, Vendor, Product, Vulnerability Name, Date Added, Due Date</li>
              <li><strong>Value:</strong> Authoritative list of vulnerabilities being actively exploited</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>If a CVE is in KEV, it's being exploited NOW â€” highest priority!</strong></p>
          </div>
        </div>

        <details>
          <summary><strong>func-kev-sync/__init__.py (Complete Code)</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="keyword">import</span> azure.functions <span class="keyword">as</span> func
<span class="keyword">import</span> requests
<span class="keyword">import</span> json
<span class="keyword">import</span> os
<span class="keyword">import</span> logging
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone
<span class="keyword">from</span> azure.identity <span class="keyword">import</span> DefaultAzureCredential
<span class="keyword">from</span> azure.monitor.ingestion <span class="keyword">import</span> LogsIngestionClient

DCE_ENDPOINT = os.environ[<span class="string">"DCE_ENDPOINT"</span>]
DCR_IMMUTABLE_ID = os.environ[<span class="string">"DCR_KEV_IMMUTABLE_ID"</span>]
STREAM_NAME = <span class="string">"Custom-CISA_KEV_CL"</span>

KEV_URL = <span class="string">"https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"</span>

<span class="keyword">def</span> <span class="function">main</span>(timer: func.TimerRequest) -> <span class="keyword">None</span>:
    logging.info(<span class="string">'CISA KEV sync function started'</span>)
    
    <span class="keyword">try</span>:
        <span class="comment"># Fetch KEV catalog</span>
        response = requests.get(KEV_URL, timeout=<span class="number">60</span>)
        response.raise_for_status()
        data = response.json()
        
        kev_records = []
        timestamp = datetime.now(timezone.utc).isoformat()
        catalog_version = data.get(<span class="string">"catalogVersion"</span>, <span class="string">"unknown"</span>)
        
        <span class="keyword">for</span> vuln <span class="keyword">in</span> data.get(<span class="string">"vulnerabilities"</span>, []):
            kev_records.append({
                <span class="string">"TimeGenerated"</span>: timestamp,
                <span class="string">"CVE_ID"</span>: vuln.get(<span class="string">"cveID"</span>),
                <span class="string">"VendorProject"</span>: vuln.get(<span class="string">"vendorProject"</span>),
                <span class="string">"Product"</span>: vuln.get(<span class="string">"product"</span>),
                <span class="string">"VulnerabilityName"</span>: vuln.get(<span class="string">"vulnerabilityName"</span>),
                <span class="string">"DateAdded"</span>: vuln.get(<span class="string">"dateAdded"</span>),
                <span class="string">"ShortDescription"</span>: vuln.get(<span class="string">"shortDescription"</span>),
                <span class="string">"RequiredAction"</span>: vuln.get(<span class="string">"requiredAction"</span>),
                <span class="string">"DueDate"</span>: vuln.get(<span class="string">"dueDate"</span>),
                <span class="string">"KnownRansomwareCampaignUse"</span>: vuln.get(<span class="string">"knownRansomwareCampaignUse"</span>, <span class="string">"Unknown"</span>),
                <span class="string">"Notes"</span>: vuln.get(<span class="string">"notes"</span>, <span class="string">""</span>),
                <span class="string">"CatalogVersion"</span>: catalog_version,
                <span class="string">"IsInKEV"</span>: <span class="keyword">True</span>  <span class="comment"># Flag for easy join</span>
            })
        
        logging.info(<span class="string">f'Fetched {len(kev_records)} KEV records'</span>)
        
        <span class="comment"># Ingest to Log Analytics</span>
        <span class="keyword">if</span> kev_records:
            credential = DefaultAzureCredential()
            client = LogsIngestionClient(
                endpoint=DCE_ENDPOINT,
                credential=credential
            )
            
            client.upload(
                rule_id=DCR_IMMUTABLE_ID,
                stream_name=STREAM_NAME,
                logs=kev_records
            )
            
            logging.info(<span class="string">f'Successfully ingested {len(kev_records)} KEV records'</span>)
    
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        logging.error(<span class="string">f'KEV sync failed: {str(e)}'</span>)
        <span class="keyword">raise</span>
            </div>
          </div>
        </details>
      </section>

      <!-- ==================== QUALYS INTEGRATION ==================== -->
      <section id="qualys">
        <div class="stage-header">
          <h2>ğŸ” Step 3: Qualys Integration</h2>
          <p>Enterprise vulnerability scanner data with TruRisk scores</p>
        </div>

        <div class="concept-card">
          <h3>Qualys API Integration</h3>
          
          <div class="info-box">
            <h4>Qualys VMDR API</h4>
            <ul>
              <li><strong>API Base:</strong> <code>https://qualysapi.qualys.com</code> (varies by subscription)</li>
              <li><strong>Authentication:</strong> API username/password â†’ Basic Auth</li>
              <li><strong>Key Endpoints:</strong></li>
              <ul>
                <li><code>/api/2.0/fo/asset/host/vm/detection/</code> â€” Host vulnerabilities</li>
                <li><code>/api/2.0/fo/knowledge_base/vuln/</code> â€” Vulnerability details</li>
              </ul>
              <li><strong>TruRisk:</strong> Qualys's risk scoring that factors in EPSS, asset criticality, and threat intel</li>
            </ul>
          </div>
        </div>

        <details>
          <summary><strong>func-qualys-sync/__init__.py (Complete Code)</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="keyword">import</span> azure.functions <span class="keyword">as</span> func
<span class="keyword">import</span> requests
<span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET
<span class="keyword">import</span> os
<span class="keyword">import</span> logging
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone
<span class="keyword">from</span> azure.identity <span class="keyword">import</span> DefaultAzureCredential
<span class="keyword">from</span> azure.monitor.ingestion <span class="keyword">import</span> LogsIngestionClient
<span class="keyword">from</span> azure.keyvault.secrets <span class="keyword">import</span> SecretClient

DCE_ENDPOINT = os.environ[<span class="string">"DCE_ENDPOINT"</span>]
DCR_IMMUTABLE_ID = os.environ[<span class="string">"DCR_QUALYS_IMMUTABLE_ID"</span>]
STREAM_NAME = <span class="string">"Custom-Qualys_Vulns_CL"</span>
KEY_VAULT_URL = os.environ[<span class="string">"KEY_VAULT_URL"</span>]
QUALYS_API_URL = os.environ[<span class="string">"QUALYS_API_URL"</span>]  <span class="comment"># e.g., https://qualysapi.qualys.com</span>

<span class="keyword">def</span> <span class="function">get_qualys_credentials</span>():
    <span class="string">"""Retrieve Qualys credentials from Key Vault"""</span>
    credential = DefaultAzureCredential()
    secret_client = SecretClient(vault_url=KEY_VAULT_URL, credential=credential)
    
    username = secret_client.get_secret(<span class="string">"qualys-api-username"</span>).value
    password = secret_client.get_secret(<span class="string">"qualys-api-password"</span>).value
    
    <span class="keyword">return</span> username, password

<span class="keyword">def</span> <span class="function">fetch_qualys_detections</span>(username, password):
    <span class="string">"""Fetch host vulnerability detections from Qualys"""</span>
    
    url = <span class="string">f"{QUALYS_API_URL}/api/2.0/fo/asset/host/vm/detection/"</span>
    
    <span class="comment"># Parameters to filter recent high-severity vulns</span>
    params = {
        <span class="string">"action"</span>: <span class="string">"list"</span>,
        <span class="string">"show_results"</span>: <span class="string">"1"</span>,
        <span class="string">"severities"</span>: <span class="string">"4,5"</span>,  <span class="comment"># High and Critical only</span>
        <span class="string">"status"</span>: <span class="string">"New,Active,Re-Opened"</span>,
        <span class="string">"detection_updated_since"</span>: <span class="string">"7"</span>,  <span class="comment"># Last 7 days</span>
        <span class="string">"truncation_limit"</span>: <span class="string">"5000"</span>
    }
    
    headers = {
        <span class="string">"X-Requested-With"</span>: <span class="string">"Python"</span>,
        <span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>
    }
    
    response = requests.post(
        url,
        auth=(username, password),
        data=params,
        headers=headers,
        timeout=<span class="number">300</span>
    )
    response.raise_for_status()
    
    <span class="keyword">return</span> response.text

<span class="keyword">def</span> <span class="function">parse_qualys_xml</span>(xml_data):
    <span class="string">"""Parse Qualys XML response into records"""</span>
    
    records = []
    timestamp = datetime.now(timezone.utc).isoformat()
    
    root = ET.fromstring(xml_data)
    
    <span class="keyword">for</span> host <span class="keyword">in</span> root.findall(<span class="string">".//HOST"</span>):
        host_ip = host.findtext(<span class="string">"IP"</span>, <span class="string">""</span>)
        hostname = host.findtext(<span class="string">"DNS"</span>, <span class="string">""</span>) <span class="keyword">or</span> host.findtext(<span class="string">"NETBIOS"</span>, <span class="string">""</span>)
        os_info = host.findtext(<span class="string">"OS"</span>, <span class="string">""</span>)
        
        <span class="keyword">for</span> detection <span class="keyword">in</span> host.findall(<span class="string">".//DETECTION"</span>):
            qid = detection.findtext(<span class="string">"QID"</span>, <span class="string">""</span>)
            severity = detection.findtext(<span class="string">"SEVERITY"</span>, <span class="string">"0"</span>)
            
            <span class="comment"># Extract CVE IDs if present</span>
            cve_list = []
            <span class="keyword">for</span> cve <span class="keyword">in</span> detection.findall(<span class="string">".//CVE_ID_LIST/CVE_ID/ID"</span>):
                <span class="keyword">if</span> cve.text:
                    cve_list.append(cve.text)
            
            records.append({
                <span class="string">"TimeGenerated"</span>: timestamp,
                <span class="string">"HostIP"</span>: host_ip,
                <span class="string">"Hostname"</span>: hostname,
                <span class="string">"OS"</span>: os_info,
                <span class="string">"QID"</span>: qid,
                <span class="string">"Severity"</span>: <span class="function">int</span>(severity),
                <span class="string">"CVE_IDs"</span>: <span class="string">","</span>.join(cve_list),  <span class="comment"># Comma-separated for multi-CVE</span>
                <span class="string">"Title"</span>: detection.findtext(<span class="string">"TITLE"</span>, <span class="string">""</span>),
                <span class="string">"Type"</span>: detection.findtext(<span class="string">"TYPE"</span>, <span class="string">""</span>),
                <span class="string">"Status"</span>: detection.findtext(<span class="string">"STATUS"</span>, <span class="string">""</span>),
                <span class="string">"FirstFound"</span>: detection.findtext(<span class="string">"FIRST_FOUND_DATETIME"</span>, <span class="string">""</span>),
                <span class="string">"LastFound"</span>: detection.findtext(<span class="string">"LAST_FOUND_DATETIME"</span>, <span class="string">""</span>),
                <span class="string">"TruRiskScore"</span>: <span class="function">float</span>(detection.findtext(<span class="string">"TRURISK_SCORE"</span>, <span class="string">"0"</span>) <span class="keyword">or</span> <span class="string">"0"</span>),
                <span class="string">"DataSource"</span>: <span class="string">"Qualys VMDR"</span>
            })
    
    <span class="keyword">return</span> records

<span class="keyword">def</span> <span class="function">main</span>(timer: func.TimerRequest) -> <span class="keyword">None</span>:
    logging.info(<span class="string">'Qualys sync function started'</span>)
    
    <span class="keyword">try</span>:
        username, password = get_qualys_credentials()
        xml_data = fetch_qualys_detections(username, password)
        records = parse_qualys_xml(xml_data)
        
        logging.info(<span class="string">f'Parsed {len(records)} vulnerability records'</span>)
        
        <span class="keyword">if</span> records:
            credential = DefaultAzureCredential()
            client = LogsIngestionClient(
                endpoint=DCE_ENDPOINT,
                credential=credential
            )
            
            <span class="comment"># Batch upload</span>
            batch_size = <span class="number">10000</span>
            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">0</span>, <span class="function">len</span>(records), batch_size):
                batch = records[i:i + batch_size]
                client.upload(
                    rule_id=DCR_IMMUTABLE_ID,
                    stream_name=STREAM_NAME,
                    logs=batch
                )
            
            logging.info(<span class="string">f'Successfully ingested {len(records)} Qualys records'</span>)
    
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        logging.error(<span class="string">f'Qualys sync failed: {str(e)}'</span>)
        <span class="keyword">raise</span>
            </div>
          </div>
        </details>
      </section>

      <!-- ==================== ASSET INVENTORY WATCHLIST ==================== -->
      <section id="asset-inventory">
        <div class="stage-header">
          <h2>ğŸ“‹ Step 4: Asset Inventory Watchlist</h2>
          <p>Weekly-updated asset criticality for business context</p>
        </div>

        <div class="concept-card">
          <h3>Asset Inventory Watchlist Structure</h3>
          
          <div class="info-box">
            <h4>Watchlist: AssetInventory</h4>
            <p>Updated weekly from CMDB/ServiceNow/Intune via Logic App</p>
          </div>

          <table class="comparison-table">
            <thead>
              <tr>
                <th>Column</th>
                <th>Type</th>
                <th>Example</th>
                <th>Purpose</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Hostname</td><td>string</td><td>SRV-PROD-DB01</td><td>Primary key for joins</td></tr>
              <tr><td>IPAddress</td><td>string</td><td>10.0.1.50</td><td>Alternative join key</td></tr>
              <tr><td>DeviceId</td><td>string</td><td>abc123-def456</td><td>MDE Device ID</td></tr>
              <tr><td>AssetCriticality</td><td>string</td><td>Critical/High/Medium/Low</td><td>Business criticality</td></tr>
              <tr><td>CriticalityScore</td><td>int</td><td>100/75/50/25</td><td>Numeric for scoring</td></tr>
              <tr><td>BusinessUnit</td><td>string</td><td>Finance</td><td>Ownership</td></tr>
              <tr><td>Owner</td><td>string</td><td>john.doe@company.com</td><td>Alert routing</td></tr>
              <tr><td>Environment</td><td>string</td><td>Production/Staging/Dev</td><td>Priority context</td></tr>
              <tr><td>DataClassification</td><td>string</td><td>PII/Confidential/Public</td><td>Data sensitivity</td></tr>
              <tr><td>LastUpdated</td><td>datetime</td><td>2024-01-15T00:00:00Z</td><td>Freshness tracking</td></tr>
            </tbody>
          </table>
        </div>

        <details>
          <summary><strong>Logic App: Weekly Asset Inventory Sync</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="comment">// Logic App Definition (simplified)</span>
{
  "<span class="field">definition</span>": {
    "<span class="field">triggers</span>": {
      "<span class="field">Recurrence</span>": {
        "<span class="field">type</span>": "<span class="string">Recurrence</span>",
        "<span class="field">recurrence</span>": {
          "<span class="field">frequency</span>": "<span class="string">Week</span>",
          "<span class="field">interval</span>": <span class="number">1</span>,
          "<span class="field">schedule</span>": {
            "<span class="field">weekDays</span>": ["<span class="string">Sunday</span>"],
            "<span class="field">hours</span>": [<span class="string">"2"</span>]
          }
        }
      }
    },
    "<span class="field">actions</span>": {
      "<span class="field">Get_Assets_From_ServiceNow</span>": {
        "<span class="field">type</span>": "<span class="string">Http</span>",
        "<span class="field">inputs</span>": {
          "<span class="field">method</span>": "<span class="string">GET</span>",
          "<span class="field">uri</span>": "<span class="string">https://company.service-now.com/api/now/table/cmdb_ci_server</span>",
          "<span class="field">queries</span>": {
            "<span class="field">sysparm_query</span>": "<span class="string">install_status=1^operational_status=1</span>",
            "<span class="field">sysparm_fields</span>": "<span class="string">name,ip_address,u_criticality,u_business_unit,owned_by</span>"
          },
          "<span class="field">authentication</span>": {
            "<span class="field">type</span>": "<span class="string">ManagedServiceIdentity</span>"
          }
        }
      },
      "<span class="field">Get_Devices_From_Intune</span>": {
        "<span class="field">type</span>": "<span class="string">Http</span>",
        "<span class="field">inputs</span>": {
          "<span class="field">method</span>": "<span class="string">GET</span>",
          "<span class="field">uri</span>": "<span class="string">https://graph.microsoft.com/v1.0/deviceManagement/managedDevices</span>",
          "<span class="field">authentication</span>": {
            "<span class="field">type</span>": "<span class="string">ManagedServiceIdentity</span>",
            "<span class="field">audience</span>": "<span class="string">https://graph.microsoft.com</span>"
          }
        }
      },
      "<span class="field">Merge_And_Deduplicate</span>": {
        "<span class="field">type</span>": "<span class="string">Compose</span>",
        "<span class="field">inputs</span>": "<span class="string">@{union(body('Get_Assets_From_ServiceNow'), body('Get_Devices_From_Intune'))}</span>"
      },
      "<span class="field">Update_Watchlist</span>": {
        "<span class="field">type</span>": "<span class="string">ApiConnection</span>",
        "<span class="field">inputs</span>": {
          "<span class="field">host</span>": {
            "<span class="field">connection</span>": {
              "<span class="field">name</span>": "<span class="string">@parameters('$connections')['azuresentinel']['connectionId']</span>"
            }
          },
          "<span class="field">method</span>": "<span class="string">put</span>",
          "<span class="field">path</span>": "<span class="string">/Watchlists/@{encodeURIComponent('AssetInventory')}</span>",
          "<span class="field">body</span>": {
            "<span class="field">displayName</span>": "<span class="string">Asset Inventory</span>",
            "<span class="field">itemsSearchKey</span>": "<span class="string">Hostname</span>",
            "<span class="field">rawContent</span>": "<span class="string">@{body('Convert_To_CSV')}</span>"
          }
        }
      }
    }
  }
}
            </div>
          </div>
        </details>
      </section>

      <!-- ==================== CUSTOM SCORING MODEL ==================== -->
      <section id="scoring">
        <div class="stage-header">
          <h2>ğŸ§® Step 5: Custom Risk Scoring Model</h2>
          <p>Combine all sources into a unified, actionable risk score</p>
        </div>

        <div class="concept-card">
          <h3>Scoring Model Design</h3>
          
          <div class="scoring-formula">
            <h4>Final Risk Score Formula (0-100 scale)</h4>
            <div class="formula">
RiskScore = 
  (CVSS_Normalized Ã— 15) +           <span class="comment">// Base severity: 15%</span>
  (EPSS Ã— 100 Ã— 0.30) +              <span class="comment">// Exploit probability: 30%</span>
  (IsInKEV Ã— 30) +                   <span class="comment">// Active exploitation: +30 points</span>
  (TruRisk_Normalized Ã— 15) +        <span class="comment">// Qualys context: 15%</span>
  (AssetCriticality_Normalized Ã— 10) <span class="comment">// Business impact: 10%</span>
            </div>
          </div>

          <table class="comparison-table">
            <thead>
              <tr>
                <th>Factor</th>
                <th>Source</th>
                <th>Weight</th>
                <th>Rationale</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>CVSS Score</strong></td>
                <td>TVM / Qualys</td>
                <td>15%</td>
                <td>Technical severity baseline</td>
              </tr>
              <tr>
                <td><strong>EPSS Score</strong></td>
                <td>FIRST.org</td>
                <td>30%</td>
                <td>Exploit probability â€” most predictive of actual risk</td>
              </tr>
              <tr>
                <td><strong>CISA KEV</strong></td>
                <td>CISA</td>
                <td>+30 points</td>
                <td>Binary boost â€” if actively exploited, high priority</td>
              </tr>
              <tr>
                <td><strong>TruRisk</strong></td>
                <td>Qualys</td>
                <td>15%</td>
                <td>Qualys's own risk intelligence</td>
              </tr>
              <tr>
                <td><strong>Asset Criticality</strong></td>
                <td>Watchlist</td>
                <td>10%</td>
                <td>Business context â€” critical assets get priority</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="concept-card">
          <h3>KQL: Unified Vulnerability View with Risk Scoring</h3>
          
          <div class="code-block">
<span class="comment">// Unified Vulnerability Risk Score Query</span>
<span class="comment">// Merges TVM + Qualys + EPSS + KEV + Asset Inventory</span>
<span class="comment">// Deduplicates and calculates custom risk score</span>

<span class="comment">// Step 1: Get latest EPSS scores</span>
<span class="keyword">let</span> <span class="field">EPSS</span> = EPSS_Scores_CL
    | <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(2d)
    | <span class="keyword">summarize</span> <span class="function">arg_max</span>(<span class="field">TimeGenerated</span>, *) <span class="keyword">by</span> <span class="field">CVE_ID</span>
    | <span class="keyword">project</span> <span class="field">CVE_ID</span>, <span class="field">EPSS_Score</span>, <span class="field">EPSS_Percentile</span>;

<span class="comment">// Step 2: Get CISA KEV list</span>
<span class="keyword">let</span> <span class="field">KEV</span> = CISA_KEV_CL
    | <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(2d)
    | <span class="keyword">summarize</span> <span class="function">arg_max</span>(<span class="field">TimeGenerated</span>, *) <span class="keyword">by</span> <span class="field">CVE_ID</span>
    | <span class="keyword">project</span> <span class="field">CVE_ID</span>, <span class="field">IsInKEV</span> = true, <span class="field">KEV_DateAdded</span> = <span class="field">DateAdded</span>, 
              <span class="field">KnownRansomware</span> = <span class="field">KnownRansomwareCampaignUse</span>;

<span class="comment">// Step 3: Get Asset Inventory</span>
<span class="keyword">let</span> <span class="field">Assets</span> = <span class="function">_GetWatchlist</span>(<span class="string">'AssetInventory'</span>)
    | <span class="keyword">project</span> <span class="field">Hostname</span>, <span class="field">IPAddress</span>, <span class="field">DeviceId</span>, <span class="field">AssetCriticality</span>, 
              <span class="field">CriticalityScore</span>, <span class="field">BusinessUnit</span>, <span class="field">Owner</span>, <span class="field">Environment</span>;

<span class="comment">// Step 4: Get Microsoft TVM vulnerabilities</span>
<span class="keyword">let</span> <span class="field">TVM_Vulns</span> = DeviceTvmSoftwareVulnerabilities
    | <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(1d)
    | <span class="keyword">extend</span> <span class="field">CVE_ID</span> = <span class="field">CveId</span>
    | <span class="keyword">project</span> 
        <span class="field">DeviceId</span>,
        <span class="field">DeviceName</span>,
        <span class="field">CVE_ID</span>,
        <span class="field">VulnerabilitySeverityLevel</span>,
        <span class="field">CVSS_TVM</span> = <span class="function">todouble</span>(<span class="field">CvssScore</span>),
        <span class="field">SoftwareName</span>,
        <span class="field">SoftwareVersion</span>,
        <span class="field">Source</span> = <span class="string">"Microsoft TVM"</span>;

<span class="comment">// Step 5: Get Qualys vulnerabilities</span>
<span class="keyword">let</span> <span class="field">Qualys_Vulns</span> = Qualys_Vulns_CL
    | <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(1d)
    | <span class="keyword">mv-expand</span> <span class="field">CVE_ID</span> = <span class="function">split</span>(<span class="field">CVE_IDs</span>, <span class="string">","</span>)
    | <span class="keyword">extend</span> <span class="field">CVE_ID</span> = <span class="function">tostring</span>(<span class="field">CVE_ID</span>)
    | <span class="keyword">where</span> <span class="field">CVE_ID</span> != <span class="string">""</span>
    | <span class="keyword">project</span>
        <span class="field">Hostname</span>,
        <span class="field">HostIP</span>,
        <span class="field">CVE_ID</span>,
        <span class="field">Severity_Qualys</span> = <span class="field">Severity</span>,
        <span class="field">TruRiskScore</span>,
        <span class="field">QID</span>,
        <span class="field">Title</span>,
        <span class="field">Source</span> = <span class="string">"Qualys VMDR"</span>;

<span class="comment">// Step 6: Merge TVM and Qualys (deduplicate by CVE + Host)</span>
<span class="keyword">let</span> <span class="field">Merged_Vulns</span> = TVM_Vulns
    | <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter Assets <span class="keyword">on</span> <span class="field">DeviceId</span>
    | <span class="keyword">extend</span> <span class="field">Hostname</span> = <span class="function">coalesce</span>(<span class="field">Hostname</span>, <span class="field">DeviceName</span>)
    | <span class="keyword">union</span> (
        Qualys_Vulns
        | <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter Assets <span class="keyword">on</span> <span class="field">Hostname</span>
    )
    <span class="comment">// Deduplicate: keep TVM if both exist (it has better remediation data)</span>
    | <span class="keyword">summarize</span> 
        <span class="function">arg_max</span>(<span class="field">Source</span> == <span class="string">"Microsoft TVM"</span>, *),
        <span class="field">Sources</span> = <span class="function">make_set</span>(<span class="field">Source</span>),
        <span class="field">CVSS_Max</span> = <span class="function">max</span>(<span class="function">coalesce</span>(<span class="field">CVSS_TVM</span>, <span class="field">Severity_Qualys</span> * <span class="number">2.0</span>)),
        <span class="field">TruRisk_Max</span> = <span class="function">max</span>(<span class="field">TruRiskScore</span>)
      <span class="keyword">by</span> <span class="field">CVE_ID</span>, <span class="field">Hostname</span>;

<span class="comment">// Step 7: Enrich with EPSS and KEV</span>
Merged_Vulns
| <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter EPSS <span class="keyword">on</span> <span class="field">CVE_ID</span>
| <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter KEV <span class="keyword">on</span> <span class="field">CVE_ID</span>
| <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter Assets <span class="keyword">on</span> <span class="field">Hostname</span>
<span class="comment">// Step 8: Calculate Risk Score</span>
| <span class="keyword">extend</span> 
    <span class="field">CVSS_Normalized</span> = <span class="field">CVSS_Max</span> / <span class="number">10.0</span>,  <span class="comment">// Normalize to 0-1</span>
    <span class="field">EPSS_Score</span> = <span class="function">coalesce</span>(<span class="field">EPSS_Score</span>, <span class="number">0.0</span>),
    <span class="field">IsInKEV</span> = <span class="function">coalesce</span>(<span class="field">IsInKEV</span>, false),
    <span class="field">TruRisk_Normalized</span> = <span class="function">coalesce</span>(<span class="field">TruRisk_Max</span>, <span class="number">0.0</span>) / <span class="number">1000.0</span>,  <span class="comment">// TruRisk is 0-1000</span>
    <span class="field">AssetCrit_Normalized</span> = <span class="function">coalesce</span>(<span class="field">CriticalityScore</span>, <span class="number">50</span>) / <span class="number">100.0</span>
| <span class="keyword">extend</span> <span class="field">RiskScore</span> = <span class="function">round</span>(
    (<span class="field">CVSS_Normalized</span> * <span class="number">15</span>) +
    (<span class="field">EPSS_Score</span> * <span class="number">100</span> * <span class="number">0.30</span>) +
    (<span class="function">iif</span>(<span class="field">IsInKEV</span>, <span class="number">30.0</span>, <span class="number">0.0</span>)) +
    (<span class="field">TruRisk_Normalized</span> * <span class="number">15</span>) +
    (<span class="field">AssetCrit_Normalized</span> * <span class="number">10</span>),
    <span class="number">1</span>
  )
<span class="comment">// Step 9: Classify priority</span>
| <span class="keyword">extend</span> <span class="field">Priority</span> = <span class="keyword">case</span>(
    <span class="field">RiskScore</span> >= <span class="number">85</span>, <span class="string">"P1-Critical"</span>,
    <span class="field">RiskScore</span> >= <span class="number">70</span>, <span class="string">"P2-High"</span>,
    <span class="field">RiskScore</span> >= <span class="number">50</span>, <span class="string">"P3-Medium"</span>,
    <span class="string">"P4-Low"</span>
  )
| <span class="keyword">project</span>
    <span class="field">Hostname</span>,
    <span class="field">CVE_ID</span>,
    <span class="field">RiskScore</span>,
    <span class="field">Priority</span>,
    <span class="field">CVSS_Max</span>,
    <span class="field">EPSS_Score</span>,
    <span class="field">EPSS_Percentile</span>,
    <span class="field">IsInKEV</span>,
    <span class="field">KnownRansomware</span>,
    <span class="field">TruRiskScore</span> = <span class="field">TruRisk_Max</span>,
    <span class="field">AssetCriticality</span>,
    <span class="field">BusinessUnit</span>,
    <span class="field">Owner</span>,
    <span class="field">Environment</span>,
    <span class="field">Sources</span>,
    <span class="field">SoftwareName</span>,
    <span class="field">Title</span>
| <span class="keyword">order by</span> <span class="field">RiskScore</span> <span class="keyword">desc</span>
          </div>
        </div>
      </section>

      <!-- ==================== ALERTING LOGIC ==================== -->
      <section id="alerting">
        <div class="stage-header">
          <h2>ğŸš¨ Step 6: Alert Only on Critical</h2>
          <p>Daily scheduled rule that alerts only when P1-Critical vulnerabilities exist on critical assets</p>
        </div>

        <div class="concept-card">
          <h3>Sentinel Analytics Rule: Critical Vulnerability Alert</h3>
          
          <div class="code-block">
<span class="comment">// Analytics Rule: Critical Vulnerability on High-Value Asset</span>
<span class="comment">// Runs: Daily at 9 AM</span>
<span class="comment">// Alert: Only for P1-Critical vulnerabilities on Critical/High assets</span>

<span class="comment">// Reuse the unified view query from above, then filter</span>
<span class="keyword">let</span> <span class="field">UnifiedVulns</span> = 
    <span class="comment">// [Insert the full unified query from Step 5 here]</span>
    ...
    ;

UnifiedVulns
| <span class="keyword">where</span> <span class="field">Priority</span> == <span class="string">"P1-Critical"</span>
| <span class="keyword">where</span> <span class="field">AssetCriticality</span> <span class="keyword">in</span> (<span class="string">"Critical"</span>, <span class="string">"High"</span>)
| <span class="keyword">where</span> <span class="field">Environment</span> == <span class="string">"Production"</span>
<span class="comment">// Alert per CVE + Host combination</span>
| <span class="keyword">summarize</span> 
    <span class="field">AffectedHosts</span> = <span class="function">make_set</span>(<span class="field">Hostname</span>),
    <span class="field">HostCount</span> = <span class="function">dcount</span>(<span class="field">Hostname</span>),
    <span class="field">MaxRiskScore</span> = <span class="function">max</span>(<span class="field">RiskScore</span>),
    <span class="field">Owners</span> = <span class="function">make_set</span>(<span class="field">Owner</span>),
    <span class="field">BusinessUnits</span> = <span class="function">make_set</span>(<span class="field">BusinessUnit</span>)
  <span class="keyword">by</span> <span class="field">CVE_ID</span>, <span class="field">IsInKEV</span>, <span class="field">KnownRansomware</span>, <span class="field">EPSS_Score</span>, <span class="field">CVSS_Max</span>
| <span class="keyword">extend</span> <span class="field">AlertTitle</span> = <span class="function">strcat</span>(
    <span class="function">iif</span>(<span class="field">IsInKEV</span>, <span class="string">"ğŸš¨ [KEV] "</span>, <span class="string">""</span>),
    <span class="function">iif</span>(<span class="field">KnownRansomware</span> == <span class="string">"Known"</span>, <span class="string">"[RANSOMWARE] "</span>, <span class="string">""</span>),
    <span class="string">"Critical Vulnerability: "</span>,
    <span class="field">CVE_ID</span>,
    <span class="string">" on "</span>,
    <span class="function">tostring</span>(<span class="field">HostCount</span>),
    <span class="string">" production assets"</span>
  )
| <span class="keyword">extend</span> <span class="field">AlertDescription</span> = <span class="function">strcat</span>(
    <span class="string">"CVE: "</span>, <span class="field">CVE_ID</span>, <span class="string">"\n"</span>,
    <span class="string">"Risk Score: "</span>, <span class="function">tostring</span>(<span class="field">MaxRiskScore</span>), <span class="string">"/100\n"</span>,
    <span class="string">"CVSS: "</span>, <span class="function">tostring</span>(<span class="field">CVSS_Max</span>), <span class="string">"\n"</span>,
    <span class="string">"EPSS: "</span>, <span class="function">tostring</span>(<span class="function">round</span>(<span class="field">EPSS_Score</span> * <span class="number">100</span>, <span class="number">1</span>)), <span class="string">"%\n"</span>,
    <span class="string">"In CISA KEV: "</span>, <span class="function">iif</span>(<span class="field">IsInKEV</span>, <span class="string">"YES - ACTIVELY EXPLOITED"</span>, <span class="string">"No"</span>), <span class="string">"\n"</span>,
    <span class="string">"Affected Hosts: "</span>, <span class="function">tostring</span>(<span class="field">AffectedHosts</span>), <span class="string">"\n"</span>,
    <span class="string">"Business Units: "</span>, <span class="function">tostring</span>(<span class="field">BusinessUnits</span>), <span class="string">"\n"</span>,
    <span class="string">"Owners: "</span>, <span class="function">tostring</span>(<span class="field">Owners</span>)
  )
| <span class="keyword">project</span>
    <span class="field">AlertTitle</span>,
    <span class="field">AlertDescription</span>,
    <span class="field">CVE_ID</span>,
    <span class="field">MaxRiskScore</span>,
    <span class="field">HostCount</span>,
    <span class="field">AffectedHosts</span>,
    <span class="field">IsInKEV</span>,
    <span class="field">KnownRansomware</span>,
    <span class="field">Owners</span>
          </div>
        </div>

        <div class="tip-box">
          <h4>ğŸ’¡ Alert Rule Configuration</h4>
          <ul>
            <li><strong>Frequency:</strong> Every 24 hours (daily at 9 AM)</li>
            <li><strong>Lookback:</strong> 1 day</li>
            <li><strong>Alert threshold:</strong> > 0 results</li>
            <li><strong>Event grouping:</strong> Group by CVE_ID (one incident per CVE)</li>
            <li><strong>Severity:</strong> High (auto-escalate to Critical if IsInKEV=true)</li>
            <li><strong>Tactics:</strong> Initial Access, Execution</li>
            <li><strong>Techniques:</strong> T1190 (Exploit Public-Facing Application)</li>
          </ul>
        </div>
      </section>

      <!-- ==================== USE CASE 2: IP REPUTATION ==================== -->
      <section id="use-case-2">
        <div class="stage-header">
          <h2>ğŸŒ Use Case 2: IP Reputation Intelligence</h2>
          <p>Aggregate multiple IP reputation sources for network threat detection</p>
        </div>

        <div class="concept-card">
          <h3>Common Enterprise TI Sources</h3>
          
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Source</th>
                <th>Data Type</th>
                <th>API</th>
                <th>Update Frequency</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>AbuseIPDB</strong></td>
                <td>Malicious IPs (reported abuse)</td>
                <td>REST API (API key)</td>
                <td>Every 4 hours</td>
              </tr>
              <tr>
                <td><strong>AlienVault OTX</strong></td>
                <td>IPs, domains, hashes, URLs</td>
                <td>REST API (free tier available)</td>
                <td>Every 6 hours</td>
              </tr>
              <tr>
                <td><strong>VirusTotal</strong></td>
                <td>File hashes, URLs, IPs, domains</td>
                <td>REST API (rate limited)</td>
                <td>On-demand lookups</td>
              </tr>
              <tr>
                <td><strong>Emerging Threats</strong></td>
                <td>IP blocklists, Suricata rules</td>
                <td>HTTP download (free/pro)</td>
                <td>Daily</td>
              </tr>
              <tr>
                <td><strong>Spamhaus</strong></td>
                <td>IP blocklists (spam, botnet)</td>
                <td>DNS / REST API</td>
                <td>Real-time</td>
              </tr>
              <tr>
                <td><strong>GreyNoise</strong></td>
                <td>Internet noise vs targeted attacks</td>
                <td>REST API</td>
                <td>Every 4 hours</td>
              </tr>
            </tbody>
          </table>
        </div>

        <details>
          <summary><strong>Azure Function: IP Reputation Aggregator</strong></summary>
          <div class="details-content">
            <div class="code-block">
<span class="keyword">import</span> azure.functions <span class="keyword">as</span> func
<span class="keyword">import</span> requests
<span class="keyword">import</span> os
<span class="keyword">import</span> logging
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone
<span class="keyword">from</span> azure.identity <span class="keyword">import</span> DefaultAzureCredential
<span class="keyword">from</span> azure.monitor.ingestion <span class="keyword">import</span> LogsIngestionClient
<span class="keyword">from</span> azure.keyvault.secrets <span class="keyword">import</span> SecretClient

DCE_ENDPOINT = os.environ[<span class="string">"DCE_ENDPOINT"</span>]
DCR_IMMUTABLE_ID = os.environ[<span class="string">"DCR_IPREPUTE_IMMUTABLE_ID"</span>]
STREAM_NAME = <span class="string">"Custom-IPReputation_CL"</span>
KEY_VAULT_URL = os.environ[<span class="string">"KEY_VAULT_URL"</span>]

<span class="keyword">def</span> <span class="function">get_abuseipdb_blacklist</span>(api_key):
    <span class="string">"""Fetch AbuseIPDB blacklist (confidence score >= 90)"""</span>
    url = <span class="string">"https://api.abuseipdb.com/api/v2/blacklist"</span>
    headers = {
        <span class="string">"Key"</span>: api_key,
        <span class="string">"Accept"</span>: <span class="string">"application/json"</span>
    }
    params = {
        <span class="string">"confidenceMinimum"</span>: <span class="number">90</span>,
        <span class="string">"limit"</span>: <span class="number">10000</span>
    }
    
    response = requests.get(url, headers=headers, params=params, timeout=<span class="number">60</span>)
    response.raise_for_status()
    data = response.json()
    
    records = []
    timestamp = datetime.now(timezone.utc).isoformat()
    
    <span class="keyword">for</span> item <span class="keyword">in</span> data.get(<span class="string">"data"</span>, []):
        records.append({
            <span class="string">"TimeGenerated"</span>: timestamp,
            <span class="string">"IPAddress"</span>: item.get(<span class="string">"ipAddress"</span>),
            <span class="string">"ConfidenceScore"</span>: item.get(<span class="string">"abuseConfidenceScore"</span>, <span class="number">0</span>),
            <span class="string">"ThreatType"</span>: <span class="string">"Abuse"</span>,
            <span class="string">"Source"</span>: <span class="string">"AbuseIPDB"</span>,
            <span class="string">"LastReportedAt"</span>: item.get(<span class="string">"lastReportedAt"</span>, <span class="string">""</span>),
            <span class="string">"CountryCode"</span>: item.get(<span class="string">"countryCode"</span>, <span class="string">""</span>)
        })
    
    <span class="keyword">return</span> records

<span class="keyword">def</span> <span class="function">get_otx_pulses</span>(api_key):
    <span class="string">"""Fetch AlienVault OTX subscribed pulses"""</span>
    url = <span class="string">"https://otx.alienvault.com/api/v1/pulses/subscribed"</span>
    headers = {<span class="string">"X-OTX-API-KEY"</span>: api_key}
    params = {<span class="string">"limit"</span>: <span class="number">50</span>, <span class="string">"modified_since"</span>: <span class="string">"7 days ago"</span>}
    
    response = requests.get(url, headers=headers, params=params, timeout=<span class="number">120</span>)
    response.raise_for_status()
    data = response.json()
    
    records = []
    timestamp = datetime.now(timezone.utc).isoformat()
    
    <span class="keyword">for</span> pulse <span class="keyword">in</span> data.get(<span class="string">"results"</span>, []):
        pulse_name = pulse.get(<span class="string">"name"</span>, <span class="string">""</span>)
        <span class="keyword">for</span> indicator <span class="keyword">in</span> pulse.get(<span class="string">"indicators"</span>, []):
            <span class="keyword">if</span> indicator.get(<span class="string">"type"</span>) == <span class="string">"IPv4"</span>:
                records.append({
                    <span class="string">"TimeGenerated"</span>: timestamp,
                    <span class="string">"IPAddress"</span>: indicator.get(<span class="string">"indicator"</span>),
                    <span class="string">"ConfidenceScore"</span>: <span class="number">80</span>,  <span class="comment"># OTX doesn't provide confidence</span>
                    <span class="string">"ThreatType"</span>: pulse_name[:100],
                    <span class="string">"Source"</span>: <span class="string">"AlienVault OTX"</span>,
                    <span class="string">"PulseId"</span>: pulse.get(<span class="string">"id"</span>, <span class="string">""</span>),
                    <span class="string">"Tags"</span>: <span class="string">","</span>.join(pulse.get(<span class="string">"tags"</span>, [])[:5])
                })
    
    <span class="keyword">return</span> records

<span class="keyword">def</span> <span class="function">get_emerging_threats</span>():
    <span class="string">"""Fetch Emerging Threats compromised IPs (free tier)"""</span>
    url = <span class="string">"https://rules.emergingthreats.net/blockrules/compromised-ips.txt"</span>
    
    response = requests.get(url, timeout=<span class="number">60</span>)
    response.raise_for_status()
    
    records = []
    timestamp = datetime.now(timezone.utc).isoformat()
    
    <span class="keyword">for</span> line <span class="keyword">in</span> response.text.strip().split(<span class="string">"\n"</span>):
        line = line.strip()
        <span class="keyword">if</span> line <span class="keyword">and</span> <span class="keyword">not</span> line.startswith(<span class="string">"#"</span>):
            records.append({
                <span class="string">"TimeGenerated"</span>: timestamp,
                <span class="string">"IPAddress"</span>: line,
                <span class="string">"ConfidenceScore"</span>: <span class="number">75</span>,
                <span class="string">"ThreatType"</span>: <span class="string">"Compromised"</span>,
                <span class="string">"Source"</span>: <span class="string">"Emerging Threats"</span>
            })
    
    <span class="keyword">return</span> records

<span class="keyword">def</span> <span class="function">deduplicate_records</span>(records):
    <span class="string">"""Deduplicate by IP, keeping highest confidence score"""</span>
    ip_map = {}
    <span class="keyword">for</span> r <span class="keyword">in</span> records:
        ip = r[<span class="string">"IPAddress"</span>]
        <span class="keyword">if</span> ip <span class="keyword">not in</span> ip_map <span class="keyword">or</span> r[<span class="string">"ConfidenceScore"</span>] > ip_map[ip][<span class="string">"ConfidenceScore"</span>]:
            ip_map[ip] = r
    <span class="keyword">return</span> <span class="function">list</span>(ip_map.values())

<span class="keyword">def</span> <span class="function">main</span>(timer: func.TimerRequest) -> <span class="keyword">None</span>:
    logging.info(<span class="string">'IP Reputation sync started'</span>)
    
    <span class="keyword">try</span>:
        credential = DefaultAzureCredential()
        secret_client = SecretClient(vault_url=KEY_VAULT_URL, credential=credential)
        
        abuseipdb_key = secret_client.get_secret(<span class="string">"abuseipdb-api-key"</span>).value
        otx_key = secret_client.get_secret(<span class="string">"otx-api-key"</span>).value
        
        <span class="comment"># Fetch from all sources</span>
        all_records = []
        all_records.extend(get_abuseipdb_blacklist(abuseipdb_key))
        all_records.extend(get_otx_pulses(otx_key))
        all_records.extend(get_emerging_threats())
        
        logging.info(<span class="string">f'Fetched {len(all_records)} total records'</span>)
        
        <span class="comment"># Deduplicate</span>
        deduped = deduplicate_records(all_records)
        logging.info(<span class="string">f'After deduplication: {len(deduped)} unique IPs'</span>)
        
        <span class="comment"># Ingest</span>
        <span class="keyword">if</span> deduped:
            client = LogsIngestionClient(endpoint=DCE_ENDPOINT, credential=credential)
            
            batch_size = <span class="number">10000</span>
            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">0</span>, <span class="function">len</span>(deduped), batch_size):
                batch = deduped[i:i + batch_size]
                client.upload(
                    rule_id=DCR_IMMUTABLE_ID,
                    stream_name=STREAM_NAME,
                    logs=batch
                )
            
            logging.info(<span class="string">f'Successfully ingested {len(deduped)} IP reputation records'</span>)
    
    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
        logging.error(<span class="string">f'IP Reputation sync failed: {str(e)}'</span>)
        <span class="keyword">raise</span>
            </div>
          </div>
        </details>

        <div class="concept-card">
          <h3>Detection Rule: Connection to Malicious IP</h3>
          
          <div class="code-block">
<span class="comment">// Analytics Rule: Network Connection to Malicious IP</span>
<span class="comment">// Correlates network logs with IP reputation data</span>

<span class="keyword">let</span> <span class="field">MaliciousIPs</span> = IPReputation_CL
    | <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(2d)
    | <span class="keyword">where</span> <span class="field">ConfidenceScore</span> >= <span class="number">80</span>
    | <span class="keyword">summarize</span> <span class="function">arg_max</span>(<span class="field">TimeGenerated</span>, *) <span class="keyword">by</span> <span class="field">IPAddress</span>
    | <span class="keyword">project</span> <span class="field">MaliciousIP</span> = <span class="field">IPAddress</span>, <span class="field">TIConfidence</span> = <span class="field">ConfidenceScore</span>, 
              <span class="field">TISource</span> = <span class="field">Source</span>, <span class="field">TIThreatType</span> = <span class="field">ThreatType</span>;

<span class="comment">// Check outbound connections from CommonSecurityLog (firewall)</span>
CommonSecurityLog
| <span class="keyword">where</span> <span class="field">TimeGenerated</span> > ago(1h)
| <span class="keyword">where</span> <span class="field">DeviceAction</span> <span class="keyword">in</span> (<span class="string">"allow"</span>, <span class="string">"Accept"</span>)
| <span class="keyword">where</span> <span class="function">isnotempty</span>(<span class="field">DestinationIP</span>)
| <span class="keyword">join</span> <span class="keyword">kind</span>=inner MaliciousIPs <span class="keyword">on</span> $left.<span class="field">DestinationIP</span> == $right.<span class="field">MaliciousIP</span>
<span class="comment">// Enrich with asset info</span>
| <span class="keyword">join</span> <span class="keyword">kind</span>=leftouter (
    <span class="function">_GetWatchlist</span>(<span class="string">'AssetInventory'</span>) | <span class="keyword">project</span> <span class="field">IPAddress</span>, <span class="field">Hostname</span>, <span class="field">AssetCriticality</span>, <span class="field">Owner</span>
  ) <span class="keyword">on</span> $left.<span class="field">SourceIP</span> == $right.<span class="field">IPAddress</span>
| <span class="keyword">summarize</span>
    <span class="field">ConnectionCount</span> = <span class="function">count</span>(),
    <span class="field">BytesSent</span> = <span class="function">sum</span>(<span class="function">toint</span>(<span class="field">SentBytes</span>)),
    <span class="field">BytesReceived</span> = <span class="function">sum</span>(<span class="function">toint</span>(<span class="field">ReceivedBytes</span>)),
    <span class="field">FirstSeen</span> = <span class="function">min</span>(<span class="field">TimeGenerated</span>),
    <span class="field">LastSeen</span> = <span class="function">max</span>(<span class="field">TimeGenerated</span>),
    <span class="field">DestPorts</span> = <span class="function">make_set</span>(<span class="field">DestinationPort</span>)
  <span class="keyword">by</span> <span class="field">SourceIP</span>, <span class="field">Hostname</span>, <span class="field">DestinationIP</span>, <span class="field">TIConfidence</span>, <span class="field">TISource</span>, 
     <span class="field">TIThreatType</span>, <span class="field">AssetCriticality</span>, <span class="field">Owner</span>
| <span class="keyword">extend</span> <span class="field">Severity</span> = <span class="keyword">case</span>(
    <span class="field">TIConfidence</span> >= <span class="number">95</span> <span class="keyword">and</span> <span class="field">AssetCriticality</span> == <span class="string">"Critical"</span>, <span class="string">"High"</span>,
    <span class="field">TIConfidence</span> >= <span class="number">90</span>, <span class="string">"Medium"</span>,
    <span class="string">"Low"</span>
  )
| <span class="keyword">project</span>
    <span class="field">SourceIP</span>,
    <span class="field">Hostname</span>,
    <span class="field">DestinationIP</span>,
    <span class="field">TIConfidence</span>,
    <span class="field">TISource</span>,
    <span class="field">TIThreatType</span>,
    <span class="field">ConnectionCount</span>,
    <span class="field">BytesSent</span>,
    <span class="field">BytesReceived</span>,
    <span class="field">DestPorts</span>,
    <span class="field">FirstSeen</span>,
    <span class="field">LastSeen</span>,
    <span class="field">AssetCriticality</span>,
    <span class="field">Owner</span>,
    <span class="field">Severity</span>
          </div>
        </div>
      </section>

      <!-- ==================== OPERATIONAL MAINTENANCE ==================== -->
      <section id="maintenance">
        <div class="stage-header">
          <h2>ğŸ”§ Operational Maintenance</h2>
          <p>Schedules, monitoring, and troubleshooting</p>
        </div>

        <div class="concept-card">
          <h3>Complete Schedule Overview</h3>
          
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Component</th>
                <th>Schedule</th>
                <th>Trigger</th>
                <th>Expected Records</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>EPSS Sync</strong></td>
                <td>Daily 6:00 AM UTC</td>
                <td>Timer (Azure Function)</td>
                <td>~15,000-20,000 (EPSS > 0.1)</td>
              </tr>
              <tr>
                <td><strong>CISA KEV Sync</strong></td>
                <td>Daily 7:00 AM UTC</td>
                <td>Timer (Azure Function)</td>
                <td>~1,100+ (growing)</td>
              </tr>
              <tr>
                <td><strong>Qualys Sync</strong></td>
                <td>Daily 8:00 AM UTC</td>
                <td>Timer (Azure Function)</td>
                <td>Varies by environment</td>
              </tr>
              <tr>
                <td><strong>IP Reputation Sync</strong></td>
                <td>Every 4 hours</td>
                <td>Timer (Azure Function)</td>
                <td>~50,000-100,000</td>
              </tr>
              <tr>
                <td><strong>Asset Inventory</strong></td>
                <td>Weekly (Sunday 2 AM)</td>
                <td>Logic App</td>
                <td>All managed assets</td>
              </tr>
              <tr>
                <td><strong>Vulnerability Alert</strong></td>
                <td>Daily 9:00 AM UTC</td>
                <td>Sentinel Analytics Rule</td>
                <td>Only P1-Critical</td>
              </tr>
              <tr>
                <td><strong>IP Reputation Alert</strong></td>
                <td>Every 15 minutes</td>
                <td>Sentinel Analytics Rule</td>
                <td>Real-time matches</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="concept-card">
          <h3>Monitoring & Health Checks</h3>
          
          <div class="code-block">
<span class="comment">// Workbook Query: TI Data Freshness Dashboard</span>

<span class="keyword">let</span> <span class="field">DataSources</span> = <span class="function">datatable</span>(<span class="field">Source</span>:<span class="keyword">string</span>, <span class="field">ExpectedFrequency</span>:<span class="keyword">string</span>, <span class="field">MaxAge</span>:<span class="keyword">timespan</span>) [
    <span class="string">"EPSS"</span>, <span class="string">"Daily"</span>, 2d,
    <span class="string">"CISA KEV"</span>, <span class="string">"Daily"</span>, 2d,
    <span class="string">"Qualys"</span>, <span class="string">"Daily"</span>, 2d,
    <span class="string">"IP Reputation"</span>, <span class="string">"4 hours"</span>, 8h
];

<span class="keyword">let</span> <span class="field">EPSS_Status</span> = EPSS_Scores_CL 
    | <span class="keyword">summarize</span> <span class="field">LastUpdate</span> = <span class="function">max</span>(<span class="field">TimeGenerated</span>), <span class="field">RecordCount</span> = <span class="function">count</span>()
    | <span class="keyword">extend</span> <span class="field">Source</span> = <span class="string">"EPSS"</span>;

<span class="keyword">let</span> <span class="field">KEV_Status</span> = CISA_KEV_CL 
    | <span class="keyword">summarize</span> <span class="field">LastUpdate</span> = <span class="function">max</span>(<span class="field">TimeGenerated</span>), <span class="field">RecordCount</span> = <span class="function">count</span>()
    | <span class="keyword">extend</span> <span class="field">Source</span> = <span class="string">"CISA KEV"</span>;

<span class="keyword">let</span> <span class="field">Qualys_Status</span> = Qualys_Vulns_CL 
    | <span class="keyword">summarize</span> <span class="field">LastUpdate</span> = <span class="function">max</span>(<span class="field">TimeGenerated</span>), <span class="field">RecordCount</span> = <span class="function">count</span>()
    | <span class="keyword">extend</span> <span class="field">Source</span> = <span class="string">"Qualys"</span>;

<span class="keyword">let</span> <span class="field">IP_Status</span> = IPReputation_CL 
    | <span class="keyword">summarize</span> <span class="field">LastUpdate</span> = <span class="function">max</span>(<span class="field">TimeGenerated</span>), <span class="field">RecordCount</span> = <span class="function">count</span>()
    | <span class="keyword">extend</span> <span class="field">Source</span> = <span class="string">"IP Reputation"</span>;

<span class="keyword">union</span> EPSS_Status, KEV_Status, Qualys_Status, IP_Status
| <span class="keyword">join</span> <span class="keyword">kind</span>=inner DataSources <span class="keyword">on</span> <span class="field">Source</span>
| <span class="keyword">extend</span> 
    <span class="field">Age</span> = now() - <span class="field">LastUpdate</span>,
    <span class="field">IsStale</span> = (now() - <span class="field">LastUpdate</span>) > <span class="field">MaxAge</span>
| <span class="keyword">extend</span> <span class="field">Status</span> = <span class="function">iif</span>(<span class="field">IsStale</span>, <span class="string">"âš ï¸ STALE"</span>, <span class="string">"âœ… OK"</span>)
| <span class="keyword">project</span>
    <span class="field">Source</span>,
    <span class="field">ExpectedFrequency</span>,
    <span class="field">LastUpdate</span>,
    <span class="field">Age</span> = <span class="function">format_timespan</span>(<span class="field">Age</span>, <span class="string">"d.hh:mm"</span>),
    <span class="field">RecordCount</span>,
    <span class="field">Status</span>
| <span class="keyword">order by</span> <span class="field">Source</span>
          </div>
        </div>

        <div class="two-column">
          <div class="pattern-box">
            <h4>âœ… Success Indicators</h4>
            <ul>
              <li>All TI tables updated within expected frequency</li>
              <li>Record counts stable (Â±10% day-over-day)</li>
              <li>No Azure Function failures in Application Insights</li>
              <li>Alerts firing appropriately (not too many, not zero)</li>
              <li>Watchlist freshness within 7 days</li>
            </ul>
          </div>
          
          <div class="warning-box">
            <h4>âš ï¸ Common Issues & Fixes</h4>
            <ul>
              <li><strong>API rate limiting:</strong> Implement exponential backoff, cache responses</li>
              <li><strong>DCR failures:</strong> Check schema matches, verify DCE endpoint</li>
              <li><strong>Stale data:</strong> Check Function App logs, verify timer triggers</li>
              <li><strong>High costs:</strong> Filter more aggressively, use Basic tier for TI tables</li>
              <li><strong>False positives:</strong> Increase confidence thresholds, tune detection rules</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- ==================== SUMMARY ==================== -->
      <div class="concept-card">
        <h2>ğŸ“ Complete Architecture Summary</h2>
        
        <div class="flow-diagram">
<span style="color: #ef4444; font-weight: bold;">END-TO-END THREAT INTEL PIPELINE</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span style="color: #f59e0b;">EXTERNAL SOURCES</span>              <span style="color: #22c55e;">INGESTION</span>                 <span style="color: #8b5cf6;">STORAGE</span>                       â”‚
â”‚                                                                                            â”‚
â”‚ EPSS (FIRST.org)  â”€â”€â”€â”€â”                                                                    â”‚
â”‚ CISA KEV          â”€â”€â”€â”€â”¼â”€â”€â”€â–¶ Azure Functions â”€â”€â”€â–¶ DCR â”€â”€â”€â–¶ Custom Tables (_CL)             â”‚
â”‚ Qualys VMDR       â”€â”€â”€â”€â”¤     (Python)                       â€¢ EPSS_Scores_CL               â”‚
â”‚ AbuseIPDB         â”€â”€â”€â”€â”¤                                    â€¢ CISA_KEV_CL                  â”‚
â”‚ AlienVault OTX    â”€â”€â”€â”€â”˜                                    â€¢ Qualys_Vulns_CL              â”‚
â”‚                                                            â€¢ IPReputation_CL              â”‚
â”‚                                                                                            â”‚
â”‚ ServiceNow CMDB   â”€â”€â”€â”€â”                                                                    â”‚
â”‚ Intune            â”€â”€â”€â”€â”¼â”€â”€â”€â–¶ Logic App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Watchlist: AssetInventory            â”‚
â”‚ Manual CSV        â”€â”€â”€â”€â”˜     (Weekly)                                                       â”‚
â”‚                                                                                            â”‚
â”‚ Microsoft TVM     â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Native Connector â”€â”€â”€â”€â”€â”€â–¶ DeviceTvmSoftwareVulnerabilities     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span style="color: #06b6d4;">CORRELATION LAYER</span>                                                                        â”‚
â”‚                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              KQL: Unified Vulnerability View                        â”‚  â”‚
â”‚  â”‚                                                                                     â”‚  â”‚
â”‚  â”‚  TVM Vulns â”€â”€â”                                                                      â”‚  â”‚
â”‚  â”‚              â”œâ”€â”€â–¶ Merge â”€â”€â–¶ Dedupe â”€â”€â–¶ Join EPSS â”€â”€â–¶ Join KEV â”€â”€â–¶ Join Assets      â”‚  â”‚
â”‚  â”‚  Qualys â”€â”€â”€â”€â”˜                                                                       â”‚  â”‚
â”‚  â”‚                                                                                     â”‚  â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚              â”‚ RiskScore = CVSSÃ—15 + EPSSÃ—30 + KEVÃ—30 + TruRiskÃ—15 â”‚              â”‚  â”‚
â”‚  â”‚              â”‚            + AssetCriticalityÃ—10                     â”‚              â”‚  â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span style="color: #ef4444;">ALERTING</span>                                                                                  â”‚
â”‚                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Rule: Critical Vuln Alert          â”‚  â”‚ Rule: Malicious IP Connection      â”‚          â”‚
â”‚  â”‚ Schedule: Daily 9 AM               â”‚  â”‚ Schedule: Every 15 min             â”‚          â”‚
â”‚  â”‚ Condition: P1-Critical + Critical  â”‚  â”‚ Condition: Confidence >= 80        â”‚          â”‚
â”‚  â”‚            Asset + Production      â”‚  â”‚            + Allowed Connection    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                        â”‚                                                  â”‚
â”‚                                        â–¼                                                  â”‚
â”‚                              Sentinel Incident Queue                                      â”‚
â”‚                                        â”‚                                                  â”‚
â”‚                                        â–¼                                                  â”‚
â”‚                              ServiceNow / Email / Teams                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </div>
      </div>

    </main>
  </div>
</body>
</html>
