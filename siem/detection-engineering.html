<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detection Engineering | SIEM Migration</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <div class="layout">
        <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">RF</div>
          <div class="sidebar-logo-text">
            <span class="sidebar-logo-title">Security Transformation</span>
            <span class="sidebar-logo-subtitle">RevFlow Analytics</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item">Executive Summary</a>
          <a href="../company-profile.html" class="nav-item">Company Profile</a>
          <a href="../security-framework.html" class="nav-item">Security Framework</a>
          <a href="../program-structure.html" class="nav-item">Program Structure</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">SIEM Migration</div>
          <a href="../siem/index.html" class="nav-item">SIEM Overview</a>
          <a href="../siem/discovery.html" class="nav-item">Discovery & Assessment</a>
          <a href="../siem/log-sources.html" class="nav-item">Log Source Strategy</a>
          <a href="../siem/log-engineering.html" class="nav-item">Log Engineering</a>
          <a href="../siem/detection-engineering.html" class="nav-item active">Detection Engineering</a>
          <a href="../siem/detection-catalog.html" class="nav-item">Detection Catalog</a>
          <a href="../siem/soc-transition.html" class="nav-item">SOC Transition</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">EDR Migration</div>
          <a href="../edr/index.html" class="nav-item">EDR Overview</a>
          <a href="../edr/deployment.html" class="nav-item">MDE Deployment</a>
          <a href="../edr/asr-rules.html" class="nav-item">ASR Rules</a>
          <a href="../edr/coexistence.html" class="nav-item">Coexistence Strategy</a>
          <a href="../edr/eset-removal.html" class="nav-item">ESET Removal</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">DLP Migration</div>
          <a href="../dlp/index.html" class="nav-item">DLP Overview</a>
          <a href="../dlp/policy-translation.html" class="nav-item">Policy Translation</a>
          <a href="../dlp/rollout-phases.html" class="nav-item">Rollout Phases</a>
          <a href="../dlp/user-communication.html" class="nav-item">User Communication</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Identity & Access</div>
          <a href="../identity/index.html" class="nav-item">Identity Overview</a>
          <a href="../identity/hybrid-setup.html" class="nav-item">Hybrid Identity</a>
          <a href="../identity/conditional-access.html" class="nav-item">Conditional Access</a>
          <a href="../identity/pim.html" class="nav-item">PIM Configuration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="../infrastructure/index.html" class="nav-item">Infrastructure Overview</a>
          <a href="../infrastructure/landing-zone.html" class="nav-item">Landing Zone</a>
          <a href="../infrastructure/network-architecture.html" class="nav-item">Network Architecture</a>
          <a href="../infrastructure/workload-migration.html" class="nav-item">Workload Migration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="../operations/parallel-ops.html" class="nav-item">Parallel Operations</a>
          <a href="../operations/soc-workflows.html" class="nav-item">SOC Workflows</a>
          <a href="../operations/integration.html" class="nav-item">Platform Integration</a>
          <a href="../operations/xdr-integration.html" class="nav-item">XDR Integration</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="../resources/timeline.html" class="nav-item">Project Timeline</a>
          <a href="../resources/raci.html" class="nav-item">RACI Matrix</a>
          <a href="../resources/scripts.html" class="nav-item">Scripts & Queries</a>
          <a href="../resources/data-dictionary.html" class="nav-item">Data Dictionary</a>
          <a href="../resources/templates.html" class="nav-item">Templates</a>
          <a href="../resources/splunk-reference.html" class="nav-item">Splunk Reference</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Runbooks</div>
          <a href="../resources/mde-onboarding.html" class="nav-item">MDE Onboarding</a>
          <a href="../resources/mde-offboarding.html" class="nav-item">MDE Offboarding</a>
          <a href="../resources/incident-response.html" class="nav-item">Incident Response</a>
          <a href="../resources/operational-procedures.html" class="nav-item">Operational Procedures</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Troubleshooting</div>
          <a href="../troubleshooting/index.html" class="nav-item">Common Issues</a>
          <a href="../troubleshooting/siem-issues.html" class="nav-item">SIEM Issues</a>
          <a href="../troubleshooting/mde-issues.html" class="nav-item">MDE Issues</a>
          <a href="../troubleshooting/dlp-issues.html" class="nav-item">DLP Issues</a>
          <a href="../troubleshooting/agent-conflicts.html" class="nav-item">Agent Conflicts</a>
        </div>
        <div class="nav-divider"></div>
        <div class="nav-section">
          <div class="nav-section-title">Career</div>
          <a href="../career-narrative.html" class="nav-item">Career Narrative</a>
          <a href="../interview-prep.html" class="nav-item">Interview Prep</a>
        </div>
      </nav>
    </aside>
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>
    <div class="sidebar-overlay"></div>
    <main class="main-content">
      <div class="content-wrapper">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="index.html">SIEM Migration</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Detection Engineering</span>
        </nav>

        <div class="page-header">
          <h1>Detection Engineering</h1>
          <div class="page-header-meta">
            <span class="page-badge siem">SIEM Track</span>
          </div>
          <p class="intro-text">Enabling built-in detection capabilities and translating custom RSA NetWitness rules to Sentinel KQL. This section covers rule categorization, Microsoft content deployment, and translation patterns.</p>
        </div>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Role Scope
          </div>
          <div class="callout-content">
            <p><strong>My Contribution (Security Engineer):</strong> Implemented and enabled built-in detection rules from the detection translation catalog — specifically those with direct native equivalents in Microsoft Sentinel and Microsoft Defender. Translated and aligned detection use cases around endpoint telemetry, ensuring proper correlation between MDE, identity, and network signals. Deployed Microsoft Content Hub solutions and configured XDR-aligned rules.</p>
            <p><strong>Detection Engineering Team:</strong> Detailed custom KQL detection development, complex rule translation requiring significant logic rewrite, ongoing threshold tuning, false positive reduction, and continuous detection optimization.</p>
          </div>
        </div>

        <h2>Detection Anchors (XDR-First Strategy)</h2>
        <p>Our detection strategy is built around <strong>layered correlation</strong> — XDR handles what it's good at, Sentinel handles the rest:</p>

        <div class="callout warning">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
            XDR-First Detection Ownership
          </div>
          <div class="callout-content">
            <p><strong>XDR (M365 Defender) handles:</strong> Endpoint, identity, email, cloud apps — automatic correlation, no Sentinel rules needed.</p>
            <p><strong>Sentinel handles:</strong> Network, Azure control plane, DLP, higher-order correlation (XDR + non-Microsoft context).</p>
            <p><strong>Key insight:</strong> We don't ingest all raw Device* tables into Sentinel. XDR produces high-fidelity incidents that Sentinel consumes. Selective raw table ingestion only for specific cross-domain correlation needs.</p>
          </div>
        </div>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            XDR Detection Model ≠ SIEM Detection Model
          </div>
          <div class="callout-content">
            <p><strong>XDR does NOT rely on user-authored detection rules.</strong> XDR detections are:</p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Microsoft-managed</strong> — you cannot see the exact logic</li>
              <li><strong>Behavior + ML-based</strong> — continuously updated</li>
              <li><strong>Automatic correlation</strong> — no correlation rules to configure</li>
            </ul>
            <p style="margin-top: 0.5rem;"><strong>Sentinel detection rules</strong> are user-authored KQL analytics rules for domains XDR doesn't cover (network, Azure, DLP, higher-order). This is why we have ~270 Sentinel rules, not 500+ — XDR handles the rest without rules.</p>
          </div>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Detection Domain</th><th>Owner</th><th>Signal Source</th><th>Sentinel Ingestion</th></tr>
            </thead>
            <tbody>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Endpoint (MDE)</strong></td>
                <td>XDR</td>
                <td>Process, file, network, registry behaviors</td>
                <td>SecurityIncident + SecurityAlert only (NOT raw Device* tables)</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Identity (Entra ID)</strong></td>
                <td>XDR + Sentinel</td>
                <td>Sign-in anomalies, privilege changes</td>
                <td>XDR incidents + SigninLogs for higher-order correlation</td>
              </tr>
              <tr style="background: rgba(34, 197, 94, 0.1);">
                <td><strong>Email (MDO)</strong></td>
                <td>XDR</td>
                <td>Phishing, BEC, malicious attachments</td>
                <td>SecurityIncident only (NOT EmailEvents)</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Network (Firewall)</strong></td>
                <td>Sentinel</td>
                <td>C2 beaconing, DNS tunneling, exfiltration</td>
                <td>CommonSecurityLog (full ingestion)</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>Cloud Control Plane</strong></td>
                <td>Sentinel</td>
                <td>Privilege escalation, resource changes</td>
                <td>AzureActivity, AzureDiagnostics (full ingestion)</td>
              </tr>
              <tr style="background: rgba(59, 130, 246, 0.1);">
                <td><strong>DLP</strong></td>
                <td>Sentinel</td>
                <td>Policy violations, exfiltration attempts</td>
                <td>PurviewDLPLogs (full ingestion)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout success">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            EU Detection Approach
          </div>
          <div class="callout-content">
            <p><strong>No special EU-only detections needed.</strong> Same detection rules apply globally. Access to EU-related logs restricted via RBAC. Retention minimized where possible.</p>
          </div>
        </div>

        <h2>Threat-Intent Driven Detection</h2>
        <p>Detection work was <strong>threat-intent driven and mapped to target controls</strong>, rather than being blocked by telemetry readiness.</p>

        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Why This Worked
          </div>
          <div class="callout-content">
            <p><strong>MDE Rollout Started Early:</strong> After discovery, MDE deployment began immediately to establish endpoint telemetry before detection implementations started.</p>
            <p><strong>Telemetry Ready First:</strong> By the time the detection translation catalog was finalized, sufficient endpoint telemetry was already available for validation and tuning.</p>
            <p><strong>No Detection Blocking:</strong> Detection engineers could implement rules and immediately validate against real data — no waiting for telemetry to catch up.</p>
          </div>
        </div>

        <div class="flow-diagram">
          <div class="flow-step">
            <div class="flow-step-number">1</div>
            <div class="flow-step-content">
              <strong>Threat Intent</strong><br>What are we trying to detect? (Account takeover, lateral movement, data exfil)
            </div>
          </div>
          <div class="flow-connector">↓</div>
          <div class="flow-step">
            <div class="flow-step-number">2</div>
            <div class="flow-step-content">
              <strong>Target Controls</strong><br>What signals would show this behavior? (Sign-in anomalies, process execution, network connections)
            </div>
          </div>
          <div class="flow-connector">↓</div>
          <div class="flow-step">
            <div class="flow-step-number">3</div>
            <div class="flow-step-content">
              <strong>Telemetry Validation</strong><br>Is the data flowing? (MDE already deployed → yes, telemetry available)
            </div>
          </div>
          <div class="flow-connector">↓</div>
          <div class="flow-step">
            <div class="flow-step-number">4</div>
            <div class="flow-step-content">
              <strong>Detection Implementation</strong><br>Enable built-in rules, translate custom rules, validate against real data
            </div>
          </div>
        </div>

        <h2>Rule Migration Strategy</h2>
        <p>Don't migrate all rules blindly. Categorize and prioritize:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Category</th><th>% of Rules</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr><td>Never fired (12 months)</td><td>30-40%</td><td><span class="status-badge not-started">Discard</span></td></tr>
              <tr><td>Constantly noisy</td><td>20-30%</td><td><span class="status-badge in-progress">Review/Fix or Discard</span></td></tr>
              <tr><td>Covered by Microsoft content</td><td>20%</td><td><span class="status-badge complete">Use Microsoft version</span></td></tr>
              <tr><td>Valuable custom rules</td><td>10-20%</td><td><span class="status-badge critical">Migrate & improve</span></td></tr>
              <tr><td>Compliance-required</td><td>5-10%</td><td><span class="status-badge critical">Must migrate</span></td></tr>
            </tbody>
          </table>
        </div>

        <h2>Microsoft Content Hub</h2>
        <p>Before writing custom rules, check Content Hub for free solutions:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Solution</th><th>Detection Coverage</th><th>Install Priority</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>Microsoft Entra ID</strong></td><td>Sign-in anomalies, risky users, MFA bypass</td><td>Week 1</td></tr>
              <tr><td><strong>Microsoft 365 Defender</strong></td><td>Endpoint, email, identity threats</td><td>Week 1</td></tr>
              <tr><td><strong>Azure Activity</strong></td><td>Resource changes, privilege escalation</td><td>Week 2</td></tr>
              <tr><td><strong>Threat Intelligence</strong></td><td>IOC matching across all tables</td><td>Week 2</td></tr>
              <tr><td><strong>UEBA</strong></td><td>User behavior anomalies</td><td>Week 4</td></tr>
              <tr><td><strong>AWS</strong></td><td>CloudTrail anomalies, IAM changes</td><td>Week 4</td></tr>
            </tbody>
          </table>
        </div>

        <h2>RSA ESA to Sentinel KQL Translation</h2>

        <h3>Example 1: Brute Force Detection</h3>
        <div class="comparison-grid">
          <div class="comparison-column">
            <div class="comparison-header before">RSA ESA Rule</div>
            <div class="comparison-content">
              <div class="code-block" style="margin: 0; border: none;">
                <pre><code>@RSAAlert(
  name='Brute Force Attack',
  severity='High'
)
SELECT * FROM Event
WHERE device_type = 'winevent_nic'
AND reference_id = '4625'
GROUP BY src_ip
HAVING COUNT(*) > 10
WINDOW (SIZE 5 MINUTE)</code></pre>
              </div>
            </div>
          </div>
          <div class="comparison-column">
            <div class="comparison-header after">Sentinel KQL</div>
            <div class="comparison-content">
              <div class="code-block" style="margin: 0; border: none;">
                <pre><code>SecurityEvent
| where TimeGenerated > ago(5m)
| where EventID == 4625
| summarize 
    FailedAttempts = count(),
    TargetAccounts = dcount(TargetUserName)
    by IpAddress
| where FailedAttempts > 10
| extend AlertSeverity = "High"</code></pre>
              </div>
            </div>
          </div>
        </div>

        <h3>Example 2: Salesforce Bulk Export Detection</h3>
        <div class="code-block">
          <div class="code-header"><span class="code-lang">KQL - Sentinel Analytics Rule</span><button class="code-copy-btn">Copy</button></div>
          <pre><code>// Detect unusual bulk record exports from Salesforce
// Critical for RevFlow - protects customer CRM data

SalesforceServiceCloud_CL
| where TimeGenerated > ago(1h)
| where EventType_s == "ReportExport" or EventType_s == "DataExport"
| summarize 
    ExportCount = count(),
    TotalRecords = sum(toint(RowsProcessed_s)),
    ExportTypes = make_set(EventType_s)
    by UserId_s, UserName_s
| where TotalRecords > 10000  // Threshold: 10k records
| join kind=leftouter (
    // Get user's baseline
    SalesforceServiceCloud_CL
    | where TimeGenerated > ago(30d) and TimeGenerated < ago(1h)
    | where EventType_s in ("ReportExport", "DataExport")
    | summarize BaselineAvg = avg(toint(RowsProcessed_s)) by UserId_s
) on UserId_s
| where TotalRecords > (BaselineAvg * 5) or isempty(BaselineAvg)
| extend 
    AlertName = "Salesforce Bulk Data Export",
    AlertSeverity = "High",
    Description = strcat(UserName_s, " exported ", TotalRecords, " records")</code></pre>
        </div>

        <h3>Example 3: Suspicious PowerShell Execution</h3>
        <div class="code-block">
          <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy-btn">Copy</button></div>
          <pre><code>// Detect encoded PowerShell and suspicious patterns
DeviceProcessEvents
| where TimeGenerated > ago(1h)
| where FileName =~ "powershell.exe" or FileName =~ "pwsh.exe"
| where ProcessCommandLine has_any (
    "-enc", "-encodedcommand",
    "-nop", "-noprofile",
    "bypass", "-exec bypass",
    "downloadstring", "downloadfile",
    "invoke-webrequest", "iwr",
    "invoke-expression", "iex",
    "net.webclient",
    "bitstransfer"
)
| extend 
    EncodedCommand = ProcessCommandLine has_any ("-enc", "-encodedcommand"),
    DownloadAttempt = ProcessCommandLine has_any ("downloadstring", "downloadfile", "invoke-webrequest"),
    ExecutionBypass = ProcessCommandLine has_any ("bypass", "-exec bypass")
| project 
    TimeGenerated,
    DeviceName,
    AccountName,
    ProcessCommandLine,
    InitiatingProcessFileName,
    EncodedCommand,
    DownloadAttempt,
    ExecutionBypass</code></pre>
        </div>

        <h3>Example 4: Impossible Travel</h3>
        <div class="callout info">
          <div class="callout-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Use Built-In</div>
          <div class="callout-content"><p>Don't write custom impossible travel rules. Entra ID Identity Protection detects this natively and feeds into Sentinel via the connector. Enable the Microsoft Entra ID solution from Content Hub.</p></div>
        </div>

        <h2>Analytics Rule Configuration</h2>
        <div class="code-block">
          <div class="code-header"><span class="code-lang">JSON - ARM Template</span><button class="code-copy-btn">Copy</button></div>
          <pre><code>{
  "type": "Microsoft.SecurityInsights/alertRules",
  "apiVersion": "2022-11-01",
  "name": "BruteForceDetection",
  "kind": "Scheduled",
  "properties": {
    "displayName": "Brute Force Attack Detected",
    "description": "Detects multiple failed login attempts from single IP",
    "severity": "High",
    "enabled": true,
    "query": "SecurityEvent | where EventID == 4625 | summarize FailedAttempts = count() by IpAddress | where FailedAttempts > 10",
    "queryFrequency": "PT5M",
    "queryPeriod": "PT5M",
    "triggerOperator": "GreaterThan",
    "triggerThreshold": 0,
    "suppressionDuration": "PT1H",
    "suppressionEnabled": true,
    "tactics": ["CredentialAccess"],
    "techniques": ["T1110"],
    "entityMappings": [
      {
        "entityType": "IP",
        "fieldMappings": [{"identifier": "Address", "columnName": "IpAddress"}]
      }
    ]
  }
}</code></pre>
        </div>

        <h2>Testing & Validation</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Test Type</th><th>Method</th><th>Success Criteria</th></tr>
            </thead>
            <tbody>
              <tr><td><strong>Syntax validation</strong></td><td>Run query in Log Analytics</td><td>No errors, returns results</td></tr>
              <tr><td><strong>Historical data</strong></td><td>Query last 30 days</td><td>Expected alerts would have fired</td></tr>
              <tr><td><strong>False positive rate</strong></td><td>Review first week of alerts</td><td>&lt;20% false positive rate</td></tr>
              <tr><td><strong>Purple team</strong></td><td>Simulate attack</td><td>Detection within SLA</td></tr>
            </tbody>
          </table>
        </div>

        <h2>Industry Best Practices</h2>
        
        <div class="callout info">
          <div class="callout-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Detection Engineering Best Practices
          </div>
          <div class="callout-content">
            <p><strong>MITRE ATT&CK Alignment:</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Coverage Mapping:</strong> Map all detections to ATT&CK techniques for gap analysis</li>
              <li><strong>Priority Focus:</strong> Focus on techniques used by threat actors targeting your industry</li>
              <li><strong>Data Source Validation:</strong> Verify required data sources per ATT&CK technique</li>
            </ul>
            <p style="margin-top: 1rem;"><strong>Detection Development Lifecycle (Gartner/SANS):</strong></p>
            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
              <li><strong>Threat Intelligence → Detection Logic → Validation → Tuning → Production</strong></li>
              <li><strong>Detection-as-Code:</strong> Version control all detection rules (Git)</li>
              <li><strong>CI/CD for Detections:</strong> Automated testing before deployment</li>
            </ul>
          </div>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Best Practice</th><th>Standard/Source</th><th>Our Implementation</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Map detections to ATT&CK framework</td>
                <td>MITRE ATT&CK, CISA recommendations</td>
                <td>All rules tagged with technique IDs</td>
              </tr>
              <tr>
                <td>Prioritize high-fidelity detections</td>
                <td>Palantir Detection Engineering, Gartner</td>
                <td>Built-in rules first, custom for gaps</td>
              </tr>
              <tr>
                <td>Maintain detection coverage metrics</td>
                <td>SANS Detection Maturity Model</td>
                <td>Weekly coverage review by ATT&CK tactic</td>
              </tr>
              <tr>
                <td>Test detections with adversary simulation</td>
                <td>MITRE Caldera, Atomic Red Team</td>
                <td>Purple team validation for critical rules</td>
              </tr>
              <tr>
                <td>Document detection intent and limitations</td>
                <td>Detection Engineering best practices</td>
                <td>Each rule includes description, limitations, tuning notes</td>
              </tr>
              <tr>
                <td>False positive rate &lt;20%</td>
                <td>Industry benchmark</td>
                <td>Track FP rate per rule, disable if >30%</td>
              </tr>
            </tbody>
          </table>
        </div>

        <nav class="page-nav">
          <a href="log-engineering.html" class="page-nav-link prev"><span class="page-nav-label">Previous</span><span class="page-nav-title">← Log Engineering</span></a>
          <a href="detection-catalog.html" class="page-nav-link next"><span class="page-nav-label">Next</span><span class="page-nav-title">Detection Catalog →</span></a>
        </nav>
      </div>
    </main>
  </div>
  <script src="../js/main.js"></script>
</body>
</html>
